# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6943055987358093, "acc": 0.5130185484886169, "length": 3.3060007095336914, "mode": "train", "epoch": 1}
{"loss": 0.6923506259918213, "acc": 0.5097221732139587, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6608080863952637, "acc": 0.6097082495689392, "length": 2.186250686645508, "mode": "train", "epoch": 2}
{"loss": 0.6265385746955872, "acc": 0.6409804224967957, "length": 1.9340277910232544, "mode": "test", "epoch": 2}
{"loss": 0.5903500914573669, "acc": 0.6868776679039001, "length": 2.8053154945373535, "mode": "train", "epoch": 3}
{"loss": 0.5730112195014954, "acc": 0.6987548470497131, "length": 3.1458332538604736, "mode": "test", "epoch": 3}
{"loss": 0.5513918399810791, "acc": 0.7305163145065308, "length": 3.384601593017578, "mode": "train", "epoch": 4}
{"loss": 0.5427296161651611, "acc": 0.730014443397522, "length": 3.3767361640930176, "mode": "test", "epoch": 4}
{"loss": 0.5275253653526306, "acc": 0.748497486114502, "length": 3.5393595695495605, "mode": "train", "epoch": 5}
{"loss": 0.5169638991355896, "acc": 0.7615994215011597, "length": 3.6736111640930176, "mode": "test", "epoch": 5}
{"loss": 0.5005328059196472, "acc": 0.7733131647109985, "length": 3.59627366065979, "mode": "train", "epoch": 6}
{"loss": 0.4799560606479645, "acc": 0.7876750826835632, "length": 3.460069417953491, "mode": "test", "epoch": 6}
{"loss": 0.46296489238739014, "acc": 0.7903510332107544, "length": 3.568586826324463, "mode": "train", "epoch": 7}
{"loss": 0.4549456238746643, "acc": 0.795261025428772, "length": 3.5364582538604736, "mode": "test", "epoch": 7}
{"loss": 0.43998488783836365, "acc": 0.7967627048492432, "length": 3.6927733421325684, "mode": "train", "epoch": 8}
{"loss": 0.4403655230998993, "acc": 0.7998412847518921, "length": 3.6354167461395264, "mode": "test", "epoch": 8}
{"loss": 0.4256143867969513, "acc": 0.805758535861969, "length": 3.6963918209075928, "mode": "train", "epoch": 9}
{"loss": 0.4492345452308655, "acc": 0.782923698425293, "length": 3.663194417953491, "mode": "test", "epoch": 9}
{"loss": 0.40885815024375916, "acc": 0.8137235045433044, "length": 3.7303099632263184, "mode": "train", "epoch": 10}
{"loss": 0.40885061025619507, "acc": 0.8144260048866272, "length": 3.71875, "mode": "test", "epoch": 10}
{"loss": 0.38655346632003784, "acc": 0.8229421377182007, "length": 3.785719394683838, "mode": "train", "epoch": 11}
{"loss": 0.39007383584976196, "acc": 0.8309434056282043, "length": 3.7395832538604736, "mode": "test", "epoch": 11}
{"loss": 0.37095969915390015, "acc": 0.8342564105987549, "length": 3.811619758605957, "mode": "train", "epoch": 12}
{"loss": 0.37426578998565674, "acc": 0.8422945737838745, "length": 3.789930582046509, "mode": "test", "epoch": 12}
{"loss": 0.3518480658531189, "acc": 0.8411593437194824, "length": 3.854163408279419, "mode": "train", "epoch": 13}
{"loss": 0.355621337890625, "acc": 0.8411824703216553, "length": 3.859375, "mode": "test", "epoch": 13}
{"loss": 0.333347886800766, "acc": 0.8524895310401917, "length": 3.864980936050415, "mode": "train", "epoch": 14}
{"loss": 0.33530864119529724, "acc": 0.8542046546936035, "length": 3.859375, "mode": "test", "epoch": 14}
{"loss": 0.32485148310661316, "acc": 0.8569492101669312, "length": 3.8664188385009766, "mode": "train", "epoch": 15}
{"loss": 0.32963213324546814, "acc": 0.8589205741882324, "length": 3.8454861640930176, "mode": "test", "epoch": 15}
{"loss": 0.3157924711704254, "acc": 0.8619963526725769, "length": 3.8574442863464355, "mode": "train", "epoch": 16}
{"loss": 0.3241812288761139, "acc": 0.8618923425674438, "length": 3.8541667461395264, "mode": "test", "epoch": 16}
{"loss": 0.305091917514801, "acc": 0.866758406162262, "length": 3.8900809288024902, "mode": "train", "epoch": 17}
{"loss": 0.31470394134521484, "acc": 0.8632609248161316, "length": 3.902777671813965, "mode": "test", "epoch": 17}
{"loss": 0.30247941613197327, "acc": 0.8694031238555908, "length": 3.872924327850342, "mode": "train", "epoch": 18}
{"loss": 0.3168737292289734, "acc": 0.8643949031829834, "length": 3.883680582046509, "mode": "test", "epoch": 18}
{"loss": 0.29486438632011414, "acc": 0.8717762231826782, "length": 3.9077532291412354, "mode": "train", "epoch": 19}
{"loss": 0.31263017654418945, "acc": 0.8679105043411255, "length": 3.9079861640930176, "mode": "test", "epoch": 19}
{"loss": 0.29400014877319336, "acc": 0.8715837001800537, "length": 3.8900842666625977, "mode": "train", "epoch": 20}
{"loss": 0.309031218290329, "acc": 0.8702094554901123, "length": 3.8645832538604736, "mode": "test", "epoch": 20}
{"loss": 0.28698813915252686, "acc": 0.8780600428581238, "length": 3.905224084854126, "mode": "train", "epoch": 21}
{"loss": 0.30784592032432556, "acc": 0.8699613213539124, "length": 3.8802082538604736, "mode": "test", "epoch": 21}
{"loss": 0.2884182631969452, "acc": 0.876370370388031, "length": 3.8927550315856934, "mode": "train", "epoch": 22}
{"loss": 0.30007264018058777, "acc": 0.8737114667892456, "length": 3.847222328186035, "mode": "test", "epoch": 22}
{"loss": 0.2822520434856415, "acc": 0.8781816959381104, "length": 3.8866817951202393, "mode": "train", "epoch": 23}
{"loss": 0.30071625113487244, "acc": 0.8759100437164307, "length": 3.881944417953491, "mode": "test", "epoch": 23}
{"loss": 0.2764717638492584, "acc": 0.8828935027122498, "length": 3.886319637298584, "mode": "train", "epoch": 24}
{"loss": 0.28694576025009155, "acc": 0.879782497882843, "length": 3.881944417953491, "mode": "test", "epoch": 24}
{"loss": 0.27368244528770447, "acc": 0.8824864625930786, "length": 3.8808844089508057, "mode": "train", "epoch": 25}
{"loss": 0.2960723042488098, "acc": 0.8742648363113403, "length": 3.84375, "mode": "test", "epoch": 25}
{"loss": 0.2752828001976013, "acc": 0.882121741771698, "length": 3.8734638690948486, "mode": "train", "epoch": 26}
{"loss": 0.2873435318470001, "acc": 0.8813815116882324, "length": 3.868055582046509, "mode": "test", "epoch": 26}
{"loss": 0.2759873569011688, "acc": 0.8822559714317322, "length": 3.882540225982666, "mode": "train", "epoch": 27}
{"loss": 0.2965378761291504, "acc": 0.8807425498962402, "length": 3.8888888359069824, "mode": "test", "epoch": 27}
{"loss": 0.2711254954338074, "acc": 0.8848831653594971, "length": 3.901484251022339, "mode": "train", "epoch": 28}
{"loss": 0.2907367944717407, "acc": 0.8832546472549438, "length": 3.855902671813965, "mode": "test", "epoch": 28}
{"loss": 0.2681058943271637, "acc": 0.8874757885932922, "length": 3.87485933303833, "mode": "train", "epoch": 29}
{"loss": 0.287375807762146, "acc": 0.8814751505851746, "length": 3.8732638359069824, "mode": "test", "epoch": 29}
{"loss": 0.2596430480480194, "acc": 0.8915836215019226, "length": 3.8906781673431396, "mode": "train", "epoch": 30}
{"loss": 0.2782066762447357, "acc": 0.8830471038818359, "length": 3.868055582046509, "mode": "test", "epoch": 30}
{"loss": 0.2566376328468323, "acc": 0.891884982585907, "length": 3.876664400100708, "mode": "train", "epoch": 31}
{"loss": 0.2752348482608795, "acc": 0.8875719308853149, "length": 3.8541667461395264, "mode": "test", "epoch": 31}
{"loss": 0.25353559851646423, "acc": 0.8953500390052795, "length": 3.886249303817749, "mode": "train", "epoch": 32}
{"loss": 0.281611829996109, "acc": 0.8867133259773254, "length": 3.8732638359069824, "mode": "test", "epoch": 32}
{"loss": 0.2597489058971405, "acc": 0.8925397396087646, "length": 3.8899455070495605, "mode": "train", "epoch": 33}
{"loss": 0.27148064970970154, "acc": 0.8868463039398193, "length": 3.8489582538604736, "mode": "test", "epoch": 33}
{"loss": 0.25709405541419983, "acc": 0.8938109278678894, "length": 3.9223341941833496, "mode": "train", "epoch": 34}
{"loss": 0.2749781310558319, "acc": 0.8850042819976807, "length": 3.9079861640930176, "mode": "test", "epoch": 34}
{"loss": 0.25367772579193115, "acc": 0.8949353694915771, "length": 3.905646562576294, "mode": "train", "epoch": 35}
{"loss": 0.2837124466896057, "acc": 0.8873102068901062, "length": 3.8923611640930176, "mode": "test", "epoch": 35}
{"loss": 0.2567923069000244, "acc": 0.8933589458465576, "length": 3.926145076751709, "mode": "train", "epoch": 36}
{"loss": 0.28044265508651733, "acc": 0.881246030330658, "length": 3.902777671813965, "mode": "test", "epoch": 36}
{"loss": 0.24935513734817505, "acc": 0.8949902653694153, "length": 3.9473071098327637, "mode": "train", "epoch": 37}
{"loss": 0.28483888506889343, "acc": 0.8896984457969666, "length": 3.9427082538604736, "mode": "test", "epoch": 37}
{"loss": 0.24731245636940002, "acc": 0.8995055556297302, "length": 3.9446189403533936, "mode": "train", "epoch": 38}
{"loss": 0.26901283860206604, "acc": 0.895733118057251, "length": 3.9479167461395264, "mode": "test", "epoch": 38}
{"loss": 0.244232177734375, "acc": 0.90043044090271, "length": 3.964709520339966, "mode": "train", "epoch": 39}
{"loss": 0.2744777202606201, "acc": 0.8939167857170105, "length": 3.9861111640930176, "mode": "test", "epoch": 39}
{"loss": 0.23921562731266022, "acc": 0.9033922553062439, "length": 3.982210397720337, "mode": "train", "epoch": 40}
{"loss": 0.2589953541755676, "acc": 0.8957235813140869, "length": 3.984375, "mode": "test", "epoch": 40}
{"loss": 0.2382875382900238, "acc": 0.9035175442695618, "length": 3.9884700775146484, "mode": "train", "epoch": 41}
{"loss": 0.26411715149879456, "acc": 0.8952513933181763, "length": 3.984375, "mode": "test", "epoch": 41}
{"loss": 0.23730619251728058, "acc": 0.9023355841636658, "length": 3.988692045211792, "mode": "train", "epoch": 42}
{"loss": 0.268519788980484, "acc": 0.8922742009162903, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.23652374744415283, "acc": 0.9047842025756836, "length": 3.9924979209899902, "mode": "train", "epoch": 43}
{"loss": 0.2672053575515747, "acc": 0.8951389789581299, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.2337762862443924, "acc": 0.9058710336685181, "length": 3.996539831161499, "mode": "train", "epoch": 44}
{"loss": 0.26725292205810547, "acc": 0.8933160305023193, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.23417368531227112, "acc": 0.9059522151947021, "length": 3.9981777667999268, "mode": "train", "epoch": 45}
{"loss": 0.26174941658973694, "acc": 0.8938368558883667, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.23121291399002075, "acc": 0.9059882760047913, "length": 3.9986701011657715, "mode": "train", "epoch": 46}
{"loss": 0.2697916328907013, "acc": 0.8985240459442139, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.22922572493553162, "acc": 0.9064122438430786, "length": 3.998905897140503, "mode": "train", "epoch": 47}
{"loss": 0.25782719254493713, "acc": 0.8967013955116272, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.22854748368263245, "acc": 0.9067736864089966, "length": 3.997114419937134, "mode": "train", "epoch": 48}
{"loss": 0.2629750370979309, "acc": 0.8978297710418701, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.2281709909439087, "acc": 0.9068862199783325, "length": 3.9979405403137207, "mode": "train", "epoch": 49}
{"loss": 0.26167720556259155, "acc": 0.8973957896232605, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.22937853634357452, "acc": 0.9071400165557861, "length": 3.9977376461029053, "mode": "train", "epoch": 50}
{"loss": 0.2708927392959595, "acc": 0.8986111879348755, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.2545633316040039, "acc": 0.8990299701690674, "length": 3.998619556427002, "mode": "train", "epoch": 51}
{"loss": 0.29426634311676025, "acc": 0.8871527314186096, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.2413107454776764, "acc": 0.900300920009613, "length": 3.9975719451904297, "mode": "train", "epoch": 52}
{"loss": 0.26677006483078003, "acc": 0.8964410424232483, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.23173677921295166, "acc": 0.9059844613075256, "length": 3.9990737438201904, "mode": "train", "epoch": 53}
{"loss": 0.26236167550086975, "acc": 0.9012153148651123, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.23620225489139557, "acc": 0.9051118493080139, "length": 3.9990170001983643, "mode": "train", "epoch": 54}
{"loss": 0.2681935727596283, "acc": 0.8973090648651123, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.2266216278076172, "acc": 0.9063273668289185, "length": 3.999115467071533, "mode": "train", "epoch": 55}
{"loss": 0.2633311450481415, "acc": 0.9007813334465027, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.2236095815896988, "acc": 0.908110499382019, "length": 3.9994208812713623, "mode": "train", "epoch": 56}
{"loss": 0.258993923664093, "acc": 0.9010416865348816, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.22457726299762726, "acc": 0.909855842590332, "length": 3.9984588623046875, "mode": "train", "epoch": 57}
{"loss": 0.2610771059989929, "acc": 0.9026910066604614, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.22719383239746094, "acc": 0.9070356488227844, "length": 3.999380588531494, "mode": "train", "epoch": 58}
{"loss": 0.26094797253608704, "acc": 0.9003472924232483, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.22709469497203827, "acc": 0.9089875221252441, "length": 3.9995505809783936, "mode": "train", "epoch": 59}
{"loss": 0.25574707984924316, "acc": 0.8993055820465088, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.22127032279968262, "acc": 0.909383237361908, "length": 3.999856472015381, "mode": "train", "epoch": 60}
{"loss": 0.25568142533302307, "acc": 0.8980902433395386, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.844531238079071
