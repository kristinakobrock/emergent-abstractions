# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.99", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.695688009262085, "acc": 0.506863534450531, "length": 3.5923168659210205, "mode": "train", "epoch": 1}
{"loss": 0.6917598247528076, "acc": 0.5166015625, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6918546557426453, "acc": 0.5231305956840515, "length": 3.3015873432159424, "mode": "train", "epoch": 2}
{"loss": 0.6873916983604431, "acc": 0.5479246973991394, "length": 1.3984375, "mode": "test", "epoch": 2}
{"loss": 0.6794907450675964, "acc": 0.573555052280426, "length": 2.6200671195983887, "mode": "train", "epoch": 3}
{"loss": 0.6616458892822266, "acc": 0.6318290829658508, "length": 2.294921875, "mode": "test", "epoch": 3}
{"loss": 0.6403152942657471, "acc": 0.6464862823486328, "length": 2.8050479888916016, "mode": "train", "epoch": 4}
{"loss": 0.6192837357521057, "acc": 0.6541579961776733, "length": 3.99609375, "mode": "test", "epoch": 4}
{"loss": 0.6074273586273193, "acc": 0.6585327982902527, "length": 3.793668031692505, "mode": "train", "epoch": 5}
{"loss": 0.6123703718185425, "acc": 0.6510743498802185, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.5863193869590759, "acc": 0.6944634914398193, "length": 3.961905002593994, "mode": "train", "epoch": 6}
{"loss": 0.6038228869438171, "acc": 0.6709961295127869, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.5706437826156616, "acc": 0.7088335752487183, "length": 3.9806997776031494, "mode": "train", "epoch": 7}
{"loss": 0.5872989296913147, "acc": 0.6812498569488525, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.5504013895988464, "acc": 0.7166771292686462, "length": 3.988640546798706, "mode": "train", "epoch": 8}
{"loss": 0.5490970611572266, "acc": 0.70947265625, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.5340343713760376, "acc": 0.7346160411834717, "length": 3.9938507080078125, "mode": "train", "epoch": 9}
{"loss": 0.5336639285087585, "acc": 0.7507812976837158, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.5213202238082886, "acc": 0.7469554543495178, "length": 3.9954962730407715, "mode": "train", "epoch": 10}
{"loss": 0.5152814984321594, "acc": 0.7633787393569946, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.5080048441886902, "acc": 0.7485105395317078, "length": 3.9950945377349854, "mode": "train", "epoch": 11}
{"loss": 0.4975418448448181, "acc": 0.7633789777755737, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.487224817276001, "acc": 0.7700386047363281, "length": 3.9970834255218506, "mode": "train", "epoch": 12}
{"loss": 0.4825657308101654, "acc": 0.7857423424720764, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.47453463077545166, "acc": 0.7784340381622314, "length": 3.9977378845214844, "mode": "train", "epoch": 13}
{"loss": 0.4631579518318176, "acc": 0.7933593392372131, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.45649775862693787, "acc": 0.7914720177650452, "length": 3.998274564743042, "mode": "train", "epoch": 14}
{"loss": 0.45386263728141785, "acc": 0.8006835579872131, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.4463231563568115, "acc": 0.7957611680030823, "length": 3.998353958129883, "mode": "train", "epoch": 15}
{"loss": 0.4488924443721771, "acc": 0.8050780892372131, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.4407055377960205, "acc": 0.7985456585884094, "length": 3.9989335536956787, "mode": "train", "epoch": 16}
{"loss": 0.4394611120223999, "acc": 0.8046875596046448, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.43324214220046997, "acc": 0.8031958341598511, "length": 3.9987714290618896, "mode": "train", "epoch": 17}
{"loss": 0.4277281165122986, "acc": 0.8092774152755737, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.4310232102870941, "acc": 0.8038181066513062, "length": 3.9990291595458984, "mode": "train", "epoch": 18}
{"loss": 0.4302653968334198, "acc": 0.8048829436302185, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.42341411113739014, "acc": 0.8052793741226196, "length": 3.999255895614624, "mode": "train", "epoch": 19}
{"loss": 0.42802637815475464, "acc": 0.8053711652755737, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.41940930485725403, "acc": 0.8045258522033691, "length": 3.9993338584899902, "mode": "train", "epoch": 20}
{"loss": 0.42539066076278687, "acc": 0.8070311546325684, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.4128085672855377, "acc": 0.8094828128814697, "length": 3.9991419315338135, "mode": "train", "epoch": 21}
{"loss": 0.4240052103996277, "acc": 0.8091796636581421, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.40576305985450745, "acc": 0.8114500045776367, "length": 3.9993603229522705, "mode": "train", "epoch": 22}
{"loss": 0.4112696647644043, "acc": 0.8197265863418579, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.4004700779914856, "acc": 0.8159257173538208, "length": 3.9990932941436768, "mode": "train", "epoch": 23}
{"loss": 0.4138072431087494, "acc": 0.8085938096046448, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.3934892416000366, "acc": 0.8183703422546387, "length": 3.9994373321533203, "mode": "train", "epoch": 24}
{"loss": 0.40088951587677, "acc": 0.8133788704872131, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.38906463980674744, "acc": 0.8216775059700012, "length": 3.9994685649871826, "mode": "train", "epoch": 25}
{"loss": 0.3968002200126648, "acc": 0.8219727277755737, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.38422197103500366, "acc": 0.8227117657661438, "length": 3.9993956089019775, "mode": "train", "epoch": 26}
{"loss": 0.3982273042201996, "acc": 0.8202147483825684, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.3763962388038635, "acc": 0.828646719455719, "length": 3.9992411136627197, "mode": "train", "epoch": 27}
{"loss": 0.3781623840332031, "acc": 0.827245831489563, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.37205788493156433, "acc": 0.8300560116767883, "length": 3.999535083770752, "mode": "train", "epoch": 28}
{"loss": 0.3850752115249634, "acc": 0.8259767293930054, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.3662974238395691, "acc": 0.8312942981719971, "length": 3.999234914779663, "mode": "train", "epoch": 29}
{"loss": 0.36575838923454285, "acc": 0.8456054329872131, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.3612135052680969, "acc": 0.8357248306274414, "length": 3.9997856616973877, "mode": "train", "epoch": 30}
{"loss": 0.36547085642814636, "acc": 0.842382550239563, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.3550219237804413, "acc": 0.839249312877655, "length": 3.9996659755706787, "mode": "train", "epoch": 31}
{"loss": 0.3764370381832123, "acc": 0.8308592438697815, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.3515545427799225, "acc": 0.8405480980873108, "length": 3.999838352203369, "mode": "train", "epoch": 32}
{"loss": 0.35592788457870483, "acc": 0.8458008766174316, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.3462524116039276, "acc": 0.8443789482116699, "length": 3.999683141708374, "mode": "train", "epoch": 33}
{"loss": 0.35957348346710205, "acc": 0.8396483063697815, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.3434143364429474, "acc": 0.84690922498703, "length": 3.999835252761841, "mode": "train", "epoch": 34}
{"loss": 0.3531968295574188, "acc": 0.8441404700279236, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.34109747409820557, "acc": 0.8474171757698059, "length": 3.999910831451416, "mode": "train", "epoch": 35}
{"loss": 0.34795063734054565, "acc": 0.8498047590255737, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.34066328406333923, "acc": 0.8496025204658508, "length": 3.9998934268951416, "mode": "train", "epoch": 36}
{"loss": 0.3493550717830658, "acc": 0.850000262260437, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.3355170786380768, "acc": 0.854340672492981, "length": 3.999929428100586, "mode": "train", "epoch": 37}
{"loss": 0.3481336236000061, "acc": 0.8492189049720764, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.33318662643432617, "acc": 0.8540037870407104, "length": 3.9999184608459473, "mode": "train", "epoch": 38}
{"loss": 0.34258997440338135, "acc": 0.8516601920127869, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.3350013494491577, "acc": 0.8530792593955994, "length": 3.999931812286377, "mode": "train", "epoch": 39}
{"loss": 0.35063523054122925, "acc": 0.8527344465255737, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.33097371459007263, "acc": 0.8553484082221985, "length": 3.9999043941497803, "mode": "train", "epoch": 40}
{"loss": 0.3493818938732147, "acc": 0.8520508408546448, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.3270746171474457, "acc": 0.8578663468360901, "length": 3.999816417694092, "mode": "train", "epoch": 41}
{"loss": 0.3435695767402649, "acc": 0.8533202409744263, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.32683905959129333, "acc": 0.8570882081985474, "length": 3.999955654144287, "mode": "train", "epoch": 42}
{"loss": 0.3327236771583557, "acc": 0.8603515625, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.3205106258392334, "acc": 0.8616517782211304, "length": 3.9998679161071777, "mode": "train", "epoch": 43}
{"loss": 0.3330439031124115, "acc": 0.8582029938697815, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.320195734500885, "acc": 0.8611811995506287, "length": 3.9999735355377197, "mode": "train", "epoch": 44}
{"loss": 0.33732128143310547, "acc": 0.8559569716453552, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.3219645917415619, "acc": 0.85992032289505, "length": 3.999979257583618, "mode": "train", "epoch": 45}
{"loss": 0.34558722376823425, "acc": 0.8584960699081421, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.32019945979118347, "acc": 0.8588458299636841, "length": 3.999805212020874, "mode": "train", "epoch": 46}
{"loss": 0.33431705832481384, "acc": 0.8575196862220764, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.3172535002231598, "acc": 0.8627490997314453, "length": 3.9999539852142334, "mode": "train", "epoch": 47}
{"loss": 0.3345073461532593, "acc": 0.8588867783546448, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.3138221800327301, "acc": 0.8650764226913452, "length": 3.9999682903289795, "mode": "train", "epoch": 48}
{"loss": 0.320820689201355, "acc": 0.8670898079872131, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.3101254105567932, "acc": 0.8680199980735779, "length": 3.999981641769409, "mode": "train", "epoch": 49}
{"loss": 0.33016237616539, "acc": 0.8606444001197815, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.3084743618965149, "acc": 0.8688033819198608, "length": 3.999959707260132, "mode": "train", "epoch": 50}
{"loss": 0.3223070502281189, "acc": 0.8673825860023499, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.3056184649467468, "acc": 0.8707322478294373, "length": 3.99991512298584, "mode": "train", "epoch": 51}
{"loss": 0.3212144374847412, "acc": 0.8666015863418579, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.30618545413017273, "acc": 0.8697572946548462, "length": 3.9999754428863525, "mode": "train", "epoch": 52}
{"loss": 0.32421594858169556, "acc": 0.866796612739563, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.29939860105514526, "acc": 0.8755599856376648, "length": 3.9999940395355225, "mode": "train", "epoch": 53}
{"loss": 0.31048694252967834, "acc": 0.8731445670127869, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.2965809106826782, "acc": 0.8773795366287231, "length": 3.9999685287475586, "mode": "train", "epoch": 54}
{"loss": 0.31417378783226013, "acc": 0.8721679449081421, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.29573407769203186, "acc": 0.8762887716293335, "length": 3.9999938011169434, "mode": "train", "epoch": 55}
{"loss": 0.31163761019706726, "acc": 0.8719726204872131, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.2924768924713135, "acc": 0.8790075778961182, "length": 3.9999961853027344, "mode": "train", "epoch": 56}
{"loss": 0.3049052953720093, "acc": 0.8785156607627869, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.290802538394928, "acc": 0.879595935344696, "length": 3.9999940395355225, "mode": "train", "epoch": 57}
{"loss": 0.3251684308052063, "acc": 0.8716797232627869, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.2944924831390381, "acc": 0.8799601197242737, "length": 3.9999921321868896, "mode": "train", "epoch": 58}
{"loss": 0.307961106300354, "acc": 0.8765624761581421, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.2871105670928955, "acc": 0.8828193545341492, "length": 3.999998092651367, "mode": "train", "epoch": 59}
{"loss": 0.3076994717121124, "acc": 0.8807616233825684, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.2835797369480133, "acc": 0.8861824870109558, "length": 3.9999983310699463, "mode": "train", "epoch": 60}
{"loss": 0.2872547209262848, "acc": 0.8908200860023499, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8347581624984741
