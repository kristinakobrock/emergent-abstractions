# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.693611204624176, "acc": 0.5093646049499512, "length": 3.449397563934326, "mode": "train", "epoch": 1}
{"loss": 0.6921026110649109, "acc": 0.5188367366790771, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6718348860740662, "acc": 0.6123948097229004, "length": 2.9178247451782227, "mode": "train", "epoch": 2}
{"loss": 0.6082110404968262, "acc": 0.7347330451011658, "length": 3.109375, "mode": "test", "epoch": 2}
{"loss": 0.5363935232162476, "acc": 0.7419933080673218, "length": 3.578479290008545, "mode": "train", "epoch": 3}
{"loss": 0.5121324062347412, "acc": 0.7567709684371948, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.4738518297672272, "acc": 0.7780309319496155, "length": 3.9460225105285645, "mode": "train", "epoch": 4}
{"loss": 0.4891500473022461, "acc": 0.7817709445953369, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.4452240765094757, "acc": 0.800224781036377, "length": 3.972975730895996, "mode": "train", "epoch": 5}
{"loss": 0.45026159286499023, "acc": 0.8018229603767395, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.41191044449806213, "acc": 0.8237789273262024, "length": 3.98474383354187, "mode": "train", "epoch": 6}
{"loss": 0.4332309365272522, "acc": 0.8105902075767517, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.38940003514289856, "acc": 0.8343832492828369, "length": 3.990237236022949, "mode": "train", "epoch": 7}
{"loss": 0.4177453815937042, "acc": 0.8103299140930176, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.37106916308403015, "acc": 0.8422560691833496, "length": 3.994126558303833, "mode": "train", "epoch": 8}
{"loss": 0.4255572259426117, "acc": 0.8141492605209351, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.356773316860199, "acc": 0.8514137864112854, "length": 3.995675563812256, "mode": "train", "epoch": 9}
{"loss": 0.3913520872592926, "acc": 0.8345485925674438, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.3457227349281311, "acc": 0.8555005192756653, "length": 3.997042417526245, "mode": "train", "epoch": 10}
{"loss": 0.413679301738739, "acc": 0.8144964575767517, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.33636921644210815, "acc": 0.8616552352905273, "length": 3.9974987506866455, "mode": "train", "epoch": 11}
{"loss": 0.3618546426296234, "acc": 0.8473958969116211, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.3275336027145386, "acc": 0.8640195727348328, "length": 3.9982876777648926, "mode": "train", "epoch": 12}
{"loss": 0.36524781584739685, "acc": 0.8475693464279175, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.3194373548030853, "acc": 0.8730612993240356, "length": 3.99851131439209, "mode": "train", "epoch": 13}
{"loss": 0.3553895056247711, "acc": 0.8594618439674377, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3100237548351288, "acc": 0.8749955296516418, "length": 3.997769355773926, "mode": "train", "epoch": 14}
{"loss": 0.33169782161712646, "acc": 0.8603298664093018, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.28924280405044556, "acc": 0.8839704394340515, "length": 3.9986209869384766, "mode": "train", "epoch": 15}
{"loss": 0.31455299258232117, "acc": 0.8775172829627991, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.28015071153640747, "acc": 0.8905482888221741, "length": 3.999272584915161, "mode": "train", "epoch": 16}
{"loss": 0.29991352558135986, "acc": 0.878819465637207, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.27240240573883057, "acc": 0.8942489624023438, "length": 3.999394655227661, "mode": "train", "epoch": 17}
{"loss": 0.29838070273399353, "acc": 0.8791666030883789, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.26503729820251465, "acc": 0.8939511179924011, "length": 3.999566078186035, "mode": "train", "epoch": 18}
{"loss": 0.287055641412735, "acc": 0.8907119035720825, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.2589060068130493, "acc": 0.8985281586647034, "length": 3.9996418952941895, "mode": "train", "epoch": 19}
{"loss": 0.28266897797584534, "acc": 0.8941841125488281, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.253815621137619, "acc": 0.8989470601081848, "length": 3.999779224395752, "mode": "train", "epoch": 20}
{"loss": 0.27203577756881714, "acc": 0.8999999165534973, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.245705708861351, "acc": 0.903385579586029, "length": 3.999830484390259, "mode": "train", "epoch": 21}
{"loss": 0.2631573975086212, "acc": 0.9026041030883789, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.24803496897220612, "acc": 0.9034132361412048, "length": 3.999835252761841, "mode": "train", "epoch": 22}
{"loss": 0.27835941314697266, "acc": 0.8967015147209167, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.24994419515132904, "acc": 0.9010452628135681, "length": 3.999922752380371, "mode": "train", "epoch": 23}
{"loss": 0.271348237991333, "acc": 0.8962673544883728, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.23981189727783203, "acc": 0.9049041867256165, "length": 3.999885320663452, "mode": "train", "epoch": 24}
{"loss": 0.2633620798587799, "acc": 0.898524284362793, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.23507468402385712, "acc": 0.9068610668182373, "length": 3.9999146461486816, "mode": "train", "epoch": 25}
{"loss": 0.2639716565608978, "acc": 0.9015624523162842, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.23512741923332214, "acc": 0.9068602323532104, "length": 3.999907970428467, "mode": "train", "epoch": 26}
{"loss": 0.25713324546813965, "acc": 0.9030381441116333, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.2389558106660843, "acc": 0.9069719314575195, "length": 3.9999465942382812, "mode": "train", "epoch": 27}
{"loss": 0.25371643900871277, "acc": 0.9060763120651245, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.2370680719614029, "acc": 0.9067245125770569, "length": 3.99995756149292, "mode": "train", "epoch": 28}
{"loss": 0.24990558624267578, "acc": 0.8984375, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.22406639158725739, "acc": 0.9103080630302429, "length": 3.9999775886535645, "mode": "train", "epoch": 29}
{"loss": 0.24949556589126587, "acc": 0.9050347208976746, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.22218509018421173, "acc": 0.9120716452598572, "length": 3.999969959259033, "mode": "train", "epoch": 30}
{"loss": 0.2470250129699707, "acc": 0.9061630964279175, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.2224416881799698, "acc": 0.9120723605155945, "length": 3.9999887943267822, "mode": "train", "epoch": 31}
{"loss": 0.2475426197052002, "acc": 0.9058159589767456, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.2254035919904709, "acc": 0.9112456440925598, "length": 3.999990940093994, "mode": "train", "epoch": 32}
{"loss": 0.2409348487854004, "acc": 0.9106770753860474, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.2190306931734085, "acc": 0.914029598236084, "length": 3.9999940395355225, "mode": "train", "epoch": 33}
{"loss": 0.2359917163848877, "acc": 0.9077257513999939, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.21684741973876953, "acc": 0.9136432409286499, "length": 3.9999639987945557, "mode": "train", "epoch": 34}
{"loss": 0.24534127116203308, "acc": 0.9051215648651123, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.2165336012840271, "acc": 0.9138918519020081, "length": 3.999995470046997, "mode": "train", "epoch": 35}
{"loss": 0.23429860174655914, "acc": 0.9107639789581299, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.21369999647140503, "acc": 0.9163724780082703, "length": 3.9999961853027344, "mode": "train", "epoch": 36}
{"loss": 0.2830750048160553, "acc": 0.8903646469116211, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.231084406375885, "acc": 0.908544659614563, "length": 3.9999966621398926, "mode": "train", "epoch": 37}
{"loss": 0.26263362169265747, "acc": 0.9049479365348816, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.2216210663318634, "acc": 0.9133132100105286, "length": 3.9999988079071045, "mode": "train", "epoch": 38}
{"loss": 0.23710693418979645, "acc": 0.910243034362793, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.22067949175834656, "acc": 0.9136713147163391, "length": 3.999997854232788, "mode": "train", "epoch": 39}
{"loss": 0.25096118450164795, "acc": 0.9051215648651123, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.22032815217971802, "acc": 0.9153527617454529, "length": 3.9999983310699463, "mode": "train", "epoch": 40}
{"loss": 0.2647438645362854, "acc": 0.9003472924232483, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.2300415337085724, "acc": 0.9107187390327454, "length": 3.9998154640197754, "mode": "train", "epoch": 41}
{"loss": 0.25116291642189026, "acc": 0.9065971374511719, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.21989384293556213, "acc": 0.9137263298034668, "length": 3.9999923706054688, "mode": "train", "epoch": 42}
{"loss": 0.24770943820476532, "acc": 0.9066840410232544, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.2173316329717636, "acc": 0.9154077768325806, "length": 3.999990224838257, "mode": "train", "epoch": 43}
{"loss": 0.2487284392118454, "acc": 0.9044269919395447, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.2114843726158142, "acc": 0.9185501933097839, "length": 3.9999988079071045, "mode": "train", "epoch": 44}
{"loss": 0.2311040610074997, "acc": 0.9149305820465088, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.21091298758983612, "acc": 0.9184120893478394, "length": 3.9999961853027344, "mode": "train", "epoch": 45}
{"loss": 0.22908993065357208, "acc": 0.9151042103767395, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.20282162725925446, "acc": 0.9219403862953186, "length": 3.9999985694885254, "mode": "train", "epoch": 46}
{"loss": 0.22949859499931335, "acc": 0.9167534708976746, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.21137195825576782, "acc": 0.9182466864585876, "length": 3.999995231628418, "mode": "train", "epoch": 47}
{"loss": 0.24945217370986938, "acc": 0.9113714694976807, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.21209870278835297, "acc": 0.9199557900428772, "length": 3.9999988079071045, "mode": "train", "epoch": 48}
{"loss": 0.23662662506103516, "acc": 0.9151042103767395, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.20283228158950806, "acc": 0.921444296836853, "length": 3.9999988079071045, "mode": "train", "epoch": 49}
{"loss": 0.23759150505065918, "acc": 0.9098089933395386, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.19803012907505035, "acc": 0.9226844310760498, "length": 3.999995470046997, "mode": "train", "epoch": 50}
{"loss": 0.22908131778240204, "acc": 0.9167534708976746, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.19890034198760986, "acc": 0.92307049036026, "length": 3.9999985694885254, "mode": "train", "epoch": 51}
{"loss": 0.22193643450737, "acc": 0.9170138239860535, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.19816626608371735, "acc": 0.9220230579376221, "length": 3.9999959468841553, "mode": "train", "epoch": 52}
{"loss": 0.21862763166427612, "acc": 0.9190104603767395, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.19490832090377808, "acc": 0.92477947473526, "length": 3.999999523162842, "mode": "train", "epoch": 53}
{"loss": 0.22829487919807434, "acc": 0.9140625, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.19033220410346985, "acc": 0.9254409670829773, "length": 3.999995470046997, "mode": "train", "epoch": 54}
{"loss": 0.21952451765537262, "acc": 0.9201390147209167, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.19028429687023163, "acc": 0.9257442355155945, "length": 3.999999761581421, "mode": "train", "epoch": 55}
{"loss": 0.22183339297771454, "acc": 0.9215278625488281, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.18786373734474182, "acc": 0.9279488325119019, "length": 3.9999923706054688, "mode": "train", "epoch": 56}
{"loss": 0.21414414048194885, "acc": 0.9227430820465088, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.19011127948760986, "acc": 0.9269014596939087, "length": 3.999993085861206, "mode": "train", "epoch": 57}
{"loss": 0.23729906976222992, "acc": 0.9169270396232605, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.1880415678024292, "acc": 0.9273151159286499, "length": 3.9999940395355225, "mode": "train", "epoch": 58}
{"loss": 0.2233666628599167, "acc": 0.9196180701255798, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.18735960125923157, "acc": 0.9269569516181946, "length": 3.9999983310699463, "mode": "train", "epoch": 59}
{"loss": 0.2356172353029251, "acc": 0.917881965637207, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.18560479581356049, "acc": 0.9270671010017395, "length": 3.9999940395355225, "mode": "train", "epoch": 60}
{"loss": 0.22873619198799133, "acc": 0.9177083969116211, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.855431079864502
