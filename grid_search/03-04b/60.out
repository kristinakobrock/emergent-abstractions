# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6965048909187317, "acc": 0.5018521547317505, "length": 3.5440468788146973, "mode": "train", "epoch": 1}
{"loss": 0.6923905611038208, "acc": 0.5048828125, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6917281150817871, "acc": 0.5181941390037537, "length": 2.9191038608551025, "mode": "train", "epoch": 2}
{"loss": 0.6839191317558289, "acc": 0.5957610607147217, "length": 1.693359375, "mode": "test", "epoch": 2}
{"loss": 0.6727726459503174, "acc": 0.6310400366783142, "length": 2.5335028171539307, "mode": "train", "epoch": 3}
{"loss": 0.6428282260894775, "acc": 0.6911979913711548, "length": 2.458984375, "mode": "test", "epoch": 3}
{"loss": 0.6240140795707703, "acc": 0.661803662776947, "length": 2.6645865440368652, "mode": "train", "epoch": 4}
{"loss": 0.6035639643669128, "acc": 0.6683929562568665, "length": 3.052734375, "mode": "test", "epoch": 4}
{"loss": 0.5907533764839172, "acc": 0.6708117723464966, "length": 3.210094451904297, "mode": "train", "epoch": 5}
{"loss": 0.5812035202980042, "acc": 0.6625792384147644, "length": 3.341796875, "mode": "test", "epoch": 5}
{"loss": 0.5664334893226624, "acc": 0.7031757831573486, "length": 3.4416911602020264, "mode": "train", "epoch": 6}
{"loss": 0.5477043390274048, "acc": 0.721208930015564, "length": 3.515625, "mode": "test", "epoch": 6}
{"loss": 0.5174537301063538, "acc": 0.7542599439620972, "length": 3.8822858333587646, "mode": "train", "epoch": 7}
{"loss": 0.5353670716285706, "acc": 0.726294755935669, "length": 3.998046875, "mode": "test", "epoch": 7}
{"loss": 0.4946163296699524, "acc": 0.773464024066925, "length": 3.9851186275482178, "mode": "train", "epoch": 8}
{"loss": 0.5321590900421143, "acc": 0.7361327409744263, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.47999733686447144, "acc": 0.7808923125267029, "length": 3.990551233291626, "mode": "train", "epoch": 9}
{"loss": 0.5104180574417114, "acc": 0.7477538585662842, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.4796331524848938, "acc": 0.7869040369987488, "length": 3.9918038845062256, "mode": "train", "epoch": 10}
{"loss": 0.5086684823036194, "acc": 0.7536131143569946, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.47169065475463867, "acc": 0.7923668026924133, "length": 3.9874730110168457, "mode": "train", "epoch": 11}
{"loss": 0.48452484607696533, "acc": 0.7713867425918579, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.4578786790370941, "acc": 0.7983637452125549, "length": 3.993995428085327, "mode": "train", "epoch": 12}
{"loss": 0.46890926361083984, "acc": 0.8035154938697815, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.4531155824661255, "acc": 0.8062225580215454, "length": 3.9975662231445312, "mode": "train", "epoch": 13}
{"loss": 0.4687815308570862, "acc": 0.8017578125, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.44874805212020874, "acc": 0.8074284195899963, "length": 3.9952311515808105, "mode": "train", "epoch": 14}
{"loss": 0.4685116410255432, "acc": 0.8040038347244263, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.44632330536842346, "acc": 0.8090023398399353, "length": 3.997878074645996, "mode": "train", "epoch": 15}
{"loss": 0.46168646216392517, "acc": 0.7993163466453552, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.43672147393226624, "acc": 0.8134774565696716, "length": 3.9979169368743896, "mode": "train", "epoch": 16}
{"loss": 0.4445498585700989, "acc": 0.8125977516174316, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.4329199194908142, "acc": 0.8153004050254822, "length": 3.9985530376434326, "mode": "train", "epoch": 17}
{"loss": 0.4481470584869385, "acc": 0.8143554925918579, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.43242594599723816, "acc": 0.8229399919509888, "length": 3.998943567276001, "mode": "train", "epoch": 18}
{"loss": 0.4410262703895569, "acc": 0.8161133527755737, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.4232771396636963, "acc": 0.8263188004493713, "length": 3.999109983444214, "mode": "train", "epoch": 19}
{"loss": 0.42888739705085754, "acc": 0.8182616829872131, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.4114392101764679, "acc": 0.8292444348335266, "length": 3.9990644454956055, "mode": "train", "epoch": 20}
{"loss": 0.4250449240207672, "acc": 0.8249024748802185, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.4075050950050354, "acc": 0.8353203535079956, "length": 3.999403953552246, "mode": "train", "epoch": 21}
{"loss": 0.42651551961898804, "acc": 0.824121356010437, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.40879544615745544, "acc": 0.8353126645088196, "length": 3.9982354640960693, "mode": "train", "epoch": 22}
{"loss": 0.41804632544517517, "acc": 0.8302735686302185, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.4046211838722229, "acc": 0.8382696509361267, "length": 3.9992637634277344, "mode": "train", "epoch": 23}
{"loss": 0.4100762605667114, "acc": 0.8313475251197815, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.39503201842308044, "acc": 0.8377852439880371, "length": 3.9995923042297363, "mode": "train", "epoch": 24}
{"loss": 0.4160348176956177, "acc": 0.8323241472244263, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.3957756459712982, "acc": 0.8420589566230774, "length": 3.998044013977051, "mode": "train", "epoch": 25}
{"loss": 0.4004240334033966, "acc": 0.8369140028953552, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.38787904381752014, "acc": 0.8412973880767822, "length": 3.999598741531372, "mode": "train", "epoch": 26}
{"loss": 0.4011039137840271, "acc": 0.8462890982627869, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.38981160521507263, "acc": 0.8420292139053345, "length": 3.9999449253082275, "mode": "train", "epoch": 27}
{"loss": 0.40986114740371704, "acc": 0.8315430283546448, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.38212570548057556, "acc": 0.8444035649299622, "length": 3.998425006866455, "mode": "train", "epoch": 28}
{"loss": 0.39358824491500854, "acc": 0.8350585699081421, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.3743201196193695, "acc": 0.846788763999939, "length": 3.9999306201934814, "mode": "train", "epoch": 29}
{"loss": 0.39744704961776733, "acc": 0.8373046517372131, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.37999358773231506, "acc": 0.8482226133346558, "length": 3.999799966812134, "mode": "train", "epoch": 30}
{"loss": 0.3765340745449066, "acc": 0.841699481010437, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.36934173107147217, "acc": 0.846845269203186, "length": 3.999985694885254, "mode": "train", "epoch": 31}
{"loss": 0.37029311060905457, "acc": 0.8505859375, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.36134856939315796, "acc": 0.853458046913147, "length": 3.999969244003296, "mode": "train", "epoch": 32}
{"loss": 0.37372279167175293, "acc": 0.8526367545127869, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.3632122278213501, "acc": 0.8495813012123108, "length": 3.999882221221924, "mode": "train", "epoch": 33}
{"loss": 0.35905519127845764, "acc": 0.8502930402755737, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.3546885550022125, "acc": 0.8586312532424927, "length": 3.999924659729004, "mode": "train", "epoch": 34}
{"loss": 0.3573293387889862, "acc": 0.8591796159744263, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.35171228647232056, "acc": 0.8585724830627441, "length": 3.9998397827148438, "mode": "train", "epoch": 35}
{"loss": 0.34925878047943115, "acc": 0.8632813096046448, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.3429451882839203, "acc": 0.859012246131897, "length": 3.9989731311798096, "mode": "train", "epoch": 36}
{"loss": 0.34762874245643616, "acc": 0.8590821027755737, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.3349177837371826, "acc": 0.8611201643943787, "length": 3.9998960494995117, "mode": "train", "epoch": 37}
{"loss": 0.34070461988449097, "acc": 0.8602539300918579, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.33288460969924927, "acc": 0.8667356371879578, "length": 3.999849796295166, "mode": "train", "epoch": 38}
{"loss": 0.33648595213890076, "acc": 0.8649414777755737, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.32748523354530334, "acc": 0.8698539137840271, "length": 3.9995806217193604, "mode": "train", "epoch": 39}
{"loss": 0.3389286398887634, "acc": 0.8711913824081421, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.32936111092567444, "acc": 0.8666821122169495, "length": 3.9993298053741455, "mode": "train", "epoch": 40}
{"loss": 0.3294718563556671, "acc": 0.8700194954872131, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.32440364360809326, "acc": 0.8717207908630371, "length": 3.999990463256836, "mode": "train", "epoch": 41}
{"loss": 0.3196979761123657, "acc": 0.8698242902755737, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.31495484709739685, "acc": 0.8738237023353577, "length": 3.9999890327453613, "mode": "train", "epoch": 42}
{"loss": 0.3235856294631958, "acc": 0.8751955032348633, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.31261536478996277, "acc": 0.878849446773529, "length": 3.9990651607513428, "mode": "train", "epoch": 43}
{"loss": 0.31669700145721436, "acc": 0.8777342438697815, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.315156489610672, "acc": 0.8723573088645935, "length": 3.9999938011169434, "mode": "train", "epoch": 44}
{"loss": 0.3056381940841675, "acc": 0.8861327767372131, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.3183600902557373, "acc": 0.868452787399292, "length": 3.9999277591705322, "mode": "train", "epoch": 45}
{"loss": 0.3179911673069, "acc": 0.8787111043930054, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.3064597249031067, "acc": 0.8757295608520508, "length": 3.9999091625213623, "mode": "train", "epoch": 46}
{"loss": 0.30784207582473755, "acc": 0.8835936188697815, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.29686811566352844, "acc": 0.8815154433250427, "length": 3.9999794960021973, "mode": "train", "epoch": 47}
{"loss": 0.2828871011734009, "acc": 0.8934568762779236, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.288444846868515, "acc": 0.8868550658226013, "length": 3.9999637603759766, "mode": "train", "epoch": 48}
{"loss": 0.29015085101127625, "acc": 0.8885741829872131, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.2911292314529419, "acc": 0.8839735984802246, "length": 3.999873638153076, "mode": "train", "epoch": 49}
{"loss": 0.2787877321243286, "acc": 0.8923826813697815, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.27822062373161316, "acc": 0.8895277976989746, "length": 3.999661445617676, "mode": "train", "epoch": 50}
{"loss": 0.2777373790740967, "acc": 0.8902344107627869, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.27806293964385986, "acc": 0.8925542831420898, "length": 3.999938726425171, "mode": "train", "epoch": 51}
{"loss": 0.27112773060798645, "acc": 0.8975585699081421, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.2681630253791809, "acc": 0.8942533135414124, "length": 3.999605417251587, "mode": "train", "epoch": 52}
{"loss": 0.2661270797252655, "acc": 0.8954101800918579, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.26838478446006775, "acc": 0.8893168568611145, "length": 3.9999356269836426, "mode": "train", "epoch": 53}
{"loss": 0.26852700114250183, "acc": 0.8959961533546448, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.27432891726493835, "acc": 0.893634557723999, "length": 3.999969482421875, "mode": "train", "epoch": 54}
{"loss": 0.2697542607784271, "acc": 0.8980469107627869, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.2663210928440094, "acc": 0.8918360471725464, "length": 3.9999730587005615, "mode": "train", "epoch": 55}
{"loss": 0.26576098799705505, "acc": 0.8940428495407104, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.26780980825424194, "acc": 0.8922215104103088, "length": 3.9994874000549316, "mode": "train", "epoch": 56}
{"loss": 0.2771209478378296, "acc": 0.8928709030151367, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.2850792109966278, "acc": 0.8877691626548767, "length": 3.9999866485595703, "mode": "train", "epoch": 57}
{"loss": 0.281326025724411, "acc": 0.8931640386581421, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.2627829313278198, "acc": 0.8946041464805603, "length": 3.999997854232788, "mode": "train", "epoch": 58}
{"loss": 0.26961931586265564, "acc": 0.8946290016174316, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.2607949674129486, "acc": 0.8984227180480957, "length": 3.999997615814209, "mode": "train", "epoch": 59}
{"loss": 0.2617061734199524, "acc": 0.8999024629592896, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.25326645374298096, "acc": 0.8999142050743103, "length": 3.999948740005493, "mode": "train", "epoch": 60}
{"loss": 0.25797536969184875, "acc": 0.9033203721046448, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7944914102554321
