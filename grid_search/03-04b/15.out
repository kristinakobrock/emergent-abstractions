# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6625788807868958, "acc": 0.5675320625305176, "length": 3.6615099906921387, "mode": "train", "epoch": 1}
{"loss": 0.6079869270324707, "acc": 0.6344617605209351, "length": 4.0, "mode": "test", "epoch": 1}
{"loss": 0.5805819630622864, "acc": 0.6761717200279236, "length": 3.9685161113739014, "mode": "train", "epoch": 2}
{"loss": 0.5693984627723694, "acc": 0.6772570610046387, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.5390008687973022, "acc": 0.7280565500259399, "length": 3.9935789108276367, "mode": "train", "epoch": 3}
{"loss": 0.5532272458076477, "acc": 0.7342013120651245, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.5255997180938721, "acc": 0.7396742701530457, "length": 3.997117280960083, "mode": "train", "epoch": 4}
{"loss": 0.5530142188072205, "acc": 0.7010416984558105, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.5077343583106995, "acc": 0.7556140422821045, "length": 3.9983880519866943, "mode": "train", "epoch": 5}
{"loss": 0.5104184150695801, "acc": 0.745312511920929, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.48255252838134766, "acc": 0.7715590000152588, "length": 3.9989678859710693, "mode": "train", "epoch": 6}
{"loss": 0.4779232442378998, "acc": 0.7734375596046448, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.45117050409317017, "acc": 0.7868141531944275, "length": 3.997384786605835, "mode": "train", "epoch": 7}
{"loss": 0.45852503180503845, "acc": 0.7776909470558167, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.44255563616752625, "acc": 0.787470817565918, "length": 3.9987545013427734, "mode": "train", "epoch": 8}
{"loss": 0.4891170859336853, "acc": 0.778124988079071, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.42759597301483154, "acc": 0.7995391488075256, "length": 3.9986209869384766, "mode": "train", "epoch": 9}
{"loss": 0.4332643151283264, "acc": 0.795138955116272, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.41400644183158875, "acc": 0.8046687841415405, "length": 3.999598979949951, "mode": "train", "epoch": 10}
{"loss": 0.441484659910202, "acc": 0.7908854484558105, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.4100002944469452, "acc": 0.8110352158546448, "length": 3.999789237976074, "mode": "train", "epoch": 11}
{"loss": 0.4602958858013153, "acc": 0.7739583849906921, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.4004928171634674, "acc": 0.8183948397636414, "length": 3.9997918605804443, "mode": "train", "epoch": 12}
{"loss": 0.4262818992137909, "acc": 0.8168402314186096, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.387297123670578, "acc": 0.8275262117385864, "length": 3.999735116958618, "mode": "train", "epoch": 13}
{"loss": 0.413004606962204, "acc": 0.8121528029441833, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3817952275276184, "acc": 0.825886607170105, "length": 3.999354839324951, "mode": "train", "epoch": 14}
{"loss": 0.4003927707672119, "acc": 0.8168402314186096, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3754218816757202, "acc": 0.8354244232177734, "length": 3.999333143234253, "mode": "train", "epoch": 15}
{"loss": 0.4406293034553528, "acc": 0.7933158874511719, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.4061431288719177, "acc": 0.8254721760749817, "length": 3.999701499938965, "mode": "train", "epoch": 16}
{"loss": 0.40937966108322144, "acc": 0.8199653029441833, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.37472912669181824, "acc": 0.835594654083252, "length": 3.9996514320373535, "mode": "train", "epoch": 17}
{"loss": 0.4214699864387512, "acc": 0.823437511920929, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.3689541816711426, "acc": 0.8402854204177856, "length": 3.999925136566162, "mode": "train", "epoch": 18}
{"loss": 0.4078907072544098, "acc": 0.8269097208976746, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.3695305585861206, "acc": 0.8385114073753357, "length": 3.9998393058776855, "mode": "train", "epoch": 19}
{"loss": 0.39888861775398254, "acc": 0.8193576335906982, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.35888364911079407, "acc": 0.8412256836891174, "length": 3.9999210834503174, "mode": "train", "epoch": 20}
{"loss": 0.37647348642349243, "acc": 0.8348957300186157, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.349985271692276, "acc": 0.8438007831573486, "length": 3.9999589920043945, "mode": "train", "epoch": 21}
{"loss": 0.38525450229644775, "acc": 0.8322049379348755, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.3550841510295868, "acc": 0.8427451848983765, "length": 3.9993581771850586, "mode": "train", "epoch": 22}
{"loss": 0.36701661348342896, "acc": 0.8401909470558167, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.3441765606403351, "acc": 0.8476470708847046, "length": 3.999972105026245, "mode": "train", "epoch": 23}
{"loss": 0.39313510060310364, "acc": 0.8217014074325562, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.37446144223213196, "acc": 0.8378967642784119, "length": 3.999819040298462, "mode": "train", "epoch": 24}
{"loss": 0.38117489218711853, "acc": 0.8413195013999939, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.3570462763309479, "acc": 0.8501841425895691, "length": 3.9998514652252197, "mode": "train", "epoch": 25}
{"loss": 0.38174694776535034, "acc": 0.8447048664093018, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.36641642451286316, "acc": 0.8472245335578918, "length": 3.9998433589935303, "mode": "train", "epoch": 26}
{"loss": 0.376339316368103, "acc": 0.8495660424232483, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.3504551351070404, "acc": 0.8575417995452881, "length": 3.9996845722198486, "mode": "train", "epoch": 27}
{"loss": 0.3562476933002472, "acc": 0.856249988079071, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.36176854372024536, "acc": 0.8502198457717896, "length": 3.999964714050293, "mode": "train", "epoch": 28}
{"loss": 0.38565078377723694, "acc": 0.8478299975395203, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.343062162399292, "acc": 0.8596825003623962, "length": 3.99995493888855, "mode": "train", "epoch": 29}
{"loss": 0.3562420606613159, "acc": 0.8593750596046448, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.32668063044548035, "acc": 0.8679802417755127, "length": 3.9999163150787354, "mode": "train", "epoch": 30}
{"loss": 0.3463127017021179, "acc": 0.8644964694976807, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.3249679505825043, "acc": 0.8645532131195068, "length": 3.9999783039093018, "mode": "train", "epoch": 31}
{"loss": 0.3657661974430084, "acc": 0.8402777910232544, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.3299051523208618, "acc": 0.8623088598251343, "length": 3.9999237060546875, "mode": "train", "epoch": 32}
{"loss": 0.3559146225452423, "acc": 0.853298544883728, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.33240562677383423, "acc": 0.8609814643859863, "length": 3.9999451637268066, "mode": "train", "epoch": 33}
{"loss": 0.3454073369503021, "acc": 0.8553819060325623, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.31545934081077576, "acc": 0.8702961802482605, "length": 3.9998416900634766, "mode": "train", "epoch": 34}
{"loss": 0.33213043212890625, "acc": 0.8622395396232605, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.3081556260585785, "acc": 0.8732084035873413, "length": 3.9998817443847656, "mode": "train", "epoch": 35}
{"loss": 0.3383340835571289, "acc": 0.8613714575767517, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.30615419149398804, "acc": 0.874875009059906, "length": 3.999993324279785, "mode": "train", "epoch": 36}
{"loss": 0.34669098258018494, "acc": 0.8553819060325623, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.30577173829078674, "acc": 0.8779464364051819, "length": 3.9999961853027344, "mode": "train", "epoch": 37}
{"loss": 0.3290463984012604, "acc": 0.8680555820465088, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.2963651120662689, "acc": 0.8833974599838257, "length": 3.999990701675415, "mode": "train", "epoch": 38}
{"loss": 0.3285292685031891, "acc": 0.8731771111488342, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.30315011739730835, "acc": 0.8789932727813721, "length": 3.999943971633911, "mode": "train", "epoch": 39}
{"loss": 0.3326784670352936, "acc": 0.8736979961395264, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.29626142978668213, "acc": 0.8792749643325806, "length": 3.99999737739563, "mode": "train", "epoch": 40}
{"loss": 0.31612974405288696, "acc": 0.8753471970558167, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.30132243037223816, "acc": 0.88151615858078, "length": 3.999995231628418, "mode": "train", "epoch": 41}
{"loss": 0.32718443870544434, "acc": 0.8747396469116211, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.2961314618587494, "acc": 0.8800771236419678, "length": 3.9999914169311523, "mode": "train", "epoch": 42}
{"loss": 0.3343452513217926, "acc": 0.8583332896232605, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.3117744028568268, "acc": 0.8725511431694031, "length": 3.999999761581421, "mode": "train", "epoch": 43}
{"loss": 0.3150412440299988, "acc": 0.8717014789581299, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.2910132110118866, "acc": 0.8825953602790833, "length": 4.0, "mode": "train", "epoch": 44}
{"loss": 0.30157312750816345, "acc": 0.8811632990837097, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.2882934510707855, "acc": 0.8859434723854065, "length": 3.9999983310699463, "mode": "train", "epoch": 45}
{"loss": 0.3007858991622925, "acc": 0.8832465410232544, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.3100763261318207, "acc": 0.8728832602500916, "length": 4.0, "mode": "train", "epoch": 46}
{"loss": 0.33012107014656067, "acc": 0.8628472089767456, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.31519007682800293, "acc": 0.8676257133483887, "length": 3.9999988079071045, "mode": "train", "epoch": 47}
{"loss": 0.3193186819553375, "acc": 0.8589409589767456, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.2896628677845001, "acc": 0.8837575912475586, "length": 4.0, "mode": "train", "epoch": 48}
{"loss": 0.32129424810409546, "acc": 0.8760417103767395, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.28426313400268555, "acc": 0.8852241039276123, "length": 4.0, "mode": "train", "epoch": 49}
{"loss": 0.3364953100681305, "acc": 0.8636284470558167, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.28379109501838684, "acc": 0.8835915923118591, "length": 3.999999761581421, "mode": "train", "epoch": 50}
{"loss": 0.3156961500644684, "acc": 0.8767361044883728, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.2742011249065399, "acc": 0.8915053009986877, "length": 3.999999761581421, "mode": "train", "epoch": 51}
{"loss": 0.29718315601348877, "acc": 0.8835068345069885, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.26757869124412537, "acc": 0.8949085474014282, "length": 3.99999737739563, "mode": "train", "epoch": 52}
{"loss": 0.29174551367759705, "acc": 0.8874130845069885, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.267353892326355, "acc": 0.8941062092781067, "length": 4.0, "mode": "train", "epoch": 53}
{"loss": 0.29772505164146423, "acc": 0.8846355080604553, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.2669919431209564, "acc": 0.8958765864372253, "length": 3.9999923706054688, "mode": "train", "epoch": 54}
{"loss": 0.29724398255348206, "acc": 0.8800346851348877, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.29860517382621765, "acc": 0.8787491321563721, "length": 3.9999983310699463, "mode": "train", "epoch": 55}
{"loss": 0.3246324956417084, "acc": 0.8769097924232483, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.3019023835659027, "acc": 0.8745434880256653, "length": 4.0, "mode": "train", "epoch": 56}
{"loss": 0.3408969044685364, "acc": 0.8619792461395264, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.3059340715408325, "acc": 0.8735471367835999, "length": 3.9999988079071045, "mode": "train", "epoch": 57}
{"loss": 0.327272891998291, "acc": 0.8657117486000061, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.291193425655365, "acc": 0.8863863348960876, "length": 3.9999985694885254, "mode": "train", "epoch": 58}
{"loss": 0.2994551658630371, "acc": 0.8797743320465088, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.28235408663749695, "acc": 0.887188732624054, "length": 4.0, "mode": "train", "epoch": 59}
{"loss": 0.30585744976997375, "acc": 0.8779513835906982, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.28024566173553467, "acc": 0.8892083168029785, "length": 3.9999966621398926, "mode": "train", "epoch": 60}
{"loss": 0.30009031295776367, "acc": 0.8836805820465088, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8573729395866394
