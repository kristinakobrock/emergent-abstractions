# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6852504014968872, "acc": 0.5450474619865417, "length": 3.0109355449676514, "mode": "train", "epoch": 1}
{"loss": 0.6412560939788818, "acc": 0.6216525435447693, "length": 2.734375, "mode": "test", "epoch": 1}
{"loss": 0.5711255669593811, "acc": 0.7050054669380188, "length": 3.233823299407959, "mode": "train", "epoch": 2}
{"loss": 0.5336441993713379, "acc": 0.7373019456863403, "length": 3.678819417953491, "mode": "test", "epoch": 2}
{"loss": 0.491178423166275, "acc": 0.7756965160369873, "length": 3.652737855911255, "mode": "train", "epoch": 3}
{"loss": 0.4975608289241791, "acc": 0.771153450012207, "length": 3.7239582538604736, "mode": "test", "epoch": 3}
{"loss": 0.45341184735298157, "acc": 0.8029544949531555, "length": 3.679525136947632, "mode": "train", "epoch": 4}
{"loss": 0.4543978273868561, "acc": 0.8024277091026306, "length": 3.640625, "mode": "test", "epoch": 4}
{"loss": 0.4362049102783203, "acc": 0.8147016763687134, "length": 3.668696641921997, "mode": "train", "epoch": 5}
{"loss": 0.4544406533241272, "acc": 0.8043267726898193, "length": 3.6614582538604736, "mode": "test", "epoch": 5}
{"loss": 0.42342302203178406, "acc": 0.8222295045852661, "length": 3.6813619136810303, "mode": "train", "epoch": 6}
{"loss": 0.48142609000205994, "acc": 0.7901910543441772, "length": 3.699652671813965, "mode": "test", "epoch": 6}
{"loss": 0.42372265458106995, "acc": 0.8227974772453308, "length": 3.7181804180145264, "mode": "train", "epoch": 7}
{"loss": 0.42486339807510376, "acc": 0.8285508751869202, "length": 3.7204861640930176, "mode": "test", "epoch": 7}
{"loss": 0.40124914050102234, "acc": 0.8365598917007446, "length": 3.7470710277557373, "mode": "train", "epoch": 8}
{"loss": 0.40879443287849426, "acc": 0.8367106318473816, "length": 3.7604167461395264, "mode": "test", "epoch": 8}
{"loss": 0.3963852524757385, "acc": 0.8367062211036682, "length": 3.758749485015869, "mode": "train", "epoch": 9}
{"loss": 0.40292471647262573, "acc": 0.8351128101348877, "length": 3.7291667461395264, "mode": "test", "epoch": 9}
{"loss": 0.3885883688926697, "acc": 0.8410801291465759, "length": 3.757322072982788, "mode": "train", "epoch": 10}
{"loss": 0.4046601355075836, "acc": 0.8388535976409912, "length": 3.7135417461395264, "mode": "test", "epoch": 10}
{"loss": 0.38043180108070374, "acc": 0.8447684049606323, "length": 3.7467520236968994, "mode": "train", "epoch": 11}
{"loss": 0.3858899474143982, "acc": 0.8446371555328369, "length": 3.730902671813965, "mode": "test", "epoch": 11}
{"loss": 0.3675284683704376, "acc": 0.8497458100318909, "length": 3.7194066047668457, "mode": "train", "epoch": 12}
{"loss": 0.3671688735485077, "acc": 0.8516222238540649, "length": 3.7552082538604736, "mode": "test", "epoch": 12}
{"loss": 0.35293686389923096, "acc": 0.8557259440422058, "length": 3.740210771560669, "mode": "train", "epoch": 13}
{"loss": 0.3602050244808197, "acc": 0.8583823442459106, "length": 3.7552082538604736, "mode": "test", "epoch": 13}
{"loss": 0.3467436134815216, "acc": 0.8585339188575745, "length": 3.7376790046691895, "mode": "train", "epoch": 14}
{"loss": 0.3602105677127838, "acc": 0.8571099042892456, "length": 3.725694417953491, "mode": "test", "epoch": 14}
{"loss": 0.3406444191932678, "acc": 0.8589227795600891, "length": 3.749659776687622, "mode": "train", "epoch": 15}
{"loss": 0.3538729250431061, "acc": 0.8550103306770325, "length": 3.887152671813965, "mode": "test", "epoch": 15}
{"loss": 0.3230462074279785, "acc": 0.8671441674232483, "length": 3.784424304962158, "mode": "train", "epoch": 16}
{"loss": 0.3225790858268738, "acc": 0.8676812052726746, "length": 3.7951388359069824, "mode": "test", "epoch": 16}
{"loss": 0.3093804121017456, "acc": 0.8733888268470764, "length": 3.823517322540283, "mode": "train", "epoch": 17}
{"loss": 0.3160504400730133, "acc": 0.8749674558639526, "length": 3.852430582046509, "mode": "test", "epoch": 17}
{"loss": 0.29090020060539246, "acc": 0.8808327913284302, "length": 3.8427774906158447, "mode": "train", "epoch": 18}
{"loss": 0.2983388900756836, "acc": 0.8810520172119141, "length": 3.8420138359069824, "mode": "test", "epoch": 18}
{"loss": 0.2860911786556244, "acc": 0.8822189569473267, "length": 3.8500943183898926, "mode": "train", "epoch": 19}
{"loss": 0.2988862693309784, "acc": 0.8796169757843018, "length": 3.8645832538604736, "mode": "test", "epoch": 19}
{"loss": 0.28416708111763, "acc": 0.8843450546264648, "length": 3.851949691772461, "mode": "train", "epoch": 20}
{"loss": 0.2994087040424347, "acc": 0.8780110478401184, "length": 3.8854167461395264, "mode": "test", "epoch": 20}
{"loss": 0.26753905415534973, "acc": 0.8902182579040527, "length": 3.8595166206359863, "mode": "train", "epoch": 21}
{"loss": 0.2796573042869568, "acc": 0.8913628458976746, "length": 3.8541667461395264, "mode": "test", "epoch": 21}
{"loss": 0.26320040225982666, "acc": 0.8949754238128662, "length": 3.870636224746704, "mode": "train", "epoch": 22}
{"loss": 0.292194664478302, "acc": 0.8838080763816833, "length": 3.8697917461395264, "mode": "test", "epoch": 22}
{"loss": 0.2635771930217743, "acc": 0.8952479958534241, "length": 3.8772006034851074, "mode": "train", "epoch": 23}
{"loss": 0.2834063470363617, "acc": 0.8926405310630798, "length": 3.883680582046509, "mode": "test", "epoch": 23}
{"loss": 0.2510930895805359, "acc": 0.9008463621139526, "length": 3.8774757385253906, "mode": "train", "epoch": 24}
{"loss": 0.2753250002861023, "acc": 0.8917073011398315, "length": 3.8854167461395264, "mode": "test", "epoch": 24}
{"loss": 0.2435755878686905, "acc": 0.9035726189613342, "length": 3.875758409500122, "mode": "train", "epoch": 25}
{"loss": 0.25913307070732117, "acc": 0.9057480692863464, "length": 3.8802082538604736, "mode": "test", "epoch": 25}
{"loss": 0.2399885058403015, "acc": 0.9084092974662781, "length": 3.873922109603882, "mode": "train", "epoch": 26}
{"loss": 0.2658684253692627, "acc": 0.8994629383087158, "length": 3.8767361640930176, "mode": "test", "epoch": 26}
{"loss": 0.23678620159626007, "acc": 0.9115263223648071, "length": 3.867985725402832, "mode": "train", "epoch": 27}
{"loss": 0.2561506927013397, "acc": 0.9076985120773315, "length": 3.8697917461395264, "mode": "test", "epoch": 27}
{"loss": 0.23042674362659454, "acc": 0.9135452508926392, "length": 3.879194974899292, "mode": "train", "epoch": 28}
{"loss": 0.2485852837562561, "acc": 0.9114420413970947, "length": 3.8767361640930176, "mode": "test", "epoch": 28}
{"loss": 0.22785484790802002, "acc": 0.9164696931838989, "length": 3.889516830444336, "mode": "train", "epoch": 29}
{"loss": 0.2670758068561554, "acc": 0.902948796749115, "length": 3.887152671813965, "mode": "test", "epoch": 29}
{"loss": 0.22643190622329712, "acc": 0.9144931435585022, "length": 3.898632287979126, "mode": "train", "epoch": 30}
{"loss": 0.24542617797851562, "acc": 0.9112548828125, "length": 3.9010417461395264, "mode": "test", "epoch": 30}
{"loss": 0.22646917402744293, "acc": 0.9160535335540771, "length": 3.8847908973693848, "mode": "train", "epoch": 31}
{"loss": 0.2548938989639282, "acc": 0.9041557312011719, "length": 3.881944417953491, "mode": "test", "epoch": 31}
{"loss": 0.21984417736530304, "acc": 0.9170282483100891, "length": 3.8835458755493164, "mode": "train", "epoch": 32}
{"loss": 0.24318891763687134, "acc": 0.9097656607627869, "length": 3.8767361640930176, "mode": "test", "epoch": 32}
{"loss": 0.27726131677627563, "acc": 0.8893318176269531, "length": 3.9216012954711914, "mode": "train", "epoch": 33}
{"loss": 0.2862432301044464, "acc": 0.8851481676101685, "length": 3.9236111640930176, "mode": "test", "epoch": 33}
{"loss": 0.2651761770248413, "acc": 0.8914527297019958, "length": 3.931553840637207, "mode": "train", "epoch": 34}
{"loss": 0.2688835859298706, "acc": 0.891265332698822, "length": 3.9236111640930176, "mode": "test", "epoch": 34}
{"loss": 0.23968295753002167, "acc": 0.9056665301322937, "length": 3.8966641426086426, "mode": "train", "epoch": 35}
{"loss": 0.25055769085884094, "acc": 0.9016058444976807, "length": 3.9114582538604736, "mode": "test", "epoch": 35}
{"loss": 0.22420501708984375, "acc": 0.914223849773407, "length": 3.8957715034484863, "mode": "train", "epoch": 36}
{"loss": 0.2350371927022934, "acc": 0.9081867933273315, "length": 3.887152671813965, "mode": "test", "epoch": 36}
{"loss": 0.211173877120018, "acc": 0.9203740358352661, "length": 3.8907577991485596, "mode": "train", "epoch": 37}
{"loss": 0.23070430755615234, "acc": 0.9164740443229675, "length": 3.8697917461395264, "mode": "test", "epoch": 37}
{"loss": 0.20383557677268982, "acc": 0.92332524061203, "length": 3.893277883529663, "mode": "train", "epoch": 38}
{"loss": 0.23160678148269653, "acc": 0.914813756942749, "length": 3.899305582046509, "mode": "test", "epoch": 38}
{"loss": 0.21014992892742157, "acc": 0.9199924468994141, "length": 3.9054484367370605, "mode": "train", "epoch": 39}
{"loss": 0.22539380192756653, "acc": 0.912410318851471, "length": 3.930555582046509, "mode": "test", "epoch": 39}
{"loss": 0.2085195928812027, "acc": 0.9197047352790833, "length": 3.914649248123169, "mode": "train", "epoch": 40}
{"loss": 0.23328383266925812, "acc": 0.9159696102142334, "length": 3.930555582046509, "mode": "test", "epoch": 40}
{"loss": 0.20306438207626343, "acc": 0.9241658449172974, "length": 3.9167640209198, "mode": "train", "epoch": 41}
{"loss": 0.22416110336780548, "acc": 0.9209011793136597, "length": 3.918402671813965, "mode": "test", "epoch": 41}
{"loss": 0.19722552597522736, "acc": 0.9252544045448303, "length": 3.9149529933929443, "mode": "train", "epoch": 42}
{"loss": 0.21799255907535553, "acc": 0.9206027984619141, "length": 3.9357638359069824, "mode": "test", "epoch": 42}
{"loss": 0.19963952898979187, "acc": 0.924946129322052, "length": 3.9077436923980713, "mode": "train", "epoch": 43}
{"loss": 0.2222076654434204, "acc": 0.9165202379226685, "length": 3.909722328186035, "mode": "test", "epoch": 43}
{"loss": 0.19663690030574799, "acc": 0.927315890789032, "length": 3.91259765625, "mode": "train", "epoch": 44}
{"loss": 0.22142986953258514, "acc": 0.9186362028121948, "length": 3.909722328186035, "mode": "test", "epoch": 44}
{"loss": 0.19373686611652374, "acc": 0.9274158477783203, "length": 3.9149632453918457, "mode": "train", "epoch": 45}
{"loss": 0.21989427506923676, "acc": 0.9181666970252991, "length": 3.9114582538604736, "mode": "test", "epoch": 45}
{"loss": 0.19551999866962433, "acc": 0.926838755607605, "length": 3.9164328575134277, "mode": "train", "epoch": 46}
{"loss": 0.21793608367443085, "acc": 0.9189751148223877, "length": 3.913194417953491, "mode": "test", "epoch": 46}
{"loss": 0.18727833032608032, "acc": 0.9311147928237915, "length": 3.9250288009643555, "mode": "train", "epoch": 47}
{"loss": 0.20606441795825958, "acc": 0.9226561784744263, "length": 3.9322917461395264, "mode": "test", "epoch": 47}
{"loss": 0.1854216605424881, "acc": 0.9311741590499878, "length": 3.9244883060455322, "mode": "train", "epoch": 48}
{"loss": 0.2085551768541336, "acc": 0.9231173992156982, "length": 3.9635417461395264, "mode": "test", "epoch": 48}
{"loss": 0.18711315095424652, "acc": 0.9309744238853455, "length": 3.930419445037842, "mode": "train", "epoch": 49}
{"loss": 0.2144453525543213, "acc": 0.921055793762207, "length": 3.925347328186035, "mode": "test", "epoch": 49}
{"loss": 0.19857873022556305, "acc": 0.9275428652763367, "length": 3.9573512077331543, "mode": "train", "epoch": 50}
{"loss": 0.22135567665100098, "acc": 0.9147597551345825, "length": 3.953125, "mode": "test", "epoch": 50}
{"loss": 0.19378022849559784, "acc": 0.9277516603469849, "length": 3.9486334323883057, "mode": "train", "epoch": 51}
{"loss": 0.21947380900382996, "acc": 0.917743444442749, "length": 3.987847328186035, "mode": "test", "epoch": 51}
{"loss": 0.1925390362739563, "acc": 0.9293250441551208, "length": 3.9634082317352295, "mode": "train", "epoch": 52}
{"loss": 0.21870703995227814, "acc": 0.9194662570953369, "length": 3.9322917461395264, "mode": "test", "epoch": 52}
{"loss": 0.18353237211704254, "acc": 0.9317113757133484, "length": 3.942298412322998, "mode": "train", "epoch": 53}
{"loss": 0.21898095309734344, "acc": 0.9204345345497131, "length": 3.940972328186035, "mode": "test", "epoch": 53}
{"loss": 0.1849040687084198, "acc": 0.9322043061256409, "length": 3.961939811706543, "mode": "train", "epoch": 54}
{"loss": 0.2272213101387024, "acc": 0.9174832105636597, "length": 3.961805582046509, "mode": "test", "epoch": 54}
{"loss": 0.18771368265151978, "acc": 0.9296885132789612, "length": 3.961764097213745, "mode": "train", "epoch": 55}
{"loss": 0.22113829851150513, "acc": 0.9234157204627991, "length": 3.961805582046509, "mode": "test", "epoch": 55}
{"loss": 0.182347372174263, "acc": 0.9321874976158142, "length": 3.9596147537231445, "mode": "train", "epoch": 56}
{"loss": 0.22091354429721832, "acc": 0.9194309711456299, "length": 3.9670138359069824, "mode": "test", "epoch": 56}
{"loss": 0.18378835916519165, "acc": 0.9317754507064819, "length": 3.9617786407470703, "mode": "train", "epoch": 57}
{"loss": 0.22813275456428528, "acc": 0.9170545935630798, "length": 3.956597328186035, "mode": "test", "epoch": 57}
{"loss": 0.20816180109977722, "acc": 0.9222782254219055, "length": 3.9608571529388428, "mode": "train", "epoch": 58}
{"loss": 0.22894103825092316, "acc": 0.9188477396965027, "length": 3.960069417953491, "mode": "test", "epoch": 58}
{"loss": 0.19549457728862762, "acc": 0.9290357232093811, "length": 3.958573818206787, "mode": "train", "epoch": 59}
{"loss": 0.2234737128019333, "acc": 0.9198622107505798, "length": 3.96875, "mode": "test", "epoch": 59}
{"loss": 0.19950999319553375, "acc": 0.9274792671203613, "length": 3.958594799041748, "mode": "train", "epoch": 60}
{"loss": 0.2097957283258438, "acc": 0.9240531921386719, "length": 3.949652671813965, "mode": "test", "epoch": 60}
test accuracy: 0.8777231574058533
