# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6947928667068481, "acc": 0.5043092966079712, "length": 3.5265536308288574, "mode": "train", "epoch": 1}
{"loss": 0.6943380236625671, "acc": 0.5003905892372131, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6925163865089417, "acc": 0.5203824043273926, "length": 3.1970560550689697, "mode": "train", "epoch": 2}
{"loss": 0.6893933415412903, "acc": 0.5503059029579163, "length": 1.97265625, "mode": "test", "epoch": 2}
{"loss": 0.6798970103263855, "acc": 0.589923083782196, "length": 3.5142948627471924, "mode": "train", "epoch": 3}
{"loss": 0.650926411151886, "acc": 0.6806641221046448, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.6173322796821594, "acc": 0.673726499080658, "length": 3.963759183883667, "mode": "train", "epoch": 4}
{"loss": 0.5820327401161194, "acc": 0.6836913824081421, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.5767730474472046, "acc": 0.6925824880599976, "length": 3.9895718097686768, "mode": "train", "epoch": 5}
{"loss": 0.5583198070526123, "acc": 0.69775390625, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.5464207530021667, "acc": 0.722718358039856, "length": 3.993987560272217, "mode": "train", "epoch": 6}
{"loss": 0.5382822155952454, "acc": 0.7385743856430054, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.5163465142250061, "acc": 0.7542949914932251, "length": 3.996239423751831, "mode": "train", "epoch": 7}
{"loss": 0.5263975858688354, "acc": 0.7594726085662842, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.5003967881202698, "acc": 0.7666625380516052, "length": 3.995851993560791, "mode": "train", "epoch": 8}
{"loss": 0.5034728646278381, "acc": 0.7736326456069946, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.48547956347465515, "acc": 0.7747159600257874, "length": 3.993584632873535, "mode": "train", "epoch": 9}
{"loss": 0.49245303869247437, "acc": 0.7761720418930054, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.4623388648033142, "acc": 0.7768081426620483, "length": 3.9928932189941406, "mode": "train", "epoch": 10}
{"loss": 0.47606050968170166, "acc": 0.7768554091453552, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.4509168863296509, "acc": 0.7915914058685303, "length": 3.9962821006774902, "mode": "train", "epoch": 11}
{"loss": 0.46110501885414124, "acc": 0.7923827767372131, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.4326176643371582, "acc": 0.8065086603164673, "length": 3.9974656105041504, "mode": "train", "epoch": 12}
{"loss": 0.4450869858264923, "acc": 0.7938475608825684, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.41324275732040405, "acc": 0.8144996166229248, "length": 3.9985744953155518, "mode": "train", "epoch": 13}
{"loss": 0.41868165135383606, "acc": 0.8077149391174316, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.4034353494644165, "acc": 0.8210639357566833, "length": 3.999044418334961, "mode": "train", "epoch": 14}
{"loss": 0.4059719145298004, "acc": 0.8269529938697815, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3916195034980774, "acc": 0.8287782073020935, "length": 3.9993371963500977, "mode": "train", "epoch": 15}
{"loss": 0.3928568959236145, "acc": 0.83203125, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.38569435477256775, "acc": 0.8327814936637878, "length": 3.9991652965545654, "mode": "train", "epoch": 16}
{"loss": 0.38963595032691956, "acc": 0.8348631858825684, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.37341102957725525, "acc": 0.8383798003196716, "length": 3.9991538524627686, "mode": "train", "epoch": 17}
{"loss": 0.379433274269104, "acc": 0.8353514075279236, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.36052432656288147, "acc": 0.8425934910774231, "length": 3.9980056285858154, "mode": "train", "epoch": 18}
{"loss": 0.36636975407600403, "acc": 0.8478516340255737, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.35501277446746826, "acc": 0.8489718437194824, "length": 3.9987308979034424, "mode": "train", "epoch": 19}
{"loss": 0.3641875982284546, "acc": 0.8441405892372131, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.34688785672187805, "acc": 0.8515000343322754, "length": 3.9989941120147705, "mode": "train", "epoch": 20}
{"loss": 0.34737101197242737, "acc": 0.8580078482627869, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.3455973267555237, "acc": 0.8557557463645935, "length": 3.9994266033172607, "mode": "train", "epoch": 21}
{"loss": 0.34919339418411255, "acc": 0.8546875715255737, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.3314894735813141, "acc": 0.8594889640808105, "length": 3.9995274543762207, "mode": "train", "epoch": 22}
{"loss": 0.34911414980888367, "acc": 0.8524413704872131, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.32638072967529297, "acc": 0.8629071116447449, "length": 3.9992237091064453, "mode": "train", "epoch": 23}
{"loss": 0.3306838870048523, "acc": 0.8625000715255737, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.31736475229263306, "acc": 0.8661303520202637, "length": 3.999450445175171, "mode": "train", "epoch": 24}
{"loss": 0.33201929926872253, "acc": 0.8648437857627869, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.3158690333366394, "acc": 0.8695314526557922, "length": 3.9996211528778076, "mode": "train", "epoch": 25}
{"loss": 0.3348335325717926, "acc": 0.8604492545127869, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.31138575077056885, "acc": 0.8721616864204407, "length": 3.999467134475708, "mode": "train", "epoch": 26}
{"loss": 0.323486864566803, "acc": 0.8737305402755737, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.309662401676178, "acc": 0.8739818334579468, "length": 3.999821424484253, "mode": "train", "epoch": 27}
{"loss": 0.32971641421318054, "acc": 0.8681640028953552, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.314815491437912, "acc": 0.8727484941482544, "length": 3.9999258518218994, "mode": "train", "epoch": 28}
{"loss": 0.3212088346481323, "acc": 0.872167706489563, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.30667993426322937, "acc": 0.8727728724479675, "length": 3.9998011589050293, "mode": "train", "epoch": 29}
{"loss": 0.31343144178390503, "acc": 0.8731445670127869, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.29828986525535583, "acc": 0.8769434690475464, "length": 3.999574661254883, "mode": "train", "epoch": 30}
{"loss": 0.3117302656173706, "acc": 0.8759765028953552, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.29396817088127136, "acc": 0.8811177015304565, "length": 3.9998764991760254, "mode": "train", "epoch": 31}
{"loss": 0.30397936701774597, "acc": 0.8827148079872131, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.2896007001399994, "acc": 0.8821610808372498, "length": 3.9999263286590576, "mode": "train", "epoch": 32}
{"loss": 0.3059033155441284, "acc": 0.8808593153953552, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.2958262860774994, "acc": 0.8837500810623169, "length": 3.9998116493225098, "mode": "train", "epoch": 33}
{"loss": 0.3072708547115326, "acc": 0.8798828721046448, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.2878667116165161, "acc": 0.8831149935722351, "length": 3.9996254444122314, "mode": "train", "epoch": 34}
{"loss": 0.30058082938194275, "acc": 0.8820310831069946, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.2893347442150116, "acc": 0.8841370344161987, "length": 3.999925136566162, "mode": "train", "epoch": 35}
{"loss": 0.2982103228569031, "acc": 0.8830079436302185, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.287018746137619, "acc": 0.8836164474487305, "length": 3.9999828338623047, "mode": "train", "epoch": 36}
{"loss": 0.30181050300598145, "acc": 0.8849611282348633, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.2855106294155121, "acc": 0.8878390789031982, "length": 3.999842405319214, "mode": "train", "epoch": 37}
{"loss": 0.2916530668735504, "acc": 0.8875975012779236, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.29256072640419006, "acc": 0.8855608701705933, "length": 3.99967098236084, "mode": "train", "epoch": 38}
{"loss": 0.3095725178718567, "acc": 0.8811522722244263, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.27980121970176697, "acc": 0.8877599239349365, "length": 3.9999732971191406, "mode": "train", "epoch": 39}
{"loss": 0.29117971658706665, "acc": 0.8878904581069946, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.2803944945335388, "acc": 0.8915721774101257, "length": 3.999896764755249, "mode": "train", "epoch": 40}
{"loss": 0.29251450300216675, "acc": 0.8869141936302185, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.2804684340953827, "acc": 0.8906119465827942, "length": 3.9998857975006104, "mode": "train", "epoch": 41}
{"loss": 0.29382601380348206, "acc": 0.8880859017372131, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.2756064236164093, "acc": 0.8943187594413757, "length": 3.9999711513519287, "mode": "train", "epoch": 42}
{"loss": 0.2908203601837158, "acc": 0.8915037512779236, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.27293911576271057, "acc": 0.8939069509506226, "length": 3.999971628189087, "mode": "train", "epoch": 43}
{"loss": 0.28422796726226807, "acc": 0.8930664658546448, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.27289989590644836, "acc": 0.8959100246429443, "length": 3.9999728202819824, "mode": "train", "epoch": 44}
{"loss": 0.2822650372982025, "acc": 0.8909178972244263, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.27291935682296753, "acc": 0.8955539464950562, "length": 3.9999935626983643, "mode": "train", "epoch": 45}
{"loss": 0.28561878204345703, "acc": 0.8934569954872131, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.26534104347229004, "acc": 0.8982657194137573, "length": 3.99988055229187, "mode": "train", "epoch": 46}
{"loss": 0.27990201115608215, "acc": 0.8960937857627869, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.2681240439414978, "acc": 0.8983182907104492, "length": 3.998988628387451, "mode": "train", "epoch": 47}
{"loss": 0.2821894586086273, "acc": 0.896581768989563, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.27308011054992676, "acc": 0.8990504741668701, "length": 3.9996514320373535, "mode": "train", "epoch": 48}
{"loss": 0.29382845759391785, "acc": 0.8903321027755737, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.2668689489364624, "acc": 0.8981883525848389, "length": 3.9999866485595703, "mode": "train", "epoch": 49}
{"loss": 0.28623872995376587, "acc": 0.8953124284744263, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.26809442043304443, "acc": 0.896130383014679, "length": 3.999995231628418, "mode": "train", "epoch": 50}
{"loss": 0.29869547486305237, "acc": 0.8889647722244263, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.26400336623191833, "acc": 0.9007066488265991, "length": 3.999699592590332, "mode": "train", "epoch": 51}
{"loss": 0.30728596448898315, "acc": 0.8916015028953552, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.2767093777656555, "acc": 0.8987374901771545, "length": 3.999992847442627, "mode": "train", "epoch": 52}
{"loss": 0.2892419695854187, "acc": 0.8919922113418579, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.29464906454086304, "acc": 0.8912183046340942, "length": 3.99999737739563, "mode": "train", "epoch": 53}
{"loss": 0.3094196915626526, "acc": 0.8746094703674316, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.2853541076183319, "acc": 0.8884741067886353, "length": 3.9999969005584717, "mode": "train", "epoch": 54}
{"loss": 0.2826639413833618, "acc": 0.8950195908546448, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.26568087935447693, "acc": 0.8990007042884827, "length": 3.9998276233673096, "mode": "train", "epoch": 55}
{"loss": 0.28638631105422974, "acc": 0.8939452767372131, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.2661122977733612, "acc": 0.8989807367324829, "length": 3.999912738800049, "mode": "train", "epoch": 56}
{"loss": 0.2952471673488617, "acc": 0.8898438811302185, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.27188098430633545, "acc": 0.8956894278526306, "length": 3.9999608993530273, "mode": "train", "epoch": 57}
{"loss": 0.29467591643333435, "acc": 0.8907226920127869, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.26910361647605896, "acc": 0.8984906077384949, "length": 3.999999761581421, "mode": "train", "epoch": 58}
{"loss": 0.28685837984085083, "acc": 0.8932618498802185, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.2637917399406433, "acc": 0.9025521874427795, "length": 3.999999523162842, "mode": "train", "epoch": 59}
{"loss": 0.28206196427345276, "acc": 0.896581768989563, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.26037341356277466, "acc": 0.9035108685493469, "length": 3.9999442100524902, "mode": "train", "epoch": 60}
{"loss": 0.2839389443397522, "acc": 0.8948241472244263, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8247367143630981
