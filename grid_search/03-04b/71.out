# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--hidden_size=256", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7048951983451843, "acc": 0.5019298195838928, "length": 3.2226340770721436, "mode": "train", "epoch": 1}
{"loss": 0.6944467425346375, "acc": 0.5, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6942756772041321, "acc": 0.5050470232963562, "length": 1.119503140449524, "mode": "train", "epoch": 2}
{"loss": 0.6919851303100586, "acc": 0.5137695670127869, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.692747950553894, "acc": 0.5109854936599731, "length": 1.0352238416671753, "mode": "train", "epoch": 3}
{"loss": 0.6927622556686401, "acc": 0.5152344107627869, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6868749260902405, "acc": 0.5528643727302551, "length": 1.5265605449676514, "mode": "train", "epoch": 4}
{"loss": 0.6651105880737305, "acc": 0.6229950189590454, "length": 2.8515625, "mode": "test", "epoch": 4}
{"loss": 0.6279727220535278, "acc": 0.6454451084136963, "length": 2.7991743087768555, "mode": "train", "epoch": 5}
{"loss": 0.629216194152832, "acc": 0.6703505516052246, "length": 2.751953125, "mode": "test", "epoch": 5}
{"loss": 0.6006528735160828, "acc": 0.677972137928009, "length": 2.7381887435913086, "mode": "train", "epoch": 6}
{"loss": 0.603937029838562, "acc": 0.6859710216522217, "length": 2.8828125, "mode": "test", "epoch": 6}
{"loss": 0.5837844014167786, "acc": 0.6839398145675659, "length": 2.8089044094085693, "mode": "train", "epoch": 7}
{"loss": 0.6069075465202332, "acc": 0.6898788213729858, "length": 2.86328125, "mode": "test", "epoch": 7}
{"loss": 0.5708453059196472, "acc": 0.6919037699699402, "length": 2.881382942199707, "mode": "train", "epoch": 8}
{"loss": 0.5967457294464111, "acc": 0.6822434663772583, "length": 3.068359375, "mode": "test", "epoch": 8}
{"loss": 0.5426291823387146, "acc": 0.728752851486206, "length": 3.186544895172119, "mode": "train", "epoch": 9}
{"loss": 0.5595614314079285, "acc": 0.7302436828613281, "length": 3.291015625, "mode": "test", "epoch": 9}
{"loss": 0.5208287239074707, "acc": 0.750403642654419, "length": 3.317164659500122, "mode": "train", "epoch": 10}
{"loss": 0.552198052406311, "acc": 0.709119439125061, "length": 3.337890625, "mode": "test", "epoch": 10}
{"loss": 0.5030408501625061, "acc": 0.7617409825325012, "length": 3.4203131198883057, "mode": "train", "epoch": 11}
{"loss": 0.5437116026878357, "acc": 0.7065163254737854, "length": 3.267578125, "mode": "test", "epoch": 11}
{"loss": 0.4814136028289795, "acc": 0.7681363821029663, "length": 3.531574010848999, "mode": "train", "epoch": 12}
{"loss": 0.5238332748413086, "acc": 0.7549012303352356, "length": 3.701171875, "mode": "test", "epoch": 12}
{"loss": 0.4717390537261963, "acc": 0.785988450050354, "length": 3.70349383354187, "mode": "train", "epoch": 13}
{"loss": 0.5303834676742554, "acc": 0.7581405639648438, "length": 3.7890625, "mode": "test", "epoch": 13}
{"loss": 0.45172417163848877, "acc": 0.7938243746757507, "length": 3.7399401664733887, "mode": "train", "epoch": 14}
{"loss": 0.4624726474285126, "acc": 0.7962236404418945, "length": 3.853515625, "mode": "test", "epoch": 14}
{"loss": 0.4368065297603607, "acc": 0.8044486045837402, "length": 3.8248825073242188, "mode": "train", "epoch": 15}
{"loss": 0.4443609416484833, "acc": 0.8032227158546448, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.40881621837615967, "acc": 0.8083586096763611, "length": 3.9497792720794678, "mode": "train", "epoch": 16}
{"loss": 0.43368878960609436, "acc": 0.7867187857627869, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.39111337065696716, "acc": 0.8160884976387024, "length": 3.993396282196045, "mode": "train", "epoch": 17}
{"loss": 0.4236529469490051, "acc": 0.80712890625, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.3917701840400696, "acc": 0.8214238286018372, "length": 3.9975593090057373, "mode": "train", "epoch": 18}
{"loss": 0.42347121238708496, "acc": 0.7835936546325684, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.38792502880096436, "acc": 0.8175551295280457, "length": 3.9977545738220215, "mode": "train", "epoch": 19}
{"loss": 0.41980287432670593, "acc": 0.8048826456069946, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.37627077102661133, "acc": 0.8235348463058472, "length": 3.9980571269989014, "mode": "train", "epoch": 20}
{"loss": 0.41072219610214233, "acc": 0.8113279938697815, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.374011754989624, "acc": 0.8251709342002869, "length": 3.998420238494873, "mode": "train", "epoch": 21}
{"loss": 0.41310617327690125, "acc": 0.7973631620407104, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.36966729164123535, "acc": 0.8257865309715271, "length": 3.9986073970794678, "mode": "train", "epoch": 22}
{"loss": 0.4358628988265991, "acc": 0.7811523675918579, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.37468382716178894, "acc": 0.826450765132904, "length": 3.998718738555908, "mode": "train", "epoch": 23}
{"loss": 0.40692809224128723, "acc": 0.806543231010437, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.36577776074409485, "acc": 0.8287120461463928, "length": 3.998544454574585, "mode": "train", "epoch": 24}
{"loss": 0.40411871671676636, "acc": 0.8104491233825684, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.36293670535087585, "acc": 0.830906331539154, "length": 3.998913526535034, "mode": "train", "epoch": 25}
{"loss": 0.4143927991390228, "acc": 0.8033203482627869, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.358142614364624, "acc": 0.8336991667747498, "length": 3.99897837638855, "mode": "train", "epoch": 26}
{"loss": 0.40229612588882446, "acc": 0.8141599893569946, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.35035383701324463, "acc": 0.8329552412033081, "length": 3.999067783355713, "mode": "train", "epoch": 27}
{"loss": 0.40193477272987366, "acc": 0.8125, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.34376806020736694, "acc": 0.8362022042274475, "length": 3.999354839324951, "mode": "train", "epoch": 28}
{"loss": 0.392412930727005, "acc": 0.8139649033546448, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.3332233428955078, "acc": 0.842983603477478, "length": 3.9994747638702393, "mode": "train", "epoch": 29}
{"loss": 0.38233983516693115, "acc": 0.8124999403953552, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.33006149530410767, "acc": 0.850595235824585, "length": 3.9995169639587402, "mode": "train", "epoch": 30}
{"loss": 0.36670708656311035, "acc": 0.8338866829872131, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.31430715322494507, "acc": 0.8588123917579651, "length": 3.9995622634887695, "mode": "train", "epoch": 31}
{"loss": 0.3794546127319336, "acc": 0.8070312738418579, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.3121179938316345, "acc": 0.8561580777168274, "length": 3.999598264694214, "mode": "train", "epoch": 32}
{"loss": 0.3713054656982422, "acc": 0.8237305283546448, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.3118952512741089, "acc": 0.8618286848068237, "length": 3.9996085166931152, "mode": "train", "epoch": 33}
{"loss": 0.3621562719345093, "acc": 0.8348631858825684, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.3098241090774536, "acc": 0.8604193925857544, "length": 3.9996232986450195, "mode": "train", "epoch": 34}
{"loss": 0.35266822576522827, "acc": 0.8409180045127869, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.30182820558547974, "acc": 0.8670589327812195, "length": 3.9996330738067627, "mode": "train", "epoch": 35}
{"loss": 0.34159600734710693, "acc": 0.8463865518569946, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.2934601604938507, "acc": 0.8691897988319397, "length": 3.999626398086548, "mode": "train", "epoch": 36}
{"loss": 0.3341885805130005, "acc": 0.8508788347244263, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.2946050465106964, "acc": 0.8722038269042969, "length": 3.9995994567871094, "mode": "train", "epoch": 37}
{"loss": 0.3377887010574341, "acc": 0.8541990518569946, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.292968213558197, "acc": 0.8708479404449463, "length": 3.9995529651641846, "mode": "train", "epoch": 38}
{"loss": 0.3406146466732025, "acc": 0.8545898199081421, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.28115883469581604, "acc": 0.8761376738548279, "length": 3.999704360961914, "mode": "train", "epoch": 39}
{"loss": 0.33297646045684814, "acc": 0.8563475608825684, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.2854044735431671, "acc": 0.8787941336631775, "length": 3.9997100830078125, "mode": "train", "epoch": 40}
{"loss": 0.3351922035217285, "acc": 0.8580078482627869, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.2879224419593811, "acc": 0.8764734268188477, "length": 3.999790906906128, "mode": "train", "epoch": 41}
{"loss": 0.32561442255973816, "acc": 0.8531250357627869, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.2765931487083435, "acc": 0.8824238181114197, "length": 3.9998416900634766, "mode": "train", "epoch": 42}
{"loss": 0.3225991725921631, "acc": 0.8644529581069946, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.27497848868370056, "acc": 0.8833073973655701, "length": 3.9998042583465576, "mode": "train", "epoch": 43}
{"loss": 0.3266034722328186, "acc": 0.8605469465255737, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.2790006101131439, "acc": 0.8820031881332397, "length": 3.9996390342712402, "mode": "train", "epoch": 44}
{"loss": 0.3236827254295349, "acc": 0.8677734732627869, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.27938294410705566, "acc": 0.8829441070556641, "length": 3.9997034072875977, "mode": "train", "epoch": 45}
{"loss": 0.3199099004268646, "acc": 0.8708008527755737, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.2727015018463135, "acc": 0.8863542079925537, "length": 3.9998764991760254, "mode": "train", "epoch": 46}
{"loss": 0.3121514916419983, "acc": 0.87158203125, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.2718498110771179, "acc": 0.8852755427360535, "length": 3.9998958110809326, "mode": "train", "epoch": 47}
{"loss": 0.322822242975235, "acc": 0.86328125, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.27408066391944885, "acc": 0.8828378319740295, "length": 3.999734401702881, "mode": "train", "epoch": 48}
{"loss": 0.30759263038635254, "acc": 0.8725585341453552, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.27072930335998535, "acc": 0.889258623123169, "length": 3.9998555183410645, "mode": "train", "epoch": 49}
{"loss": 0.3129507601261139, "acc": 0.8727540373802185, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.25623688101768494, "acc": 0.8921335339546204, "length": 3.999802827835083, "mode": "train", "epoch": 50}
{"loss": 0.31570181250572205, "acc": 0.8713865876197815, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.25446993112564087, "acc": 0.891471266746521, "length": 3.9998486042022705, "mode": "train", "epoch": 51}
{"loss": 0.30875363945961, "acc": 0.8779296278953552, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.25061365962028503, "acc": 0.8938248157501221, "length": 3.9998908042907715, "mode": "train", "epoch": 52}
{"loss": 0.310392290353775, "acc": 0.8738282918930054, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.2416575849056244, "acc": 0.893632173538208, "length": 3.999918222427368, "mode": "train", "epoch": 53}
{"loss": 0.3032042384147644, "acc": 0.8730468153953552, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.2454419881105423, "acc": 0.8948478102684021, "length": 3.9998791217803955, "mode": "train", "epoch": 54}
{"loss": 0.3016032874584198, "acc": 0.8776368498802185, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.24422289431095123, "acc": 0.8941859006881714, "length": 3.9999215602874756, "mode": "train", "epoch": 55}
{"loss": 0.3291143476963043, "acc": 0.8714843392372131, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.25179776549339294, "acc": 0.8977248668670654, "length": 3.999880075454712, "mode": "train", "epoch": 56}
{"loss": 0.3179258406162262, "acc": 0.8773437738418579, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.23958924412727356, "acc": 0.8973950743675232, "length": 3.999915361404419, "mode": "train", "epoch": 57}
{"loss": 0.29413658380508423, "acc": 0.8805664777755737, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.24061472713947296, "acc": 0.9000244736671448, "length": 3.999933958053589, "mode": "train", "epoch": 58}
{"loss": 0.3036215901374817, "acc": 0.8824219703674316, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.2416973114013672, "acc": 0.8991113305091858, "length": 3.9999406337738037, "mode": "train", "epoch": 59}
{"loss": 0.29512831568717957, "acc": 0.8834961652755737, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.23296691477298737, "acc": 0.8988350033760071, "length": 3.9999420642852783, "mode": "train", "epoch": 60}
{"loss": 0.30502086877822876, "acc": 0.8816405534744263, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8266100883483887
