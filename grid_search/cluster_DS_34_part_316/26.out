# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.0005", "--hidden_size=128", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6932065486907959, "acc": 0.5144078135490417, "length": 3.617962598800659, "mode": "train", "epoch": 1}
{"loss": 0.6927770376205444, "acc": 0.522060751914978, "length": 3.7916667461395264, "mode": "test", "epoch": 1}
{"loss": 0.6892543435096741, "acc": 0.5354090332984924, "length": 3.523287057876587, "mode": "train", "epoch": 2}
{"loss": 0.6750072240829468, "acc": 0.5953992605209351, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.6463049650192261, "acc": 0.6253551244735718, "length": 3.8484160900115967, "mode": "train", "epoch": 3}
{"loss": 0.6192657351493835, "acc": 0.639843761920929, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.5928018093109131, "acc": 0.6497066020965576, "length": 3.9635496139526367, "mode": "train", "epoch": 4}
{"loss": 0.5889524221420288, "acc": 0.6586804389953613, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.5710045099258423, "acc": 0.6616002917289734, "length": 3.9563210010528564, "mode": "train", "epoch": 5}
{"loss": 0.5991060137748718, "acc": 0.6908853650093079, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.5351778268814087, "acc": 0.7194247245788574, "length": 3.968679428100586, "mode": "train", "epoch": 6}
{"loss": 0.5479503273963928, "acc": 0.7576388120651245, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.49079567193984985, "acc": 0.7604295611381531, "length": 3.980681896209717, "mode": "train", "epoch": 7}
{"loss": 0.522968590259552, "acc": 0.7494791150093079, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.472825825214386, "acc": 0.7801334261894226, "length": 3.9857802391052246, "mode": "train", "epoch": 8}
{"loss": 0.5262326002120972, "acc": 0.7178819179534912, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.4607571065425873, "acc": 0.7898812890052795, "length": 3.988842248916626, "mode": "train", "epoch": 9}
{"loss": 0.5289828777313232, "acc": 0.7212673425674438, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.4433041512966156, "acc": 0.8049749732017517, "length": 3.989694356918335, "mode": "train", "epoch": 10}
{"loss": 0.5010852217674255, "acc": 0.7567707896232605, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.42439764738082886, "acc": 0.8143185973167419, "length": 3.9902172088623047, "mode": "train", "epoch": 11}
{"loss": 0.49088647961616516, "acc": 0.7551214694976807, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.40954408049583435, "acc": 0.8228910565376282, "length": 3.9933249950408936, "mode": "train", "epoch": 12}
{"loss": 0.4520404636859894, "acc": 0.7984374165534973, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.3916565477848053, "acc": 0.8310827612876892, "length": 3.9950785636901855, "mode": "train", "epoch": 13}
{"loss": 0.4282648265361786, "acc": 0.8118056058883667, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3809969127178192, "acc": 0.8345087170600891, "length": 3.995748281478882, "mode": "train", "epoch": 14}
{"loss": 0.41249415278434753, "acc": 0.8223958015441895, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3742283582687378, "acc": 0.8369282484054565, "length": 3.9970340728759766, "mode": "train", "epoch": 15}
{"loss": 0.4122634530067444, "acc": 0.8244791030883789, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.36677029728889465, "acc": 0.8406016230583191, "length": 3.997467279434204, "mode": "train", "epoch": 16}
{"loss": 0.40062594413757324, "acc": 0.8296873569488525, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.35792097449302673, "acc": 0.8433215618133545, "length": 3.9972665309906006, "mode": "train", "epoch": 17}
{"loss": 0.38593441247940063, "acc": 0.8368921279907227, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.35264238715171814, "acc": 0.8462749719619751, "length": 3.998460531234741, "mode": "train", "epoch": 18}
{"loss": 0.3835051357746124, "acc": 0.8399305939674377, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.3456956446170807, "acc": 0.8489649295806885, "length": 3.9983184337615967, "mode": "train", "epoch": 19}
{"loss": 0.3729237914085388, "acc": 0.839583158493042, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.3407224416732788, "acc": 0.8529424071311951, "length": 3.9983463287353516, "mode": "train", "epoch": 20}
{"loss": 0.36308780312538147, "acc": 0.8434028029441833, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.33666059374809265, "acc": 0.8513813018798828, "length": 3.9984424114227295, "mode": "train", "epoch": 21}
{"loss": 0.3642066419124603, "acc": 0.8440971970558167, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.3352336287498474, "acc": 0.8552137017250061, "length": 3.998624324798584, "mode": "train", "epoch": 22}
{"loss": 0.3517375588417053, "acc": 0.8473091125488281, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.32632631063461304, "acc": 0.8581551313400269, "length": 3.997846841812134, "mode": "train", "epoch": 23}
{"loss": 0.35142406821250916, "acc": 0.846875011920929, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.3267805278301239, "acc": 0.8597308397293091, "length": 3.9985873699188232, "mode": "train", "epoch": 24}
{"loss": 0.35682788491249084, "acc": 0.8473090529441833, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.32255324721336365, "acc": 0.8606655597686768, "length": 3.998426675796509, "mode": "train", "epoch": 25}
{"loss": 0.3572811782360077, "acc": 0.8469618558883667, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.3177592158317566, "acc": 0.8629893660545349, "length": 3.999391794204712, "mode": "train", "epoch": 26}
{"loss": 0.3478213846683502, "acc": 0.8486979603767395, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.31622159481048584, "acc": 0.8626286387443542, "length": 3.99936580657959, "mode": "train", "epoch": 27}
{"loss": 0.3546045124530792, "acc": 0.8504340648651123, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.31496280431747437, "acc": 0.8637821078300476, "length": 3.999542713165283, "mode": "train", "epoch": 28}
{"loss": 0.3396949768066406, "acc": 0.854600727558136, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.312340646982193, "acc": 0.8654394745826721, "length": 3.9998021125793457, "mode": "train", "epoch": 29}
{"loss": 0.3476428687572479, "acc": 0.8527777791023254, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.3072338104248047, "acc": 0.8673986196517944, "length": 3.9997427463531494, "mode": "train", "epoch": 30}
{"loss": 0.33769333362579346, "acc": 0.8567708134651184, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.31169694662094116, "acc": 0.8638122081756592, "length": 3.999756097793579, "mode": "train", "epoch": 31}
{"loss": 0.33495163917541504, "acc": 0.8572049140930176, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.3057314157485962, "acc": 0.8674019575119019, "length": 3.999760866165161, "mode": "train", "epoch": 32}
{"loss": 0.33419737219810486, "acc": 0.8556424975395203, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.3019634187221527, "acc": 0.8703135848045349, "length": 3.999627113342285, "mode": "train", "epoch": 33}
{"loss": 0.3287802040576935, "acc": 0.8625868558883667, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.3001846671104431, "acc": 0.87028968334198, "length": 3.9994723796844482, "mode": "train", "epoch": 34}
{"loss": 0.33644232153892517, "acc": 0.8574652075767517, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.29704275727272034, "acc": 0.8728414177894592, "length": 3.9994020462036133, "mode": "train", "epoch": 35}
{"loss": 0.32808050513267517, "acc": 0.8618923425674438, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.2977379858493805, "acc": 0.870905876159668, "length": 3.9996042251586914, "mode": "train", "epoch": 36}
{"loss": 0.33020371198654175, "acc": 0.8597221970558167, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.2938261926174164, "acc": 0.8742989301681519, "length": 3.9999730587005615, "mode": "train", "epoch": 37}
{"loss": 0.32676517963409424, "acc": 0.8609374165534973, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.29639217257499695, "acc": 0.8721075654029846, "length": 3.99969220161438, "mode": "train", "epoch": 38}
{"loss": 0.3288162648677826, "acc": 0.8614583015441895, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.2903467118740082, "acc": 0.8760910630226135, "length": 3.999812602996826, "mode": "train", "epoch": 39}
{"loss": 0.32073017954826355, "acc": 0.8622395396232605, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.29027020931243896, "acc": 0.8775444626808167, "length": 3.9992313385009766, "mode": "train", "epoch": 40}
{"loss": 0.3257875144481659, "acc": 0.8626735210418701, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.292405366897583, "acc": 0.8752515316009521, "length": 3.9999747276306152, "mode": "train", "epoch": 41}
{"loss": 0.32624730467796326, "acc": 0.8628472685813904, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.292797327041626, "acc": 0.8749158382415771, "length": 3.999992847442627, "mode": "train", "epoch": 42}
{"loss": 0.3173772990703583, "acc": 0.8683158755302429, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.2910113036632538, "acc": 0.877465546131134, "length": 3.9996776580810547, "mode": "train", "epoch": 43}
{"loss": 0.32164639234542847, "acc": 0.8647570013999939, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.2868371903896332, "acc": 0.878166913986206, "length": 3.999993085861206, "mode": "train", "epoch": 44}
{"loss": 0.32155632972717285, "acc": 0.8671875, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.29229891300201416, "acc": 0.8767653703689575, "length": 3.999990940093994, "mode": "train", "epoch": 45}
{"loss": 0.34108641743659973, "acc": 0.8621528148651123, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.2971567213535309, "acc": 0.874354898929596, "length": 3.99998140335083, "mode": "train", "epoch": 46}
{"loss": 0.31538665294647217, "acc": 0.8705729246139526, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.29102739691734314, "acc": 0.878307044506073, "length": 3.9999871253967285, "mode": "train", "epoch": 47}
{"loss": 0.3271103501319885, "acc": 0.8639756441116333, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.2899852991104126, "acc": 0.8788087368011475, "length": 3.999809503555298, "mode": "train", "epoch": 48}
{"loss": 0.3216702938079834, "acc": 0.8638889789581299, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.2846098840236664, "acc": 0.8802684545516968, "length": 3.999980926513672, "mode": "train", "epoch": 49}
{"loss": 0.32318222522735596, "acc": 0.8692708611488342, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.2814060151576996, "acc": 0.8821183443069458, "length": 3.9999608993530273, "mode": "train", "epoch": 50}
{"loss": 0.3220584988594055, "acc": 0.867968738079071, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.2830502390861511, "acc": 0.8813895583152771, "length": 3.9999618530273438, "mode": "train", "epoch": 51}
{"loss": 0.3174992799758911, "acc": 0.8662326335906982, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.27955853939056396, "acc": 0.8829596042633057, "length": 3.9999945163726807, "mode": "train", "epoch": 52}
{"loss": 0.31251806020736694, "acc": 0.8703993558883667, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.2789735496044159, "acc": 0.8829873204231262, "length": 3.9999921321868896, "mode": "train", "epoch": 53}
{"loss": 0.3150845170021057, "acc": 0.8686632513999939, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.27478355169296265, "acc": 0.8843886256217957, "length": 3.9999263286590576, "mode": "train", "epoch": 54}
{"loss": 0.3164471983909607, "acc": 0.8710936903953552, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.2718672752380371, "acc": 0.8887019753456116, "length": 3.999929189682007, "mode": "train", "epoch": 55}
{"loss": 0.3130933940410614, "acc": 0.8721355199813843, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.2714228332042694, "acc": 0.8861242532730103, "length": 3.9999191761016846, "mode": "train", "epoch": 56}
{"loss": 0.3129020035266876, "acc": 0.8682289719581604, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.2712268531322479, "acc": 0.8871917128562927, "length": 3.999997854232788, "mode": "train", "epoch": 57}
{"loss": 0.31222450733184814, "acc": 0.8722221851348877, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.26962199807167053, "acc": 0.8880592584609985, "length": 3.999966621398926, "mode": "train", "epoch": 58}
{"loss": 0.3098938763141632, "acc": 0.8732638955116272, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.26517993211746216, "acc": 0.8912275433540344, "length": 3.9999942779541016, "mode": "train", "epoch": 59}
{"loss": 0.30928340554237366, "acc": 0.8737847805023193, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.26938584446907043, "acc": 0.8883967995643616, "length": 3.9999983310699463, "mode": "train", "epoch": 60}
{"loss": 0.3153360188007355, "acc": 0.8704860210418701, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8375807404518127
