# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6728460788726807, "acc": 0.5703901052474976, "length": 3.5676865577697754, "mode": "train", "epoch": 1}
{"loss": 0.621258020401001, "acc": 0.6647570133209229, "length": 4.0, "mode": "test", "epoch": 1}
{"loss": 0.5920585989952087, "acc": 0.6763674020767212, "length": 3.942781925201416, "mode": "train", "epoch": 2}
{"loss": 0.6503158807754517, "acc": 0.6377605199813843, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.5636312961578369, "acc": 0.7166640758514404, "length": 3.9813342094421387, "mode": "train", "epoch": 3}
{"loss": 0.6014214158058167, "acc": 0.6833333969116211, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.5521330833435059, "acc": 0.7291868925094604, "length": 3.9919538497924805, "mode": "train", "epoch": 4}
{"loss": 0.5802976489067078, "acc": 0.6811633110046387, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.5271232724189758, "acc": 0.7441974878311157, "length": 3.9950575828552246, "mode": "train", "epoch": 5}
{"loss": 0.5899146199226379, "acc": 0.6969617605209351, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.49152979254722595, "acc": 0.767583966255188, "length": 3.9969379901885986, "mode": "train", "epoch": 6}
{"loss": 0.5392824411392212, "acc": 0.7043402194976807, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.4623255729675293, "acc": 0.7901310920715332, "length": 3.997934103012085, "mode": "train", "epoch": 7}
{"loss": 0.5033945441246033, "acc": 0.7588542103767395, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.44011619687080383, "acc": 0.8001563549041748, "length": 3.9985034465789795, "mode": "train", "epoch": 8}
{"loss": 0.48554277420043945, "acc": 0.7658853530883789, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.4297682046890259, "acc": 0.8056902885437012, "length": 3.9984302520751953, "mode": "train", "epoch": 9}
{"loss": 0.4960908889770508, "acc": 0.7706596851348877, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.41167059540748596, "acc": 0.8167483806610107, "length": 3.9974169731140137, "mode": "train", "epoch": 10}
{"loss": 0.4556618332862854, "acc": 0.7754342555999756, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.39321595430374146, "acc": 0.8249732851982117, "length": 3.9974310398101807, "mode": "train", "epoch": 11}
{"loss": 0.430213063955307, "acc": 0.8066841959953308, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.36841127276420593, "acc": 0.8419811725616455, "length": 3.996471643447876, "mode": "train", "epoch": 12}
{"loss": 0.4254268705844879, "acc": 0.7960069179534912, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.35360604524612427, "acc": 0.8487236499786377, "length": 3.9978208541870117, "mode": "train", "epoch": 13}
{"loss": 0.3864227831363678, "acc": 0.831163227558136, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.33834317326545715, "acc": 0.8590840697288513, "length": 3.9984636306762695, "mode": "train", "epoch": 14}
{"loss": 0.3844842314720154, "acc": 0.8167534470558167, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3239921033382416, "acc": 0.8641085028648376, "length": 3.9987614154815674, "mode": "train", "epoch": 15}
{"loss": 0.36439889669418335, "acc": 0.8314235210418701, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.317183256149292, "acc": 0.867003858089447, "length": 3.9989490509033203, "mode": "train", "epoch": 16}
{"loss": 0.37471142411231995, "acc": 0.8270832896232605, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.31286513805389404, "acc": 0.8686663508415222, "length": 3.9991447925567627, "mode": "train", "epoch": 17}
{"loss": 0.3868331015110016, "acc": 0.8211805820465088, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.30277517437934875, "acc": 0.8750095367431641, "length": 3.9993205070495605, "mode": "train", "epoch": 18}
{"loss": 0.3416732847690582, "acc": 0.8409721851348877, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.288301944732666, "acc": 0.8822008967399597, "length": 3.999285936355591, "mode": "train", "epoch": 19}
{"loss": 0.33786478638648987, "acc": 0.8495661020278931, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.28415563702583313, "acc": 0.8852415084838867, "length": 3.9995875358581543, "mode": "train", "epoch": 20}
{"loss": 0.3287457525730133, "acc": 0.8657985925674438, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.28575366735458374, "acc": 0.88221275806427, "length": 3.9996848106384277, "mode": "train", "epoch": 21}
{"loss": 0.3291741907596588, "acc": 0.8643230199813843, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.27934783697128296, "acc": 0.8869785070419312, "length": 3.9996657371520996, "mode": "train", "epoch": 22}
{"loss": 0.3191835582256317, "acc": 0.8700520396232605, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.27038833498954773, "acc": 0.8926331996917725, "length": 3.9997410774230957, "mode": "train", "epoch": 23}
{"loss": 0.3093098998069763, "acc": 0.8744791150093079, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.2647978663444519, "acc": 0.8962423801422119, "length": 3.999739170074463, "mode": "train", "epoch": 24}
{"loss": 0.3187340795993805, "acc": 0.8714408874511719, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.2623271942138672, "acc": 0.8966299891471863, "length": 3.9997963905334473, "mode": "train", "epoch": 25}
{"loss": 0.3002674877643585, "acc": 0.8796006441116333, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.2629651129245758, "acc": 0.8962429165840149, "length": 3.9997594356536865, "mode": "train", "epoch": 26}
{"loss": 0.30199700593948364, "acc": 0.8828125, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.2553675174713135, "acc": 0.9009556174278259, "length": 3.9997267723083496, "mode": "train", "epoch": 27}
{"loss": 0.2942632734775543, "acc": 0.8873264789581299, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.2519168555736542, "acc": 0.9024184346199036, "length": 3.999772548675537, "mode": "train", "epoch": 28}
{"loss": 0.2986915707588196, "acc": 0.884982705116272, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.2446356862783432, "acc": 0.9053418636322021, "length": 3.999847650527954, "mode": "train", "epoch": 29}
{"loss": 0.2870628535747528, "acc": 0.8855903148651123, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.23836268484592438, "acc": 0.9076023101806641, "length": 3.9998483657836914, "mode": "train", "epoch": 30}
{"loss": 0.28288373351097107, "acc": 0.8897569179534912, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.23915250599384308, "acc": 0.9063889384269714, "length": 3.999816656112671, "mode": "train", "epoch": 31}
{"loss": 0.2843388617038727, "acc": 0.8897569179534912, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.2382902204990387, "acc": 0.9065281748771667, "length": 3.999854326248169, "mode": "train", "epoch": 32}
{"loss": 0.27450135350227356, "acc": 0.8941841125488281, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.23018451035022736, "acc": 0.9088150858879089, "length": 3.9998557567596436, "mode": "train", "epoch": 33}
{"loss": 0.28401979804039, "acc": 0.8921874165534973, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.24061089754104614, "acc": 0.9039925932884216, "length": 3.9998703002929688, "mode": "train", "epoch": 34}
{"loss": 0.30520084500312805, "acc": 0.8803820610046387, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.24657468497753143, "acc": 0.9003535509109497, "length": 3.999889850616455, "mode": "train", "epoch": 35}
{"loss": 0.2812618613243103, "acc": 0.8856770396232605, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.23099888861179352, "acc": 0.9082659482955933, "length": 3.9999032020568848, "mode": "train", "epoch": 36}
{"loss": 0.2793766260147095, "acc": 0.8876736164093018, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.22654201090335846, "acc": 0.9086787700653076, "length": 3.999889373779297, "mode": "train", "epoch": 37}
{"loss": 0.2616737484931946, "acc": 0.8966146111488342, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.2188142091035843, "acc": 0.9128137230873108, "length": 3.999912738800049, "mode": "train", "epoch": 38}
{"loss": 0.27016928791999817, "acc": 0.8876736164093018, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.22044658660888672, "acc": 0.9101962447166443, "length": 3.999941825866699, "mode": "train", "epoch": 39}
{"loss": 0.259737491607666, "acc": 0.8896700739860535, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.2169230729341507, "acc": 0.9120712876319885, "length": 3.99996018409729, "mode": "train", "epoch": 40}
{"loss": 0.26169008016586304, "acc": 0.8915796279907227, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.2127753645181656, "acc": 0.912787675857544, "length": 3.999960422515869, "mode": "train", "epoch": 41}
{"loss": 0.25601473450660706, "acc": 0.897048830986023, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.20599155128002167, "acc": 0.9173629283905029, "length": 3.999959945678711, "mode": "train", "epoch": 42}
{"loss": 0.25472474098205566, "acc": 0.890625, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.22824345529079437, "acc": 0.9100322127342224, "length": 3.9999730587005615, "mode": "train", "epoch": 43}
{"loss": 0.27819791436195374, "acc": 0.8926214575767517, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.22029860317707062, "acc": 0.9162061810493469, "length": 3.999966621398926, "mode": "train", "epoch": 44}
{"loss": 0.2410399168729782, "acc": 0.9038195013999939, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.20125214755535126, "acc": 0.9218569397926331, "length": 3.9999799728393555, "mode": "train", "epoch": 45}
{"loss": 0.2456750124692917, "acc": 0.8993923664093018, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.1965906322002411, "acc": 0.9244476556777954, "length": 3.9999773502349854, "mode": "train", "epoch": 46}
{"loss": 0.24865195155143738, "acc": 0.9064236879348755, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.19358746707439423, "acc": 0.9275346994400024, "length": 3.9999701976776123, "mode": "train", "epoch": 47}
{"loss": 0.2307618260383606, "acc": 0.9072048664093018, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.18748009204864502, "acc": 0.9281406998634338, "length": 3.9999661445617676, "mode": "train", "epoch": 48}
{"loss": 0.2302529364824295, "acc": 0.9079861044883728, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.1843685507774353, "acc": 0.9311173558235168, "length": 3.9999632835388184, "mode": "train", "epoch": 49}
{"loss": 0.22431185841560364, "acc": 0.9113715291023254, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.1779603511095047, "acc": 0.934948742389679, "length": 3.9999735355377197, "mode": "train", "epoch": 50}
{"loss": 0.23111005127429962, "acc": 0.9107639789581299, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.18109230697155, "acc": 0.9342319369316101, "length": 3.9999585151672363, "mode": "train", "epoch": 51}
{"loss": 0.22844167053699493, "acc": 0.9111111164093018, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.22021611034870148, "acc": 0.9229862689971924, "length": 3.9999637603759766, "mode": "train", "epoch": 52}
{"loss": 0.29353004693984985, "acc": 0.8878471255302429, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.2292943298816681, "acc": 0.9119616150856018, "length": 3.999972343444824, "mode": "train", "epoch": 53}
{"loss": 0.26451537013053894, "acc": 0.9026041030883789, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.19638460874557495, "acc": 0.9263759851455688, "length": 3.999955654144287, "mode": "train", "epoch": 54}
{"loss": 0.23720887303352356, "acc": 0.9154514670372009, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.1850767433643341, "acc": 0.932110071182251, "length": 3.9999756813049316, "mode": "train", "epoch": 55}
{"loss": 0.23297299444675446, "acc": 0.9184027910232544, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.17398647964000702, "acc": 0.9372645020484924, "length": 3.9999778270721436, "mode": "train", "epoch": 56}
{"loss": 0.22428835928440094, "acc": 0.9193577170372009, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.16539567708969116, "acc": 0.9403509497642517, "length": 3.999964714050293, "mode": "train", "epoch": 57}
{"loss": 0.2191762626171112, "acc": 0.9247395396232605, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.1650879830121994, "acc": 0.941288411617279, "length": 3.9999711513519287, "mode": "train", "epoch": 58}
{"loss": 0.21022024750709534, "acc": 0.9256075620651245, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.15738818049430847, "acc": 0.9446789026260376, "length": 3.9999756813049316, "mode": "train", "epoch": 59}
{"loss": 0.20249266922473907, "acc": 0.9309027194976807, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.15607920289039612, "acc": 0.9452853798866272, "length": 3.9999754428863525, "mode": "train", "epoch": 60}
{"loss": 0.19469891488552094, "acc": 0.9328993558883667, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8787068128585815
