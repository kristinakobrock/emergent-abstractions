# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6704028248786926, "acc": 0.5675373077392578, "length": 3.5463266372680664, "mode": "train", "epoch": 1}
{"loss": 0.5923994183540344, "acc": 0.6839509010314941, "length": 3.53125, "mode": "test", "epoch": 1}
{"loss": 0.5159472823143005, "acc": 0.7540551424026489, "length": 3.560288906097412, "mode": "train", "epoch": 2}
{"loss": 0.5000427961349487, "acc": 0.7647769451141357, "length": 3.5641448497772217, "mode": "test", "epoch": 2}
{"loss": 0.4501230716705322, "acc": 0.797561526298523, "length": 3.6746106147766113, "mode": "train", "epoch": 3}
{"loss": 0.4720952808856964, "acc": 0.7876592874526978, "length": 3.9309210777282715, "mode": "test", "epoch": 3}
{"loss": 0.4207458198070526, "acc": 0.8056852221488953, "length": 3.8499410152435303, "mode": "train", "epoch": 4}
{"loss": 0.4501013457775116, "acc": 0.7990671396255493, "length": 3.7483551502227783, "mode": "test", "epoch": 4}
{"loss": 0.3903663456439972, "acc": 0.8261380791664124, "length": 3.788776159286499, "mode": "train", "epoch": 5}
{"loss": 0.4460297226905823, "acc": 0.80126953125, "length": 3.8092105388641357, "mode": "test", "epoch": 5}
{"loss": 0.37981754541397095, "acc": 0.8355615139007568, "length": 3.8294436931610107, "mode": "train", "epoch": 6}
{"loss": 0.40992093086242676, "acc": 0.8313578963279724, "length": 3.893092155456543, "mode": "test", "epoch": 6}
{"loss": 0.3536352217197418, "acc": 0.8510563373565674, "length": 3.8567240238189697, "mode": "train", "epoch": 7}
{"loss": 0.38126108050346375, "acc": 0.8477488160133362, "length": 3.879934310913086, "mode": "test", "epoch": 7}
{"loss": 0.33919206261634827, "acc": 0.8595454096794128, "length": 3.8496110439300537, "mode": "train", "epoch": 8}
{"loss": 0.36305487155914307, "acc": 0.8519633412361145, "length": 3.9046051502227783, "mode": "test", "epoch": 8}
{"loss": 0.3305419981479645, "acc": 0.8612448573112488, "length": 3.8828659057617188, "mode": "train", "epoch": 9}
{"loss": 0.3665681779384613, "acc": 0.8474918007850647, "length": 3.9358551502227783, "mode": "test", "epoch": 9}
{"loss": 0.3248763978481293, "acc": 0.8639923334121704, "length": 3.887559413909912, "mode": "train", "epoch": 10}
{"loss": 0.34566912055015564, "acc": 0.8560701608657837, "length": 3.89802622795105, "mode": "test", "epoch": 10}
{"loss": 0.3167121708393097, "acc": 0.8663702011108398, "length": 3.9004533290863037, "mode": "train", "epoch": 11}
{"loss": 0.3458891212940216, "acc": 0.8585680723190308, "length": 3.9161183834075928, "mode": "test", "epoch": 11}
{"loss": 0.30925261974334717, "acc": 0.8691728115081787, "length": 3.8868210315704346, "mode": "train", "epoch": 12}
{"loss": 0.3443489074707031, "acc": 0.8615902066230774, "length": 3.9259867668151855, "mode": "test", "epoch": 12}
{"loss": 0.30371370911598206, "acc": 0.872031033039093, "length": 3.9021949768066406, "mode": "train", "epoch": 13}
{"loss": 0.3226293623447418, "acc": 0.8696315288543701, "length": 3.942434310913086, "mode": "test", "epoch": 13}
{"loss": 0.2970677614212036, "acc": 0.8759627938270569, "length": 3.912355422973633, "mode": "train", "epoch": 14}
{"loss": 0.33074501156806946, "acc": 0.8644325733184814, "length": 3.963815689086914, "mode": "test", "epoch": 14}
{"loss": 0.2908046543598175, "acc": 0.8787410259246826, "length": 3.886505603790283, "mode": "train", "epoch": 15}
{"loss": 0.31674328446388245, "acc": 0.8713377714157104, "length": 3.9342105388641357, "mode": "test", "epoch": 15}
{"loss": 0.2879475951194763, "acc": 0.8815957903862, "length": 3.9105544090270996, "mode": "train", "epoch": 16}
{"loss": 0.32121947407722473, "acc": 0.8710217475891113, "length": 3.9391448497772217, "mode": "test", "epoch": 16}
{"loss": 0.28345704078674316, "acc": 0.8819279670715332, "length": 3.903238534927368, "mode": "train", "epoch": 17}
{"loss": 0.3099781572818756, "acc": 0.8758121132850647, "length": 3.92927622795105, "mode": "test", "epoch": 17}
{"loss": 0.2730996310710907, "acc": 0.8864831328392029, "length": 3.9116761684417725, "mode": "train", "epoch": 18}
{"loss": 0.3065110146999359, "acc": 0.8727949857711792, "length": 3.932565689086914, "mode": "test", "epoch": 18}
{"loss": 0.2712315022945404, "acc": 0.8876067399978638, "length": 3.919188976287842, "mode": "train", "epoch": 19}
{"loss": 0.29896488785743713, "acc": 0.88525390625, "length": 3.9523026943206787, "mode": "test", "epoch": 19}
{"loss": 0.26614001393318176, "acc": 0.8908558487892151, "length": 3.922497510910034, "mode": "train", "epoch": 20}
{"loss": 0.29437950253486633, "acc": 0.8806846141815186, "length": 3.9276316165924072, "mode": "test", "epoch": 20}
{"loss": 0.2676001787185669, "acc": 0.8899655342102051, "length": 3.9053635597229004, "mode": "train", "epoch": 21}
{"loss": 0.3159565031528473, "acc": 0.8760742545127869, "length": 3.9358551502227783, "mode": "test", "epoch": 21}
{"loss": 0.2697654962539673, "acc": 0.8904159069061279, "length": 3.9038655757904053, "mode": "train", "epoch": 22}
{"loss": 0.3007844090461731, "acc": 0.8796798586845398, "length": 3.9309210777282715, "mode": "test", "epoch": 22}
{"loss": 0.26906970143318176, "acc": 0.8931532502174377, "length": 3.9083003997802734, "mode": "train", "epoch": 23}
{"loss": 0.28468745946884155, "acc": 0.8863821625709534, "length": 3.9342105388641357, "mode": "test", "epoch": 23}
{"loss": 0.2545009255409241, "acc": 0.8962001204490662, "length": 3.918625593185425, "mode": "train", "epoch": 24}
{"loss": 0.284621000289917, "acc": 0.8880550861358643, "length": 3.91447377204895, "mode": "test", "epoch": 24}
{"loss": 0.25711652636528015, "acc": 0.896530032157898, "length": 3.918205499649048, "mode": "train", "epoch": 25}
{"loss": 0.2845444679260254, "acc": 0.8852512836456299, "length": 3.94572377204895, "mode": "test", "epoch": 25}
{"loss": 0.2514895498752594, "acc": 0.8979614973068237, "length": 3.919926881790161, "mode": "train", "epoch": 26}
{"loss": 0.2846052944660187, "acc": 0.8917224407196045, "length": 3.92927622795105, "mode": "test", "epoch": 26}
{"loss": 0.2514389455318451, "acc": 0.8997243642807007, "length": 3.9080235958099365, "mode": "train", "epoch": 27}
{"loss": 0.2802557647228241, "acc": 0.8910619020462036, "length": 3.9226973056793213, "mode": "test", "epoch": 27}
{"loss": 0.24456220865249634, "acc": 0.9019525051116943, "length": 3.9143052101135254, "mode": "train", "epoch": 28}
{"loss": 0.2679007351398468, "acc": 0.8917660713195801, "length": 3.9309210777282715, "mode": "test", "epoch": 28}
{"loss": 0.23888078331947327, "acc": 0.9032146334648132, "length": 3.910512685775757, "mode": "train", "epoch": 29}
{"loss": 0.26838618516921997, "acc": 0.8950145244598389, "length": 3.9259867668151855, "mode": "test", "epoch": 29}
{"loss": 0.23930662870407104, "acc": 0.9016729593276978, "length": 3.914935827255249, "mode": "train", "epoch": 30}
{"loss": 0.2758958637714386, "acc": 0.8924239277839661, "length": 3.919407844543457, "mode": "test", "epoch": 30}
{"loss": 0.2394423633813858, "acc": 0.9034882187843323, "length": 3.920489549636841, "mode": "train", "epoch": 31}
{"loss": 0.25450533628463745, "acc": 0.8987870216369629, "length": 3.9276316165924072, "mode": "test", "epoch": 31}
{"loss": 0.23896943032741547, "acc": 0.9051637649536133, "length": 3.9227418899536133, "mode": "train", "epoch": 32}
{"loss": 0.26620498299598694, "acc": 0.8975200653076172, "length": 3.9309210777282715, "mode": "test", "epoch": 32}
{"loss": 0.2384684532880783, "acc": 0.9067823886871338, "length": 3.916358470916748, "mode": "train", "epoch": 33}
{"loss": 0.26410582661628723, "acc": 0.8953561186790466, "length": 3.932565689086914, "mode": "test", "epoch": 33}
{"loss": 0.2356075793504715, "acc": 0.9073981046676636, "length": 3.914557456970215, "mode": "train", "epoch": 34}
{"loss": 0.27233609557151794, "acc": 0.8948447704315186, "length": 3.8848683834075928, "mode": "test", "epoch": 34}
{"loss": 0.227016881108284, "acc": 0.9113287329673767, "length": 3.9039225578308105, "mode": "train", "epoch": 35}
{"loss": 0.24152329564094543, "acc": 0.9070183634757996, "length": 3.932565689086914, "mode": "test", "epoch": 35}
{"loss": 0.22016814351081848, "acc": 0.9137230515480042, "length": 3.914414167404175, "mode": "train", "epoch": 36}
{"loss": 0.25460803508758545, "acc": 0.905103862285614, "length": 3.9210526943206787, "mode": "test", "epoch": 36}
{"loss": 0.22734065353870392, "acc": 0.9111936092376709, "length": 3.915775775909424, "mode": "train", "epoch": 37}
{"loss": 0.25149816274642944, "acc": 0.9006912708282471, "length": 3.92927622795105, "mode": "test", "epoch": 37}
{"loss": 0.22223009169101715, "acc": 0.9115277528762817, "length": 3.908425807952881, "mode": "train", "epoch": 38}
{"loss": 0.24881821870803833, "acc": 0.9072009921073914, "length": 3.9177632331848145, "mode": "test", "epoch": 38}
{"loss": 0.2174370288848877, "acc": 0.9140506386756897, "length": 3.9059581756591797, "mode": "train", "epoch": 39}
{"loss": 0.2461385279893875, "acc": 0.9060701131820679, "length": 3.9210526943206787, "mode": "test", "epoch": 39}
{"loss": 0.2163066267967224, "acc": 0.914674699306488, "length": 3.9081363677978516, "mode": "train", "epoch": 40}
{"loss": 0.24201396107673645, "acc": 0.9070568084716797, "length": 3.9029605388641357, "mode": "test", "epoch": 40}
{"loss": 0.21313385665416718, "acc": 0.9163772463798523, "length": 3.9082822799682617, "mode": "train", "epoch": 41}
{"loss": 0.23836387693881989, "acc": 0.9093236327171326, "length": 3.9342105388641357, "mode": "test", "epoch": 41}
{"loss": 0.20967374742031097, "acc": 0.9170326590538025, "length": 3.9145381450653076, "mode": "train", "epoch": 42}
{"loss": 0.2391674965620041, "acc": 0.9055740237236023, "length": 3.919407844543457, "mode": "test", "epoch": 42}
{"loss": 0.2115604281425476, "acc": 0.9159827828407288, "length": 3.9066836833953857, "mode": "train", "epoch": 43}
{"loss": 0.2517753541469574, "acc": 0.9062730669975281, "length": 3.90625, "mode": "test", "epoch": 43}
{"loss": 0.21569475531578064, "acc": 0.915217399597168, "length": 3.9092612266540527, "mode": "train", "epoch": 44}
{"loss": 0.2513694167137146, "acc": 0.9064734578132629, "length": 3.9128289222717285, "mode": "test", "epoch": 44}
{"loss": 0.210361048579216, "acc": 0.9180871248245239, "length": 3.906825542449951, "mode": "train", "epoch": 45}
{"loss": 0.25349944829940796, "acc": 0.9050653576850891, "length": 3.9161183834075928, "mode": "test", "epoch": 45}
{"loss": 0.21670430898666382, "acc": 0.9164961576461792, "length": 3.911939859390259, "mode": "train", "epoch": 46}
{"loss": 0.24811868369579315, "acc": 0.9058542847633362, "length": 3.91447377204895, "mode": "test", "epoch": 46}
{"loss": 0.21610073745250702, "acc": 0.9151379466056824, "length": 3.908175468444824, "mode": "train", "epoch": 47}
{"loss": 0.23950646817684174, "acc": 0.9073163866996765, "length": 3.9276316165924072, "mode": "test", "epoch": 47}
{"loss": 0.20671182870864868, "acc": 0.9189452528953552, "length": 3.9088239669799805, "mode": "train", "epoch": 48}
{"loss": 0.23969949781894684, "acc": 0.9083033204078674, "length": 3.9128289222717285, "mode": "test", "epoch": 48}
{"loss": 0.20268969237804413, "acc": 0.919949471950531, "length": 3.9151992797851562, "mode": "train", "epoch": 49}
{"loss": 0.23375000059604645, "acc": 0.9097424745559692, "length": 3.9309210777282715, "mode": "test", "epoch": 49}
{"loss": 0.2056933492422104, "acc": 0.9194245934486389, "length": 3.9131994247436523, "mode": "train", "epoch": 50}
{"loss": 0.23620271682739258, "acc": 0.9118985533714294, "length": 3.9342105388641357, "mode": "test", "epoch": 50}
{"loss": 0.20768845081329346, "acc": 0.917133629322052, "length": 3.912886381149292, "mode": "train", "epoch": 51}
{"loss": 0.2463020533323288, "acc": 0.9029040932655334, "length": 3.9358551502227783, "mode": "test", "epoch": 51}
{"loss": 0.20725500583648682, "acc": 0.9180378913879395, "length": 3.917485475540161, "mode": "train", "epoch": 52}
{"loss": 0.23499976098537445, "acc": 0.9093749523162842, "length": 3.9309210777282715, "mode": "test", "epoch": 52}
{"loss": 0.1998547613620758, "acc": 0.9208803772926331, "length": 3.9114696979522705, "mode": "train", "epoch": 53}
{"loss": 0.24108101427555084, "acc": 0.9064916372299194, "length": 3.9407894611358643, "mode": "test", "epoch": 53}
{"loss": 0.20414304733276367, "acc": 0.9182049632072449, "length": 3.940659523010254, "mode": "train", "epoch": 54}
{"loss": 0.23257556557655334, "acc": 0.9097939729690552, "length": 3.9440789222717285, "mode": "test", "epoch": 54}
{"loss": 0.2048707753419876, "acc": 0.919148325920105, "length": 3.9325923919677734, "mode": "train", "epoch": 55}
{"loss": 0.23394103348255157, "acc": 0.911032497882843, "length": 3.9490132331848145, "mode": "test", "epoch": 55}
{"loss": 0.20009547472000122, "acc": 0.9211686849594116, "length": 3.9289391040802, "mode": "train", "epoch": 56}
{"loss": 0.23686078190803528, "acc": 0.9070414304733276, "length": 3.9358551502227783, "mode": "test", "epoch": 56}
{"loss": 0.19810640811920166, "acc": 0.921123743057251, "length": 3.9252517223358154, "mode": "train", "epoch": 57}
{"loss": 0.23010028898715973, "acc": 0.9116287231445312, "length": 3.9572367668151855, "mode": "test", "epoch": 57}
{"loss": 0.20451319217681885, "acc": 0.9176661968231201, "length": 3.9311790466308594, "mode": "train", "epoch": 58}
{"loss": 0.24125733971595764, "acc": 0.9077893495559692, "length": 3.942434310913086, "mode": "test", "epoch": 58}
{"loss": 0.20297737419605255, "acc": 0.9195007085800171, "length": 3.928487777709961, "mode": "train", "epoch": 59}
{"loss": 0.2401115745306015, "acc": 0.9074990153312683, "length": 3.96052622795105, "mode": "test", "epoch": 59}
{"loss": 0.200835183262825, "acc": 0.920572817325592, "length": 3.9428768157958984, "mode": "train", "epoch": 60}
{"loss": 0.2422630935907364, "acc": 0.9075066447257996, "length": 3.9802632331848145, "mode": "test", "epoch": 60}
test accuracy: 0.8090585470199585
