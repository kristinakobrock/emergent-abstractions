# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6934565901756287, "acc": 0.5143210887908936, "length": 3.4695241451263428, "mode": "train", "epoch": 1}
{"loss": 0.6871727108955383, "acc": 0.5583102703094482, "length": 2.1458332538604736, "mode": "test", "epoch": 1}
{"loss": 0.6555715203285217, "acc": 0.6185140609741211, "length": 3.356539726257324, "mode": "train", "epoch": 2}
{"loss": 0.6314854025840759, "acc": 0.6408324837684631, "length": 3.975694417953491, "mode": "test", "epoch": 2}
{"loss": 0.5736689567565918, "acc": 0.6871967911720276, "length": 3.8906235694885254, "mode": "train", "epoch": 3}
{"loss": 0.5733150243759155, "acc": 0.7153646349906921, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.4899364411830902, "acc": 0.7629202008247375, "length": 3.9480056762695312, "mode": "train", "epoch": 4}
{"loss": 0.5572207570075989, "acc": 0.7500868439674377, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.4486100375652313, "acc": 0.797886073589325, "length": 3.9804067611694336, "mode": "train", "epoch": 5}
{"loss": 0.4956907629966736, "acc": 0.7668402194976807, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.42611438035964966, "acc": 0.8061917424201965, "length": 3.987680673599243, "mode": "train", "epoch": 6}
{"loss": 0.4680790305137634, "acc": 0.7788195013999939, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.4063825309276581, "acc": 0.822232723236084, "length": 3.9921998977661133, "mode": "train", "epoch": 7}
{"loss": 0.45545467734336853, "acc": 0.7870660424232483, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.399164080619812, "acc": 0.8261387944221497, "length": 3.994403839111328, "mode": "train", "epoch": 8}
{"loss": 0.4481250047683716, "acc": 0.8006075620651245, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.38413092494010925, "acc": 0.838029146194458, "length": 3.995830774307251, "mode": "train", "epoch": 9}
{"loss": 0.4542147219181061, "acc": 0.7918403148651123, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.3700820207595825, "acc": 0.8411078453063965, "length": 3.9959144592285156, "mode": "train", "epoch": 10}
{"loss": 0.45166173577308655, "acc": 0.7917535305023193, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.3562646210193634, "acc": 0.8487880229949951, "length": 3.9971721172332764, "mode": "train", "epoch": 11}
{"loss": 0.43761351704597473, "acc": 0.8114582896232605, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.34760379791259766, "acc": 0.855440616607666, "length": 3.9979400634765625, "mode": "train", "epoch": 12}
{"loss": 0.4213407635688782, "acc": 0.819444477558136, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.34879887104034424, "acc": 0.8549535274505615, "length": 3.9978132247924805, "mode": "train", "epoch": 13}
{"loss": 0.43416106700897217, "acc": 0.8101561069488525, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3353789150714874, "acc": 0.8608146905899048, "length": 3.9980733394622803, "mode": "train", "epoch": 14}
{"loss": 0.4040791392326355, "acc": 0.8311631679534912, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.32403746247291565, "acc": 0.8641986846923828, "length": 3.998506784439087, "mode": "train", "epoch": 15}
{"loss": 0.4117242991924286, "acc": 0.8223089575767517, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.31861183047294617, "acc": 0.8658255934715271, "length": 3.998859405517578, "mode": "train", "epoch": 16}
{"loss": 0.3871220350265503, "acc": 0.8305556774139404, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.31018614768981934, "acc": 0.8696514368057251, "length": 3.9987080097198486, "mode": "train", "epoch": 17}
{"loss": 0.37951046228408813, "acc": 0.8364580869674683, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.3112587332725525, "acc": 0.868552565574646, "length": 3.998971700668335, "mode": "train", "epoch": 18}
{"loss": 0.36955374479293823, "acc": 0.8443577289581299, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.3088817894458771, "acc": 0.8684141635894775, "length": 3.998905658721924, "mode": "train", "epoch": 19}
{"loss": 0.35333260893821716, "acc": 0.8552083969116211, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.30088144540786743, "acc": 0.874275803565979, "length": 3.99906849861145, "mode": "train", "epoch": 20}
{"loss": 0.33481112122535706, "acc": 0.8644096851348877, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.2937067747116089, "acc": 0.877491295337677, "length": 3.9991214275360107, "mode": "train", "epoch": 21}
{"loss": 0.34801894426345825, "acc": 0.8561631441116333, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.2905789911746979, "acc": 0.879086434841156, "length": 3.9992244243621826, "mode": "train", "epoch": 22}
{"loss": 0.3391634523868561, "acc": 0.8590278029441833, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.28606951236724854, "acc": 0.8809515237808228, "length": 3.999333143234253, "mode": "train", "epoch": 23}
{"loss": 0.33143648505210876, "acc": 0.8631944060325623, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.2797175347805023, "acc": 0.8846213221549988, "length": 3.9992291927337646, "mode": "train", "epoch": 24}
{"loss": 0.3136393427848816, "acc": 0.8733507394790649, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.274699866771698, "acc": 0.8873751163482666, "length": 3.9992260932922363, "mode": "train", "epoch": 25}
{"loss": 0.3233049213886261, "acc": 0.86328125, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.27270743250846863, "acc": 0.8858397006988525, "length": 3.999384641647339, "mode": "train", "epoch": 26}
{"loss": 0.3307681381702423, "acc": 0.8655382990837097, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.26928550004959106, "acc": 0.8896472454071045, "length": 3.9994559288024902, "mode": "train", "epoch": 27}
{"loss": 0.3154259920120239, "acc": 0.8677084445953369, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.26361167430877686, "acc": 0.8933990597724915, "length": 3.9994235038757324, "mode": "train", "epoch": 28}
{"loss": 0.3011629283428192, "acc": 0.8753472566604614, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.26020362973213196, "acc": 0.894747793674469, "length": 3.9993841648101807, "mode": "train", "epoch": 29}
{"loss": 0.31459763646125793, "acc": 0.8740451335906982, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.251877099275589, "acc": 0.9000144004821777, "length": 3.9994938373565674, "mode": "train", "epoch": 30}
{"loss": 0.29625165462493896, "acc": 0.8871527314186096, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.24684076011180878, "acc": 0.9026057720184326, "length": 3.9994728565216064, "mode": "train", "epoch": 31}
{"loss": 0.29172483086586, "acc": 0.8768229484558105, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.24782967567443848, "acc": 0.9011764526367188, "length": 3.999511241912842, "mode": "train", "epoch": 32}
{"loss": 0.28243595361709595, "acc": 0.8848088979721069, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.23652780055999756, "acc": 0.9090054035186768, "length": 3.9996352195739746, "mode": "train", "epoch": 33}
{"loss": 0.2589624226093292, "acc": 0.9019964933395386, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.2334669828414917, "acc": 0.9090309143066406, "length": 3.9996044635772705, "mode": "train", "epoch": 34}
{"loss": 0.27243056893348694, "acc": 0.8895832896232605, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.23630186915397644, "acc": 0.9096481204032898, "length": 3.9995195865631104, "mode": "train", "epoch": 35}
{"loss": 0.24881376326084137, "acc": 0.9081597924232483, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.22774150967597961, "acc": 0.9101344347000122, "length": 3.999397039413452, "mode": "train", "epoch": 36}
{"loss": 0.24405421316623688, "acc": 0.9048611521720886, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.22120174765586853, "acc": 0.9156474471092224, "length": 3.9997096061706543, "mode": "train", "epoch": 37}
{"loss": 0.24507766962051392, "acc": 0.9059896469116211, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.22045060992240906, "acc": 0.9155893921852112, "length": 3.9995944499969482, "mode": "train", "epoch": 38}
{"loss": 0.2415679544210434, "acc": 0.9098958969116211, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.21993257105350494, "acc": 0.9160212278366089, "length": 3.9996938705444336, "mode": "train", "epoch": 39}
{"loss": 0.24321132898330688, "acc": 0.9012153148651123, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.2210128754377365, "acc": 0.9153512716293335, "length": 3.9997763633728027, "mode": "train", "epoch": 40}
{"loss": 0.23877045512199402, "acc": 0.9049479365348816, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.21502763032913208, "acc": 0.9164323210716248, "length": 3.9997940063476562, "mode": "train", "epoch": 41}
{"loss": 0.2385103702545166, "acc": 0.9037327170372009, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.20986224710941315, "acc": 0.9188063740730286, "length": 3.9997622966766357, "mode": "train", "epoch": 42}
{"loss": 0.2370269000530243, "acc": 0.9114583134651184, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.2079562097787857, "acc": 0.92042475938797, "length": 3.999784231185913, "mode": "train", "epoch": 43}
{"loss": 0.2276693731546402, "acc": 0.9140623807907104, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.2090299129486084, "acc": 0.9212086200714111, "length": 3.9997828006744385, "mode": "train", "epoch": 44}
{"loss": 0.231101855635643, "acc": 0.9113717675209045, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.21267017722129822, "acc": 0.9187803268432617, "length": 3.9997897148132324, "mode": "train", "epoch": 45}
{"loss": 0.23723499476909637, "acc": 0.9078124165534973, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.20941291749477386, "acc": 0.9201176166534424, "length": 3.999617099761963, "mode": "train", "epoch": 46}
{"loss": 0.23459447920322418, "acc": 0.9117186665534973, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.20264875888824463, "acc": 0.9226135015487671, "length": 3.999795436859131, "mode": "train", "epoch": 47}
{"loss": 0.2207985669374466, "acc": 0.9164063334465027, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.2121729701757431, "acc": 0.9191057682037354, "length": 3.999824047088623, "mode": "train", "epoch": 48}
{"loss": 0.22231313586235046, "acc": 0.9166667461395264, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.20083239674568176, "acc": 0.9230215549468994, "length": 3.9998257160186768, "mode": "train", "epoch": 49}
{"loss": 0.24024833738803864, "acc": 0.9099825620651245, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.21570809185504913, "acc": 0.9155426621437073, "length": 3.999785900115967, "mode": "train", "epoch": 50}
{"loss": 0.22728130221366882, "acc": 0.9131944179534912, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.19815029203891754, "acc": 0.924616813659668, "length": 3.9998843669891357, "mode": "train", "epoch": 51}
{"loss": 0.22819362580776215, "acc": 0.9158855080604553, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.1956309825181961, "acc": 0.9244260191917419, "length": 3.9998600482940674, "mode": "train", "epoch": 52}
{"loss": 0.21714681386947632, "acc": 0.9186631441116333, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.189466655254364, "acc": 0.9290155172348022, "length": 3.9998276233673096, "mode": "train", "epoch": 53}
{"loss": 0.21420353651046753, "acc": 0.9201387763023376, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.18769554793834686, "acc": 0.928852379322052, "length": 3.99984073638916, "mode": "train", "epoch": 54}
{"loss": 0.21843421459197998, "acc": 0.9210069179534912, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.1868194192647934, "acc": 0.9306644797325134, "length": 3.999912977218628, "mode": "train", "epoch": 55}
{"loss": 0.21043218672275543, "acc": 0.9205729961395264, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.1828513741493225, "acc": 0.9320433139801025, "length": 3.9999401569366455, "mode": "train", "epoch": 56}
{"loss": 0.2223881632089615, "acc": 0.9189236760139465, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.18272000551223755, "acc": 0.9317198395729065, "length": 3.9999377727508545, "mode": "train", "epoch": 57}
{"loss": 0.2143217772245407, "acc": 0.9204861521720886, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.18729200959205627, "acc": 0.9283703565597534, "length": 3.999929428100586, "mode": "train", "epoch": 58}
{"loss": 0.23278041183948517, "acc": 0.9088541865348816, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.18683427572250366, "acc": 0.9309370517730713, "length": 3.9999473094940186, "mode": "train", "epoch": 59}
{"loss": 0.2177281230688095, "acc": 0.9178818464279175, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.1820647269487381, "acc": 0.9325307607650757, "length": 3.9999639987945557, "mode": "train", "epoch": 60}
{"loss": 0.2065943330526352, "acc": 0.9231770634651184, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8572642207145691
