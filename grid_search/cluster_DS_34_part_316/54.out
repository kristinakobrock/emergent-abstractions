# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6962206363677979, "acc": 0.5038508176803589, "length": 3.5819766521453857, "mode": "train", "epoch": 1}
{"loss": 0.6950825452804565, "acc": 0.5, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6920205950737, "acc": 0.5179523825645447, "length": 3.284313440322876, "mode": "train", "epoch": 2}
{"loss": 0.6918919086456299, "acc": 0.5059943199157715, "length": 1.357421875, "mode": "test", "epoch": 2}
{"loss": 0.6775396466255188, "acc": 0.572387158870697, "length": 2.9151079654693604, "mode": "train", "epoch": 3}
{"loss": 0.6601386666297913, "acc": 0.6213103532791138, "length": 3.296875, "mode": "test", "epoch": 3}
{"loss": 0.6281321048736572, "acc": 0.6605076789855957, "length": 3.2202789783477783, "mode": "train", "epoch": 4}
{"loss": 0.5982658267021179, "acc": 0.6849677562713623, "length": 3.361328125, "mode": "test", "epoch": 4}
{"loss": 0.5743659734725952, "acc": 0.7122917175292969, "length": 3.3548130989074707, "mode": "train", "epoch": 5}
{"loss": 0.5517203211784363, "acc": 0.7495841979980469, "length": 3.41796875, "mode": "test", "epoch": 5}
{"loss": 0.5321573615074158, "acc": 0.7398018836975098, "length": 3.5658302307128906, "mode": "train", "epoch": 6}
{"loss": 0.5226489305496216, "acc": 0.7494744062423706, "length": 3.716796875, "mode": "test", "epoch": 6}
{"loss": 0.5129768252372742, "acc": 0.7419055104255676, "length": 3.7982261180877686, "mode": "train", "epoch": 7}
{"loss": 0.5253037214279175, "acc": 0.7347937822341919, "length": 3.873046875, "mode": "test", "epoch": 7}
{"loss": 0.5099650621414185, "acc": 0.7575150728225708, "length": 3.834009885787964, "mode": "train", "epoch": 8}
{"loss": 0.5054188966751099, "acc": 0.7604101896286011, "length": 3.87109375, "mode": "test", "epoch": 8}
{"loss": 0.4918566644191742, "acc": 0.7634572982788086, "length": 3.8457157611846924, "mode": "train", "epoch": 9}
{"loss": 0.48932120203971863, "acc": 0.7660996317863464, "length": 3.857421875, "mode": "test", "epoch": 9}
{"loss": 0.48773616552352905, "acc": 0.765440821647644, "length": 3.8640968799591064, "mode": "train", "epoch": 10}
{"loss": 0.4799465537071228, "acc": 0.7644066214561462, "length": 3.8515625, "mode": "test", "epoch": 10}
{"loss": 0.4802905023097992, "acc": 0.7696093916893005, "length": 3.8462321758270264, "mode": "train", "epoch": 11}
{"loss": 0.4758339524269104, "acc": 0.7629257440567017, "length": 3.873046875, "mode": "test", "epoch": 11}
{"loss": 0.4679521918296814, "acc": 0.7738503813743591, "length": 3.8514676094055176, "mode": "train", "epoch": 12}
{"loss": 0.46941351890563965, "acc": 0.766741156578064, "length": 3.857421875, "mode": "test", "epoch": 12}
{"loss": 0.46560537815093994, "acc": 0.7797346115112305, "length": 3.844510555267334, "mode": "train", "epoch": 13}
{"loss": 0.4527356028556824, "acc": 0.7828094959259033, "length": 3.912109375, "mode": "test", "epoch": 13}
{"loss": 0.4469166398048401, "acc": 0.7899109125137329, "length": 3.858715057373047, "mode": "train", "epoch": 14}
{"loss": 0.4391933083534241, "acc": 0.8043837547302246, "length": 3.904296875, "mode": "test", "epoch": 14}
{"loss": 0.4385956823825836, "acc": 0.7996261715888977, "length": 3.8706552982330322, "mode": "train", "epoch": 15}
{"loss": 0.4315073490142822, "acc": 0.8157531023025513, "length": 3.85546875, "mode": "test", "epoch": 15}
{"loss": 0.42953646183013916, "acc": 0.8054007887840271, "length": 3.9088354110717773, "mode": "train", "epoch": 16}
{"loss": 0.4225776791572571, "acc": 0.8183883428573608, "length": 3.869140625, "mode": "test", "epoch": 16}
{"loss": 0.425780713558197, "acc": 0.8076778650283813, "length": 3.8192172050476074, "mode": "train", "epoch": 17}
{"loss": 0.4301483631134033, "acc": 0.8157852292060852, "length": 3.916015625, "mode": "test", "epoch": 17}
{"loss": 0.4324781000614166, "acc": 0.8051130175590515, "length": 3.9406142234802246, "mode": "train", "epoch": 18}
{"loss": 0.43050217628479004, "acc": 0.814887285232544, "length": 3.96875, "mode": "test", "epoch": 18}
{"loss": 0.4211324155330658, "acc": 0.8102878332138062, "length": 3.9400646686553955, "mode": "train", "epoch": 19}
{"loss": 0.4154929518699646, "acc": 0.8193389177322388, "length": 3.900390625, "mode": "test", "epoch": 19}
{"loss": 0.41445720195770264, "acc": 0.814664363861084, "length": 3.8691484928131104, "mode": "train", "epoch": 20}
{"loss": 0.4149336814880371, "acc": 0.8136916160583496, "length": 3.876953125, "mode": "test", "epoch": 20}
{"loss": 0.40845024585723877, "acc": 0.8188228011131287, "length": 3.9041380882263184, "mode": "train", "epoch": 21}
{"loss": 0.40366849303245544, "acc": 0.8219069838523865, "length": 3.923828125, "mode": "test", "epoch": 21}
{"loss": 0.4061034917831421, "acc": 0.8211053609848022, "length": 3.9047300815582275, "mode": "train", "epoch": 22}
{"loss": 0.401960164308548, "acc": 0.8284285068511963, "length": 3.92578125, "mode": "test", "epoch": 22}
{"loss": 0.3984876275062561, "acc": 0.8242011666297913, "length": 3.9120569229125977, "mode": "train", "epoch": 23}
{"loss": 0.40113911032676697, "acc": 0.8252646923065186, "length": 3.92578125, "mode": "test", "epoch": 23}
{"loss": 0.40744462609291077, "acc": 0.8215387463569641, "length": 3.909641742706299, "mode": "train", "epoch": 24}
{"loss": 0.4025290608406067, "acc": 0.8300437927246094, "length": 3.966796875, "mode": "test", "epoch": 24}
{"loss": 0.39589664340019226, "acc": 0.8249147534370422, "length": 3.914210796356201, "mode": "train", "epoch": 25}
{"loss": 0.3853086233139038, "acc": 0.8332054615020752, "length": 3.90625, "mode": "test", "epoch": 25}
{"loss": 0.3907976448535919, "acc": 0.8280688524246216, "length": 3.900601625442505, "mode": "train", "epoch": 26}
{"loss": 0.3820439577102661, "acc": 0.8382735252380371, "length": 3.923828125, "mode": "test", "epoch": 26}
{"loss": 0.3736133575439453, "acc": 0.8334711194038391, "length": 3.9310410022735596, "mode": "train", "epoch": 27}
{"loss": 0.3795647919178009, "acc": 0.8301849365234375, "length": 3.955078125, "mode": "test", "epoch": 27}
{"loss": 0.3735654652118683, "acc": 0.8327210545539856, "length": 3.934487819671631, "mode": "train", "epoch": 28}
{"loss": 0.3759285807609558, "acc": 0.8394852876663208, "length": 3.927734375, "mode": "test", "epoch": 28}
{"loss": 0.36976391077041626, "acc": 0.8361873626708984, "length": 3.914884328842163, "mode": "train", "epoch": 29}
{"loss": 0.38206231594085693, "acc": 0.8257858157157898, "length": 3.951171875, "mode": "test", "epoch": 29}
{"loss": 0.37156203389167786, "acc": 0.8353784680366516, "length": 3.9514355659484863, "mode": "train", "epoch": 30}
{"loss": 0.3742947578430176, "acc": 0.8385804891586304, "length": 3.951171875, "mode": "test", "epoch": 30}
{"loss": 0.37525174021720886, "acc": 0.8384912610054016, "length": 3.9346792697906494, "mode": "train", "epoch": 31}
{"loss": 0.35333532094955444, "acc": 0.8449262976646423, "length": 3.953125, "mode": "test", "epoch": 31}
{"loss": 0.35628247261047363, "acc": 0.8420975804328918, "length": 3.9348978996276855, "mode": "train", "epoch": 32}
{"loss": 0.3645893335342407, "acc": 0.8446365594863892, "length": 3.927734375, "mode": "test", "epoch": 32}
{"loss": 0.3597966432571411, "acc": 0.8401206135749817, "length": 3.9264774322509766, "mode": "train", "epoch": 33}
{"loss": 0.35285747051239014, "acc": 0.8475264310836792, "length": 3.9453125, "mode": "test", "epoch": 33}
{"loss": 0.36009588837623596, "acc": 0.8457953929901123, "length": 3.946484327316284, "mode": "train", "epoch": 34}
{"loss": 0.3525538444519043, "acc": 0.8535810708999634, "length": 3.94921875, "mode": "test", "epoch": 34}
{"loss": 0.34821826219558716, "acc": 0.8500090837478638, "length": 3.943535566329956, "mode": "train", "epoch": 35}
{"loss": 0.34057343006134033, "acc": 0.8537673950195312, "length": 3.94921875, "mode": "test", "epoch": 35}
{"loss": 0.34396541118621826, "acc": 0.848708987236023, "length": 3.9401912689208984, "mode": "train", "epoch": 36}
{"loss": 0.34125635027885437, "acc": 0.8582527041435242, "length": 3.9453125, "mode": "test", "epoch": 36}
{"loss": 0.3462367653846741, "acc": 0.8531373739242554, "length": 3.9440078735351562, "mode": "train", "epoch": 37}
{"loss": 0.33505353331565857, "acc": 0.8562194108963013, "length": 3.962890625, "mode": "test", "epoch": 37}
{"loss": 0.3349169194698334, "acc": 0.8536826968193054, "length": 3.958040237426758, "mode": "train", "epoch": 38}
{"loss": 0.3333445191383362, "acc": 0.8623831272125244, "length": 3.970703125, "mode": "test", "epoch": 38}
{"loss": 0.33176249265670776, "acc": 0.8550684452056885, "length": 3.9469738006591797, "mode": "train", "epoch": 39}
{"loss": 0.3245244324207306, "acc": 0.8573516011238098, "length": 3.951171875, "mode": "test", "epoch": 39}
{"loss": 0.3410303592681885, "acc": 0.8551688194274902, "length": 3.9565908908843994, "mode": "train", "epoch": 40}
{"loss": 0.3241228759288788, "acc": 0.8652297854423523, "length": 3.974609375, "mode": "test", "epoch": 40}
{"loss": 0.3275589346885681, "acc": 0.8577096462249756, "length": 3.9675464630126953, "mode": "train", "epoch": 41}
{"loss": 0.3241567611694336, "acc": 0.8571769595146179, "length": 3.982421875, "mode": "test", "epoch": 41}
{"loss": 0.3332005739212036, "acc": 0.8538362383842468, "length": 3.960728645324707, "mode": "train", "epoch": 42}
{"loss": 0.33949634432792664, "acc": 0.8618155717849731, "length": 3.97265625, "mode": "test", "epoch": 42}
{"loss": 0.3417755365371704, "acc": 0.8560590147972107, "length": 3.9593329429626465, "mode": "train", "epoch": 43}
{"loss": 0.3346065282821655, "acc": 0.8657277822494507, "length": 3.9765625, "mode": "test", "epoch": 43}
{"loss": 0.3277510404586792, "acc": 0.8550214767456055, "length": 3.9664602279663086, "mode": "train", "epoch": 44}
{"loss": 0.32329654693603516, "acc": 0.8632567524909973, "length": 3.982421875, "mode": "test", "epoch": 44}
{"loss": 0.3349519968032837, "acc": 0.8608262538909912, "length": 3.9758729934692383, "mode": "train", "epoch": 45}
{"loss": 0.31933414936065674, "acc": 0.8706289529800415, "length": 3.990234375, "mode": "test", "epoch": 45}
{"loss": 0.32387474179267883, "acc": 0.8595665693283081, "length": 3.97629451751709, "mode": "train", "epoch": 46}
{"loss": 0.3184512257575989, "acc": 0.8721475005149841, "length": 3.998046875, "mode": "test", "epoch": 46}
{"loss": 0.3176092207431793, "acc": 0.8626664876937866, "length": 3.97701358795166, "mode": "train", "epoch": 47}
{"loss": 0.32593870162963867, "acc": 0.8689467906951904, "length": 3.9765625, "mode": "test", "epoch": 47}
{"loss": 0.32160717248916626, "acc": 0.8623735904693604, "length": 3.9707744121551514, "mode": "train", "epoch": 48}
{"loss": 0.3163025975227356, "acc": 0.8679830431938171, "length": 3.982421875, "mode": "test", "epoch": 48}
{"loss": 0.3192278742790222, "acc": 0.8650959730148315, "length": 3.972384452819824, "mode": "train", "epoch": 49}
{"loss": 0.31700989603996277, "acc": 0.86367267370224, "length": 3.986328125, "mode": "test", "epoch": 49}
{"loss": 0.3171634376049042, "acc": 0.8677452802658081, "length": 3.976184129714966, "mode": "train", "epoch": 50}
{"loss": 0.3162192404270172, "acc": 0.865842342376709, "length": 3.9609375, "mode": "test", "epoch": 50}
{"loss": 0.31797048449516296, "acc": 0.8632559180259705, "length": 3.9629135131835938, "mode": "train", "epoch": 51}
{"loss": 0.31003129482269287, "acc": 0.8702841997146606, "length": 3.97265625, "mode": "test", "epoch": 51}
{"loss": 0.3091047704219818, "acc": 0.8685129284858704, "length": 3.966525077819824, "mode": "train", "epoch": 52}
{"loss": 0.29841214418411255, "acc": 0.8788412809371948, "length": 3.974609375, "mode": "test", "epoch": 52}
{"loss": 0.3025163412094116, "acc": 0.8704844117164612, "length": 3.9876344203948975, "mode": "train", "epoch": 53}
{"loss": 0.29949110746383667, "acc": 0.8748655915260315, "length": 3.998046875, "mode": "test", "epoch": 53}
{"loss": 0.2950974702835083, "acc": 0.8743270039558411, "length": 3.9933032989501953, "mode": "train", "epoch": 54}
{"loss": 0.2955355942249298, "acc": 0.877876341342926, "length": 3.98828125, "mode": "test", "epoch": 54}
{"loss": 0.2983020842075348, "acc": 0.8771977424621582, "length": 3.9863436222076416, "mode": "train", "epoch": 55}
{"loss": 0.296547532081604, "acc": 0.8774109482765198, "length": 3.98828125, "mode": "test", "epoch": 55}
{"loss": 0.300104558467865, "acc": 0.8758680820465088, "length": 3.9828379154205322, "mode": "train", "epoch": 56}
{"loss": 0.29535597562789917, "acc": 0.8806198239326477, "length": 3.994140625, "mode": "test", "epoch": 56}
{"loss": 0.29363927245140076, "acc": 0.8797497749328613, "length": 3.9896039962768555, "mode": "train", "epoch": 57}
{"loss": 0.28070104122161865, "acc": 0.8831374645233154, "length": 3.9921875, "mode": "test", "epoch": 57}
{"loss": 0.28343987464904785, "acc": 0.8817256093025208, "length": 3.988158941268921, "mode": "train", "epoch": 58}
{"loss": 0.2717275619506836, "acc": 0.8879882097244263, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.28307273983955383, "acc": 0.882515013217926, "length": 3.996896505355835, "mode": "train", "epoch": 59}
{"loss": 0.2816302180290222, "acc": 0.8874999284744263, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.28749170899391174, "acc": 0.8848837614059448, "length": 3.9985318183898926, "mode": "train", "epoch": 60}
{"loss": 0.2725308835506439, "acc": 0.8888669610023499, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8059473633766174
