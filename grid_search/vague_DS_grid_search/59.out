# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6948736906051636, "acc": 0.49688392877578735, "length": 3.6185953617095947, "mode": "train", "epoch": 1}
{"loss": 0.6927416920661926, "acc": 0.5049804449081421, "length": 1.021484375, "mode": "test", "epoch": 1}
{"loss": 0.6914407014846802, "acc": 0.5292580127716064, "length": 3.5130972862243652, "mode": "train", "epoch": 2}
{"loss": 0.6748043894767761, "acc": 0.6383721232414246, "length": 3.015625, "mode": "test", "epoch": 2}
{"loss": 0.6588132977485657, "acc": 0.6357312202453613, "length": 3.739675283432007, "mode": "train", "epoch": 3}
{"loss": 0.617060661315918, "acc": 0.6550398468971252, "length": 3.9765625, "mode": "test", "epoch": 3}
{"loss": 0.6008333563804626, "acc": 0.6541642546653748, "length": 3.9017317295074463, "mode": "train", "epoch": 4}
{"loss": 0.5979223847389221, "acc": 0.6685547828674316, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.5659335255622864, "acc": 0.7073116898536682, "length": 3.865300416946411, "mode": "train", "epoch": 5}
{"loss": 0.5849927663803101, "acc": 0.6579102873802185, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.5312902331352234, "acc": 0.7274636626243591, "length": 3.934000253677368, "mode": "train", "epoch": 6}
{"loss": 0.5956969261169434, "acc": 0.6783202886581421, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.5204991102218628, "acc": 0.7354847192764282, "length": 3.97241473197937, "mode": "train", "epoch": 7}
{"loss": 0.5712061524391174, "acc": 0.7069334387779236, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.5010614395141602, "acc": 0.7519587874412537, "length": 3.979534149169922, "mode": "train", "epoch": 8}
{"loss": 0.549449622631073, "acc": 0.7262693643569946, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.4941420257091522, "acc": 0.7611892819404602, "length": 3.9812729358673096, "mode": "train", "epoch": 9}
{"loss": 0.5575394630432129, "acc": 0.7288085222244263, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.47919049859046936, "acc": 0.7742440700531006, "length": 3.9809212684631348, "mode": "train", "epoch": 10}
{"loss": 0.5694536566734314, "acc": 0.7277345061302185, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.46453896164894104, "acc": 0.7892677187919617, "length": 3.9786479473114014, "mode": "train", "epoch": 11}
{"loss": 0.5280519127845764, "acc": 0.7569337487220764, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.4469480812549591, "acc": 0.7997839450836182, "length": 3.982560157775879, "mode": "train", "epoch": 12}
{"loss": 0.5532107949256897, "acc": 0.7625976204872131, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.43821871280670166, "acc": 0.8061749935150146, "length": 3.988314151763916, "mode": "train", "epoch": 13}
{"loss": 0.48972761631011963, "acc": 0.7870116233825684, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.4183739721775055, "acc": 0.8132094740867615, "length": 3.991783857345581, "mode": "train", "epoch": 14}
{"loss": 0.47488319873809814, "acc": 0.7911133170127869, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.4090569317340851, "acc": 0.8173924088478088, "length": 3.9935739040374756, "mode": "train", "epoch": 15}
{"loss": 0.4679756760597229, "acc": 0.7942384481430054, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.4020184576511383, "acc": 0.8242945671081543, "length": 3.995006561279297, "mode": "train", "epoch": 16}
{"loss": 0.46676647663116455, "acc": 0.8057617545127869, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.3852809965610504, "acc": 0.8264130353927612, "length": 3.9959192276000977, "mode": "train", "epoch": 17}
{"loss": 0.44357579946517944, "acc": 0.8125976920127869, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.3830937445163727, "acc": 0.8320645093917847, "length": 3.9961721897125244, "mode": "train", "epoch": 18}
{"loss": 0.4502699375152588, "acc": 0.8100585341453552, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.37103530764579773, "acc": 0.8352488279342651, "length": 3.9960896968841553, "mode": "train", "epoch": 19}
{"loss": 0.44061410427093506, "acc": 0.8103514313697815, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.36293819546699524, "acc": 0.8417256474494934, "length": 3.9968528747558594, "mode": "train", "epoch": 20}
{"loss": 0.40368425846099854, "acc": 0.8240233659744263, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.35688841342926025, "acc": 0.8487423062324524, "length": 3.996553421020508, "mode": "train", "epoch": 21}
{"loss": 0.39164188504219055, "acc": 0.82470703125, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.34001681208610535, "acc": 0.8526713252067566, "length": 3.9967973232269287, "mode": "train", "epoch": 22}
{"loss": 0.3709982931613922, "acc": 0.8397460579872131, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.329475998878479, "acc": 0.8614577651023865, "length": 3.9965267181396484, "mode": "train", "epoch": 23}
{"loss": 0.3559786379337311, "acc": 0.8472656607627869, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.31134435534477234, "acc": 0.8673273921012878, "length": 3.9971091747283936, "mode": "train", "epoch": 24}
{"loss": 0.35221540927886963, "acc": 0.8505859375, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.30631741881370544, "acc": 0.8743621706962585, "length": 3.9974303245544434, "mode": "train", "epoch": 25}
{"loss": 0.33886784315109253, "acc": 0.8582030534744263, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.30161726474761963, "acc": 0.8781207203865051, "length": 3.998509645462036, "mode": "train", "epoch": 26}
{"loss": 0.34123262763023376, "acc": 0.8535155653953552, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.2980816960334778, "acc": 0.8792901635169983, "length": 3.9986095428466797, "mode": "train", "epoch": 27}
{"loss": 0.33489638566970825, "acc": 0.8539062738418579, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.28341689705848694, "acc": 0.8798223733901978, "length": 3.9989404678344727, "mode": "train", "epoch": 28}
{"loss": 0.3179943263530731, "acc": 0.8611326217651367, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.2873791754245758, "acc": 0.8832520246505737, "length": 3.998802661895752, "mode": "train", "epoch": 29}
{"loss": 0.31545886397361755, "acc": 0.8601564168930054, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.2789541780948639, "acc": 0.8835344314575195, "length": 3.9991250038146973, "mode": "train", "epoch": 30}
{"loss": 0.30858227610588074, "acc": 0.865625262260437, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.2735463082790375, "acc": 0.8860340118408203, "length": 3.9993817806243896, "mode": "train", "epoch": 31}
{"loss": 0.3097534477710724, "acc": 0.864648699760437, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.2710959315299988, "acc": 0.8876156806945801, "length": 3.99951171875, "mode": "train", "epoch": 32}
{"loss": 0.30479297041893005, "acc": 0.8666014075279236, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.26297733187675476, "acc": 0.8904938101768494, "length": 3.9995534420013428, "mode": "train", "epoch": 33}
{"loss": 0.3085619807243347, "acc": 0.8624024391174316, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.25359466671943665, "acc": 0.8916031122207642, "length": 3.9996516704559326, "mode": "train", "epoch": 34}
{"loss": 0.30969399213790894, "acc": 0.8663085699081421, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.26655539870262146, "acc": 0.8911321759223938, "length": 3.9996049404144287, "mode": "train", "epoch": 35}
{"loss": 0.2970532178878784, "acc": 0.8713866472244263, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.2548590302467346, "acc": 0.8936543464660645, "length": 3.9997291564941406, "mode": "train", "epoch": 36}
{"loss": 0.2993115782737732, "acc": 0.8675780892372131, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.2571575343608856, "acc": 0.8916881680488586, "length": 3.9996819496154785, "mode": "train", "epoch": 37}
{"loss": 0.29182136058807373, "acc": 0.8719725608825684, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.24485017359256744, "acc": 0.8974452614784241, "length": 3.9997732639312744, "mode": "train", "epoch": 38}
{"loss": 0.29637575149536133, "acc": 0.8706054091453552, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.24142307043075562, "acc": 0.8984386324882507, "length": 3.999713659286499, "mode": "train", "epoch": 39}
{"loss": 0.2982249855995178, "acc": 0.8719725608825684, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.2511785924434662, "acc": 0.8984110951423645, "length": 3.999706983566284, "mode": "train", "epoch": 40}
{"loss": 0.2891099452972412, "acc": 0.8771482706069946, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.24825093150138855, "acc": 0.8981102705001831, "length": 3.9998042583465576, "mode": "train", "epoch": 41}
{"loss": 0.3017079830169678, "acc": 0.87255859375, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.23925963044166565, "acc": 0.8996580839157104, "length": 3.999758720397949, "mode": "train", "epoch": 42}
{"loss": 0.29022273421287537, "acc": 0.8713865876197815, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.23703931272029877, "acc": 0.901930570602417, "length": 3.99985408782959, "mode": "train", "epoch": 43}
{"loss": 0.2892003655433655, "acc": 0.8775390982627869, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.23627609014511108, "acc": 0.9032039642333984, "length": 3.99985671043396, "mode": "train", "epoch": 44}
{"loss": 0.2881850004196167, "acc": 0.8726562261581421, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.2350347340106964, "acc": 0.900820255279541, "length": 3.9997730255126953, "mode": "train", "epoch": 45}
{"loss": 0.28437256813049316, "acc": 0.8777345418930054, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.2313201129436493, "acc": 0.9013788104057312, "length": 3.9998857975006104, "mode": "train", "epoch": 46}
{"loss": 0.2760734558105469, "acc": 0.8799805045127869, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.23406264185905457, "acc": 0.9059718251228333, "length": 3.9998841285705566, "mode": "train", "epoch": 47}
{"loss": 0.27099448442459106, "acc": 0.8822265267372131, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.23604223132133484, "acc": 0.9057496786117554, "length": 3.999875068664551, "mode": "train", "epoch": 48}
{"loss": 0.2753108739852905, "acc": 0.8825196027755737, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.2270846664905548, "acc": 0.9056951999664307, "length": 3.9998891353607178, "mode": "train", "epoch": 49}
{"loss": 0.27291375398635864, "acc": 0.8859376311302185, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.22014035284519196, "acc": 0.9089062809944153, "length": 3.999927043914795, "mode": "train", "epoch": 50}
{"loss": 0.2693282961845398, "acc": 0.8856444954872131, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.22279587388038635, "acc": 0.908546507358551, "length": 3.999922275543213, "mode": "train", "epoch": 51}
{"loss": 0.2639186978340149, "acc": 0.8895507454872131, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.22596406936645508, "acc": 0.9045626521110535, "length": 3.999934673309326, "mode": "train", "epoch": 52}
{"loss": 0.2645167112350464, "acc": 0.8874998688697815, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.22331108152866364, "acc": 0.9085472226142883, "length": 3.9999420642852783, "mode": "train", "epoch": 53}
{"loss": 0.2564992308616638, "acc": 0.8900390267372131, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.21619509160518646, "acc": 0.9088795185089111, "length": 3.999943494796753, "mode": "train", "epoch": 54}
{"loss": 0.2512081563472748, "acc": 0.8903322219848633, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.21696530282497406, "acc": 0.9099025130271912, "length": 3.9999122619628906, "mode": "train", "epoch": 55}
{"loss": 0.25424283742904663, "acc": 0.8916992545127869, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.21435591578483582, "acc": 0.9089905619621277, "length": 3.9999475479125977, "mode": "train", "epoch": 56}
{"loss": 0.25953319668769836, "acc": 0.8904298543930054, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.23084522783756256, "acc": 0.9043795466423035, "length": 3.999607801437378, "mode": "train", "epoch": 57}
{"loss": 0.26408591866493225, "acc": 0.891015887260437, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.2162235677242279, "acc": 0.9101524949073792, "length": 3.999948024749756, "mode": "train", "epoch": 58}
{"loss": 0.2610931992530823, "acc": 0.8909178972244263, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.20923371613025665, "acc": 0.9120895266532898, "length": 3.9999516010284424, "mode": "train", "epoch": 59}
{"loss": 0.25854867696762085, "acc": 0.8921874761581421, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.2107699066400528, "acc": 0.9141647815704346, "length": 3.999945640563965, "mode": "train", "epoch": 60}
{"loss": 0.26645660400390625, "acc": 0.8900390267372131, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8367798328399658
