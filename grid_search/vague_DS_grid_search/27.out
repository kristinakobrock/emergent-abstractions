# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.0005", "--hidden_size=128", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6924023032188416, "acc": 0.511971652507782, "length": 3.6118881702423096, "mode": "train", "epoch": 1}
{"loss": 0.6875097155570984, "acc": 0.5387736558914185, "length": 3.203125, "mode": "test", "epoch": 1}
{"loss": 0.6880165338516235, "acc": 0.5364120602607727, "length": 3.63757061958313, "mode": "train", "epoch": 2}
{"loss": 0.6807507872581482, "acc": 0.553906261920929, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.6498180031776428, "acc": 0.6296204924583435, "length": 3.9071857929229736, "mode": "train", "epoch": 3}
{"loss": 0.6148993968963623, "acc": 0.6616320610046387, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.5824090838432312, "acc": 0.6925474405288696, "length": 3.983511447906494, "mode": "train", "epoch": 4}
{"loss": 0.5717753171920776, "acc": 0.6980902552604675, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.526263415813446, "acc": 0.7450768351554871, "length": 3.9930782318115234, "mode": "train", "epoch": 5}
{"loss": 0.508367657661438, "acc": 0.7641492486000061, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.47824805974960327, "acc": 0.776069700717926, "length": 3.990865707397461, "mode": "train", "epoch": 6}
{"loss": 0.4818664789199829, "acc": 0.7830729484558105, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.453391969203949, "acc": 0.797328531742096, "length": 3.9955239295959473, "mode": "train", "epoch": 7}
{"loss": 0.46519559621810913, "acc": 0.789930522441864, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.4363068640232086, "acc": 0.8035781383514404, "length": 3.9963223934173584, "mode": "train", "epoch": 8}
{"loss": 0.45602238178253174, "acc": 0.7928818464279175, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.4270678758621216, "acc": 0.8090816736221313, "length": 3.9972128868103027, "mode": "train", "epoch": 9}
{"loss": 0.432995468378067, "acc": 0.8088541030883789, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.40314310789108276, "acc": 0.8222523331642151, "length": 3.9971566200256348, "mode": "train", "epoch": 10}
{"loss": 0.41722989082336426, "acc": 0.8177951574325562, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.39442893862724304, "acc": 0.8258810639381409, "length": 3.9979567527770996, "mode": "train", "epoch": 11}
{"loss": 0.4084211587905884, "acc": 0.8248264789581299, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.3777275085449219, "acc": 0.8350323438644409, "length": 3.997285842895508, "mode": "train", "epoch": 12}
{"loss": 0.39578333497047424, "acc": 0.8341145515441895, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.3761567175388336, "acc": 0.8395305275917053, "length": 3.9986233711242676, "mode": "train", "epoch": 13}
{"loss": 0.3860478401184082, "acc": 0.8350694179534912, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3705933690071106, "acc": 0.8401796817779541, "length": 3.997849941253662, "mode": "train", "epoch": 14}
{"loss": 0.38009658455848694, "acc": 0.8340277075767517, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.364956796169281, "acc": 0.8458163738250732, "length": 3.9990973472595215, "mode": "train", "epoch": 15}
{"loss": 0.37869057059288025, "acc": 0.8369792103767395, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.367410272359848, "acc": 0.8444344997406006, "length": 3.9993886947631836, "mode": "train", "epoch": 16}
{"loss": 0.3699313998222351, "acc": 0.8442708849906921, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.3684921860694885, "acc": 0.8441009521484375, "length": 3.9994640350341797, "mode": "train", "epoch": 17}
{"loss": 0.37493059039115906, "acc": 0.8442708849906921, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.35328710079193115, "acc": 0.848512589931488, "length": 3.998854637145996, "mode": "train", "epoch": 18}
{"loss": 0.3683741092681885, "acc": 0.8443577289581299, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.3497801721096039, "acc": 0.8491868376731873, "length": 3.999460220336914, "mode": "train", "epoch": 19}
{"loss": 0.3646339178085327, "acc": 0.8440971970558167, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.3492828905582428, "acc": 0.8500399589538574, "length": 3.99933123588562, "mode": "train", "epoch": 20}
{"loss": 0.3681846857070923, "acc": 0.8427082896232605, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.3408908247947693, "acc": 0.853402853012085, "length": 3.9991092681884766, "mode": "train", "epoch": 21}
{"loss": 0.36022326350212097, "acc": 0.845920205116272, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.3419196307659149, "acc": 0.8516252040863037, "length": 3.9992787837982178, "mode": "train", "epoch": 22}
{"loss": 0.35409653186798096, "acc": 0.8457466959953308, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.3373781442642212, "acc": 0.852658748626709, "length": 3.9993960857391357, "mode": "train", "epoch": 23}
{"loss": 0.348696231842041, "acc": 0.8477431535720825, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.33423900604248047, "acc": 0.8556128144264221, "length": 3.999424934387207, "mode": "train", "epoch": 24}
{"loss": 0.34720274806022644, "acc": 0.8501736521720886, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.3325679898262024, "acc": 0.857157826423645, "length": 3.999091863632202, "mode": "train", "epoch": 25}
{"loss": 0.3533787727355957, "acc": 0.8475693464279175, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.3277772068977356, "acc": 0.8591331839561462, "length": 3.9990198612213135, "mode": "train", "epoch": 26}
{"loss": 0.3437862992286682, "acc": 0.8506076335906982, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.32059821486473083, "acc": 0.861531138420105, "length": 3.999824047088623, "mode": "train", "epoch": 27}
{"loss": 0.3455875813961029, "acc": 0.8479166030883789, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.3285912275314331, "acc": 0.8578895926475525, "length": 3.9998021125793457, "mode": "train", "epoch": 28}
{"loss": 0.3393912613391876, "acc": 0.852430522441864, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.32195645570755005, "acc": 0.8608031868934631, "length": 3.999674081802368, "mode": "train", "epoch": 29}
{"loss": 0.3374301791191101, "acc": 0.8506076335906982, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.3140057921409607, "acc": 0.862781286239624, "length": 3.9997358322143555, "mode": "train", "epoch": 30}
{"loss": 0.33041536808013916, "acc": 0.8559027910232544, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.3150882422924042, "acc": 0.8657751083374023, "length": 3.999415159225464, "mode": "train", "epoch": 31}
{"loss": 0.3294104337692261, "acc": 0.8568576574325562, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.31111323833465576, "acc": 0.8651899695396423, "length": 3.999239921569824, "mode": "train", "epoch": 32}
{"loss": 0.32868924736976624, "acc": 0.8592013120651245, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.3123966157436371, "acc": 0.8650888800621033, "length": 3.9998888969421387, "mode": "train", "epoch": 33}
{"loss": 0.3275880813598633, "acc": 0.8546872735023499, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.3067210614681244, "acc": 0.8687258958816528, "length": 3.999772548675537, "mode": "train", "epoch": 34}
{"loss": 0.3256099820137024, "acc": 0.8590278625488281, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.3028278648853302, "acc": 0.8683120608329773, "length": 3.9998486042022705, "mode": "train", "epoch": 35}
{"loss": 0.330137699842453, "acc": 0.8570311665534973, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.30545127391815186, "acc": 0.8703152537345886, "length": 3.9999327659606934, "mode": "train", "epoch": 36}
{"loss": 0.32278499007225037, "acc": 0.8598090410232544, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.29981186985969543, "acc": 0.870495617389679, "length": 3.9992377758026123, "mode": "train", "epoch": 37}
{"loss": 0.3196352422237396, "acc": 0.8630208969116211, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.3012412488460541, "acc": 0.8689523935317993, "length": 3.9998996257781982, "mode": "train", "epoch": 38}
{"loss": 0.3169795274734497, "acc": 0.862152636051178, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.30009493231773376, "acc": 0.8729001879692078, "length": 3.9999489784240723, "mode": "train", "epoch": 39}
{"loss": 0.3136163651943207, "acc": 0.8638021349906921, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.2973578870296478, "acc": 0.8719820976257324, "length": 3.999911069869995, "mode": "train", "epoch": 40}
{"loss": 0.31467050313949585, "acc": 0.8626735210418701, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.29750385880470276, "acc": 0.873650312423706, "length": 3.9999351501464844, "mode": "train", "epoch": 41}
{"loss": 0.31502565741539, "acc": 0.8661459684371948, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.2925879955291748, "acc": 0.8737042546272278, "length": 3.9998888969421387, "mode": "train", "epoch": 42}
{"loss": 0.30972737073898315, "acc": 0.8690104484558105, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.2980116605758667, "acc": 0.8739843368530273, "length": 3.999952793121338, "mode": "train", "epoch": 43}
{"loss": 0.3122040331363678, "acc": 0.8678820729255676, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.29246267676353455, "acc": 0.8716468811035156, "length": 3.999796152114868, "mode": "train", "epoch": 44}
{"loss": 0.3105161488056183, "acc": 0.8690104484558105, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.29349830746650696, "acc": 0.8746232986450195, "length": 3.9999470710754395, "mode": "train", "epoch": 45}
{"loss": 0.31816816329956055, "acc": 0.8644096851348877, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.28784093260765076, "acc": 0.8717061281204224, "length": 3.999988555908203, "mode": "train", "epoch": 46}
{"loss": 0.3078349828720093, "acc": 0.8702256679534912, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.2884136140346527, "acc": 0.8761253952980042, "length": 3.9999918937683105, "mode": "train", "epoch": 47}
{"loss": 0.3115042746067047, "acc": 0.8684027194976807, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.2901318371295929, "acc": 0.8773150444030762, "length": 3.999866008758545, "mode": "train", "epoch": 48}
{"loss": 0.30666419863700867, "acc": 0.8704862594604492, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.28045281767845154, "acc": 0.8798463940620422, "length": 3.999889850616455, "mode": "train", "epoch": 49}
{"loss": 0.3000350296497345, "acc": 0.8698785305023193, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.28430435061454773, "acc": 0.8794049620628357, "length": 3.9999916553497314, "mode": "train", "epoch": 50}
{"loss": 0.30095022916793823, "acc": 0.8714409470558167, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.28324687480926514, "acc": 0.8789768218994141, "length": 3.999507427215576, "mode": "train", "epoch": 51}
{"loss": 0.3012335002422333, "acc": 0.8746525645256042, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.2808859348297119, "acc": 0.8805167078971863, "length": 3.9999914169311523, "mode": "train", "epoch": 52}
{"loss": 0.3031429350376129, "acc": 0.8735242486000061, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.2844436466693878, "acc": 0.8783487677574158, "length": 3.9999887943267822, "mode": "train", "epoch": 53}
{"loss": 0.2941223382949829, "acc": 0.875, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.28111404180526733, "acc": 0.8801553249359131, "length": 3.9999921321868896, "mode": "train", "epoch": 54}
{"loss": 0.3010624945163727, "acc": 0.8756943345069885, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.28659671545028687, "acc": 0.8782643675804138, "length": 3.9999582767486572, "mode": "train", "epoch": 55}
{"loss": 0.3018362820148468, "acc": 0.8690972924232483, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.27477967739105225, "acc": 0.8811269998550415, "length": 3.9999237060546875, "mode": "train", "epoch": 56}
{"loss": 0.29491743445396423, "acc": 0.8760417103767395, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.2819909453392029, "acc": 0.8797661662101746, "length": 3.9999887943267822, "mode": "train", "epoch": 57}
{"loss": 0.301857590675354, "acc": 0.8721354603767395, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.2802918255329132, "acc": 0.8817936778068542, "length": 3.9999594688415527, "mode": "train", "epoch": 58}
{"loss": 0.2971600294113159, "acc": 0.8769097924232483, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.27402547001838684, "acc": 0.8845826983451843, "length": 3.999497175216675, "mode": "train", "epoch": 59}
{"loss": 0.29264259338378906, "acc": 0.8766491413116455, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.27211347222328186, "acc": 0.8856834173202515, "length": 3.999932050704956, "mode": "train", "epoch": 60}
{"loss": 0.2875547707080841, "acc": 0.8824653029441833, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8476667404174805
