# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6811746954917908, "acc": 0.5488366484642029, "length": 3.38533878326416, "mode": "train", "epoch": 1}
{"loss": 0.6161674857139587, "acc": 0.6450521349906921, "length": 4.0, "mode": "test", "epoch": 1}
{"loss": 0.5993345975875854, "acc": 0.6716433167457581, "length": 3.900826930999756, "mode": "train", "epoch": 2}
{"loss": 0.6215488314628601, "acc": 0.6470485925674438, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.5497328042984009, "acc": 0.7275848984718323, "length": 3.9736785888671875, "mode": "train", "epoch": 3}
{"loss": 0.528174102306366, "acc": 0.7532118558883667, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.5164342522621155, "acc": 0.7428772449493408, "length": 3.9930663108825684, "mode": "train", "epoch": 4}
{"loss": 0.5134598612785339, "acc": 0.7522569894790649, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.49298572540283203, "acc": 0.7518721222877502, "length": 3.9946529865264893, "mode": "train", "epoch": 5}
{"loss": 0.4825843274593353, "acc": 0.7728297710418701, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.4589390456676483, "acc": 0.7836039662361145, "length": 3.9958794116973877, "mode": "train", "epoch": 6}
{"loss": 0.46145880222320557, "acc": 0.7941839694976807, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.4277549088001251, "acc": 0.8042530417442322, "length": 3.99745512008667, "mode": "train", "epoch": 7}
{"loss": 0.4255777597427368, "acc": 0.8109375834465027, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.41097360849380493, "acc": 0.8119523525238037, "length": 3.998488187789917, "mode": "train", "epoch": 8}
{"loss": 0.4125078022480011, "acc": 0.8038194179534912, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.39444997906684875, "acc": 0.8169686794281006, "length": 3.9986796379089355, "mode": "train", "epoch": 9}
{"loss": 0.41171708703041077, "acc": 0.8164930939674377, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.3808418810367584, "acc": 0.8281838297843933, "length": 3.9991719722747803, "mode": "train", "epoch": 10}
{"loss": 0.37229254841804504, "acc": 0.8315103650093079, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.3769349157810211, "acc": 0.8280454874038696, "length": 3.999398946762085, "mode": "train", "epoch": 11}
{"loss": 0.3757823705673218, "acc": 0.8385417461395264, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.36386799812316895, "acc": 0.834040641784668, "length": 3.9994235038757324, "mode": "train", "epoch": 12}
{"loss": 0.34890905022621155, "acc": 0.8465278148651123, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.3569641709327698, "acc": 0.8366297483444214, "length": 3.999903917312622, "mode": "train", "epoch": 13}
{"loss": 0.3482555150985718, "acc": 0.8460938930511475, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3506109118461609, "acc": 0.8422355055809021, "length": 3.999922513961792, "mode": "train", "epoch": 14}
{"loss": 0.34595760703086853, "acc": 0.845920205116272, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.34169819951057434, "acc": 0.8461032509803772, "length": 3.9999332427978516, "mode": "train", "epoch": 15}
{"loss": 0.338594913482666, "acc": 0.8515625, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.3358640670776367, "acc": 0.8513165712356567, "length": 3.9999430179595947, "mode": "train", "epoch": 16}
{"loss": 0.3316023051738739, "acc": 0.8490452170372009, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.3307037055492401, "acc": 0.8531377911567688, "length": 3.9999332427978516, "mode": "train", "epoch": 17}
{"loss": 0.32159745693206787, "acc": 0.8604167103767395, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.31936007738113403, "acc": 0.8616008758544922, "length": 3.9999024868011475, "mode": "train", "epoch": 18}
{"loss": 0.3124774694442749, "acc": 0.8636284470558167, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.3153323233127594, "acc": 0.8637310862541199, "length": 3.9998979568481445, "mode": "train", "epoch": 19}
{"loss": 0.3163914084434509, "acc": 0.8602430820465088, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.3099023699760437, "acc": 0.8680210113525391, "length": 3.9999825954437256, "mode": "train", "epoch": 20}
{"loss": 0.3197842836380005, "acc": 0.8596352934837341, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.30421194434165955, "acc": 0.8681608438491821, "length": 3.9999756813049316, "mode": "train", "epoch": 21}
{"loss": 0.3007925748825073, "acc": 0.8653644919395447, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.29267317056655884, "acc": 0.8731775879859924, "length": 3.9999477863311768, "mode": "train", "epoch": 22}
{"loss": 0.2925998270511627, "acc": 0.8723089694976807, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.2911794185638428, "acc": 0.8750274777412415, "length": 3.9999704360961914, "mode": "train", "epoch": 23}
{"loss": 0.3001546859741211, "acc": 0.8684895634651184, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.2924697995185852, "acc": 0.8726726174354553, "length": 3.9999635219573975, "mode": "train", "epoch": 24}
{"loss": 0.2882736623287201, "acc": 0.8739582896232605, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.2764565348625183, "acc": 0.882062554359436, "length": 3.999990940093994, "mode": "train", "epoch": 25}
{"loss": 0.2801918089389801, "acc": 0.8831596970558167, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.27577105164527893, "acc": 0.8831268548965454, "length": 3.9999747276306152, "mode": "train", "epoch": 26}
{"loss": 0.2745324373245239, "acc": 0.8817707896232605, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.2750180661678314, "acc": 0.8853970766067505, "length": 3.999859571456909, "mode": "train", "epoch": 27}
{"loss": 0.3031769394874573, "acc": 0.8747396469116211, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.27066317200660706, "acc": 0.8868263363838196, "length": 3.9999818801879883, "mode": "train", "epoch": 28}
{"loss": 0.25427505373954773, "acc": 0.8951390385627747, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.2537370026111603, "acc": 0.893692672252655, "length": 3.9999358654022217, "mode": "train", "epoch": 29}
{"loss": 0.2591213881969452, "acc": 0.8934028148651123, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.2534314692020416, "acc": 0.8930206298828125, "length": 3.9999794960021973, "mode": "train", "epoch": 30}
{"loss": 0.2742520272731781, "acc": 0.8921007513999939, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.2471071481704712, "acc": 0.8960197567939758, "length": 3.9999892711639404, "mode": "train", "epoch": 31}
{"loss": 0.2504532039165497, "acc": 0.8979166746139526, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.25286051630973816, "acc": 0.8947793841362, "length": 3.999798536300659, "mode": "train", "epoch": 32}
{"loss": 0.2627270519733429, "acc": 0.8926214575767517, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.24823378026485443, "acc": 0.8984024524688721, "length": 3.999999761581421, "mode": "train", "epoch": 33}
{"loss": 0.24595969915390015, "acc": 0.8959202170372009, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.2375308722257614, "acc": 0.905212938785553, "length": 3.9999992847442627, "mode": "train", "epoch": 34}
{"loss": 0.2375659942626953, "acc": 0.9028645753860474, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.23029150068759918, "acc": 0.906446099281311, "length": 4.0, "mode": "train", "epoch": 35}
{"loss": 0.24621081352233887, "acc": 0.9033854603767395, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.23434628546237946, "acc": 0.9058014154434204, "length": 3.999998092651367, "mode": "train", "epoch": 36}
{"loss": 0.2472791075706482, "acc": 0.8991318941116333, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.2448907196521759, "acc": 0.9012050628662109, "length": 3.999999523162842, "mode": "train", "epoch": 37}
{"loss": 0.24073603749275208, "acc": 0.9053819179534912, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.23794804513454437, "acc": 0.9025218486785889, "length": 3.9999942779541016, "mode": "train", "epoch": 38}
{"loss": 0.24660056829452515, "acc": 0.9031249284744263, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.22931696474552155, "acc": 0.9075673222541809, "length": 4.0, "mode": "train", "epoch": 39}
{"loss": 0.23562973737716675, "acc": 0.9037325978279114, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.2339155524969101, "acc": 0.9050446152687073, "length": 3.999993085861206, "mode": "train", "epoch": 40}
{"loss": 0.23884360492229462, "acc": 0.9070312976837158, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.23305776715278625, "acc": 0.905184805393219, "length": 3.999999523162842, "mode": "train", "epoch": 41}
{"loss": 0.22055485844612122, "acc": 0.9136284589767456, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.2240060567855835, "acc": 0.9089405536651611, "length": 4.0, "mode": "train", "epoch": 42}
{"loss": 0.2218058705329895, "acc": 0.9083333611488342, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.2261975258588791, "acc": 0.9061658382415771, "length": 3.9999961853027344, "mode": "train", "epoch": 43}
{"loss": 0.22809304296970367, "acc": 0.9072917103767395, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.21431399881839752, "acc": 0.9140416383743286, "length": 4.0, "mode": "train", "epoch": 44}
{"loss": 0.2118079960346222, "acc": 0.9155382513999939, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.20668748021125793, "acc": 0.9176846742630005, "length": 3.999995231628418, "mode": "train", "epoch": 45}
{"loss": 0.20782668888568878, "acc": 0.9184895753860474, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.2092069834470749, "acc": 0.9181333780288696, "length": 4.0, "mode": "train", "epoch": 46}
{"loss": 0.21100252866744995, "acc": 0.91796875, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.2075200080871582, "acc": 0.9169563055038452, "length": 4.0, "mode": "train", "epoch": 47}
{"loss": 0.21292276680469513, "acc": 0.9165797829627991, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.2076985388994217, "acc": 0.9163116812705994, "length": 4.0, "mode": "train", "epoch": 48}
{"loss": 0.22110547125339508, "acc": 0.9094618558883667, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.20280158519744873, "acc": 0.9185816049575806, "length": 3.9999945163726807, "mode": "train", "epoch": 49}
{"loss": 0.20558318495750427, "acc": 0.9180556535720825, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.20024468004703522, "acc": 0.9205437302589417, "length": 4.0, "mode": "train", "epoch": 50}
{"loss": 0.20630669593811035, "acc": 0.9205729365348816, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.19619326293468475, "acc": 0.9221411943435669, "length": 3.999999761581421, "mode": "train", "epoch": 51}
{"loss": 0.20776881277561188, "acc": 0.9230034351348877, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.19320310652256012, "acc": 0.9248036742210388, "length": 4.0, "mode": "train", "epoch": 52}
{"loss": 0.20866887271404266, "acc": 0.9189236164093018, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.19577066600322723, "acc": 0.922225296497345, "length": 4.0, "mode": "train", "epoch": 53}
{"loss": 0.22034721076488495, "acc": 0.9114582538604736, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.2026354819536209, "acc": 0.9199830889701843, "length": 4.0, "mode": "train", "epoch": 54}
{"loss": 0.21120800077915192, "acc": 0.9163194298744202, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.1932845115661621, "acc": 0.9251681566238403, "length": 4.0, "mode": "train", "epoch": 55}
{"loss": 0.21036548912525177, "acc": 0.9186631441116333, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.19716580212116241, "acc": 0.9210481643676758, "length": 3.99999737739563, "mode": "train", "epoch": 56}
{"loss": 0.2261483073234558, "acc": 0.9043402075767517, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.19602832198143005, "acc": 0.9214966893196106, "length": 4.0, "mode": "train", "epoch": 57}
{"loss": 0.2118607461452484, "acc": 0.9146702289581299, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.1996692419052124, "acc": 0.9188268184661865, "length": 3.99985408782959, "mode": "train", "epoch": 58}
{"loss": 0.2074919492006302, "acc": 0.9194445013999939, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.21270319819450378, "acc": 0.9172646403312683, "length": 4.0, "mode": "train", "epoch": 59}
{"loss": 0.2804725766181946, "acc": 0.8869791030883789, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.22929151356220245, "acc": 0.9091367721557617, "length": 3.9999992847442627, "mode": "train", "epoch": 60}
{"loss": 0.2418312430381775, "acc": 0.9045138955116272, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8373387455940247
