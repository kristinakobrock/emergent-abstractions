# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6939480900764465, "acc": 0.5064815282821655, "length": 3.6034467220306396, "mode": "train", "epoch": 1}
{"loss": 0.690079927444458, "acc": 0.5524185299873352, "length": 1.4140625, "mode": "test", "epoch": 1}
{"loss": 0.6878417730331421, "acc": 0.5547151565551758, "length": 3.0638484954833984, "mode": "train", "epoch": 2}
{"loss": 0.6747956275939941, "acc": 0.6465164422988892, "length": 2.36328125, "mode": "test", "epoch": 2}
{"loss": 0.6435449719429016, "acc": 0.6480271220207214, "length": 3.412619113922119, "mode": "train", "epoch": 3}
{"loss": 0.6119470596313477, "acc": 0.6505860686302185, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.5970020294189453, "acc": 0.6582422256469727, "length": 3.974972724914551, "mode": "train", "epoch": 4}
{"loss": 0.5991458296775818, "acc": 0.6576172709465027, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.5860567092895508, "acc": 0.6916725039482117, "length": 3.9872846603393555, "mode": "train", "epoch": 5}
{"loss": 0.585496723651886, "acc": 0.6611328721046448, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.571309506893158, "acc": 0.7067323923110962, "length": 3.994112968444824, "mode": "train", "epoch": 6}
{"loss": 0.5717514753341675, "acc": 0.673828125, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.5495838522911072, "acc": 0.7231598496437073, "length": 3.994359016418457, "mode": "train", "epoch": 7}
{"loss": 0.555499792098999, "acc": 0.7095704078674316, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.5266166925430298, "acc": 0.736698567867279, "length": 3.9965085983276367, "mode": "train", "epoch": 8}
{"loss": 0.5498826503753662, "acc": 0.7278319001197815, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.5191844701766968, "acc": 0.7513006329536438, "length": 3.9960315227508545, "mode": "train", "epoch": 9}
{"loss": 0.5291313529014587, "acc": 0.7481445670127869, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.5099122524261475, "acc": 0.7629733681678772, "length": 3.9966378211975098, "mode": "train", "epoch": 10}
{"loss": 0.5241106748580933, "acc": 0.7542968392372131, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.5030450224876404, "acc": 0.7633691430091858, "length": 3.995022773742676, "mode": "train", "epoch": 11}
{"loss": 0.5178785920143127, "acc": 0.7382813096046448, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.5009191036224365, "acc": 0.7562142014503479, "length": 3.9954674243927, "mode": "train", "epoch": 12}
{"loss": 0.5221409797668457, "acc": 0.7362304925918579, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.4889961779117584, "acc": 0.7677096128463745, "length": 3.996058702468872, "mode": "train", "epoch": 13}
{"loss": 0.513582706451416, "acc": 0.7459960579872131, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.4816267192363739, "acc": 0.7744361758232117, "length": 3.9943182468414307, "mode": "train", "epoch": 14}
{"loss": 0.503885805606842, "acc": 0.7630859017372131, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.4778258204460144, "acc": 0.7783887982368469, "length": 3.9967634677886963, "mode": "train", "epoch": 15}
{"loss": 0.5026612281799316, "acc": 0.7516602873802185, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.4677005708217621, "acc": 0.780515193939209, "length": 3.994919776916504, "mode": "train", "epoch": 16}
{"loss": 0.48777610063552856, "acc": 0.7628907561302185, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.45091456174850464, "acc": 0.7872428297996521, "length": 3.9983723163604736, "mode": "train", "epoch": 17}
{"loss": 0.4817536771297455, "acc": 0.7701172232627869, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.44156110286712646, "acc": 0.7960305213928223, "length": 3.9977104663848877, "mode": "train", "epoch": 18}
{"loss": 0.47220438718795776, "acc": 0.7858397960662842, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.42783117294311523, "acc": 0.8047903180122375, "length": 3.997807264328003, "mode": "train", "epoch": 19}
{"loss": 0.457943856716156, "acc": 0.7966798543930054, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.4163694977760315, "acc": 0.8158677816390991, "length": 3.9987332820892334, "mode": "train", "epoch": 20}
{"loss": 0.4600525498390198, "acc": 0.8061522841453552, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.4080335795879364, "acc": 0.8221237659454346, "length": 3.9987781047821045, "mode": "train", "epoch": 21}
{"loss": 0.4348481297492981, "acc": 0.8069335222244263, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.3968386650085449, "acc": 0.8289962410926819, "length": 3.9982945919036865, "mode": "train", "epoch": 22}
{"loss": 0.41289377212524414, "acc": 0.8173828125, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.3830975294113159, "acc": 0.8317630290985107, "length": 3.9994101524353027, "mode": "train", "epoch": 23}
{"loss": 0.41486191749572754, "acc": 0.8135743141174316, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.3814195394515991, "acc": 0.8329735994338989, "length": 3.9993104934692383, "mode": "train", "epoch": 24}
{"loss": 0.39947956800460815, "acc": 0.824804425239563, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.3633018136024475, "acc": 0.8447687029838562, "length": 3.999378204345703, "mode": "train", "epoch": 25}
{"loss": 0.38302865624427795, "acc": 0.8332031965255737, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.35846561193466187, "acc": 0.8437974452972412, "length": 3.999009132385254, "mode": "train", "epoch": 26}
{"loss": 0.38082772493362427, "acc": 0.8310546875, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.3549402356147766, "acc": 0.8481990098953247, "length": 3.999661445617676, "mode": "train", "epoch": 27}
{"loss": 0.36829933524131775, "acc": 0.8446289300918579, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.33793285489082336, "acc": 0.8568913340568542, "length": 3.9981465339660645, "mode": "train", "epoch": 28}
{"loss": 0.3651954233646393, "acc": 0.8433594107627869, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.3359697759151459, "acc": 0.8584474325180054, "length": 3.999640703201294, "mode": "train", "epoch": 29}
{"loss": 0.36820971965789795, "acc": 0.8442382216453552, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.33653363585472107, "acc": 0.8561422824859619, "length": 3.9989736080169678, "mode": "train", "epoch": 30}
{"loss": 0.3621733486652374, "acc": 0.8460937142372131, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.3314606845378876, "acc": 0.8607155680656433, "length": 3.998748540878296, "mode": "train", "epoch": 31}
{"loss": 0.351811021566391, "acc": 0.8581055998802185, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.3155907988548279, "acc": 0.8666431903839111, "length": 3.99918270111084, "mode": "train", "epoch": 32}
{"loss": 0.3405703604221344, "acc": 0.85400390625, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.3106595575809479, "acc": 0.8702545166015625, "length": 3.9998557567596436, "mode": "train", "epoch": 33}
{"loss": 0.34191426634788513, "acc": 0.8584961295127869, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.3055611550807953, "acc": 0.872374951839447, "length": 3.999812126159668, "mode": "train", "epoch": 34}
{"loss": 0.3390255570411682, "acc": 0.8593750596046448, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.3158784806728363, "acc": 0.8671558499336243, "length": 3.999246597290039, "mode": "train", "epoch": 35}
{"loss": 0.3427555561065674, "acc": 0.8559569716453552, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.3071845769882202, "acc": 0.8737069368362427, "length": 3.998929262161255, "mode": "train", "epoch": 36}
{"loss": 0.3424232304096222, "acc": 0.8637695908546448, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.2952739894390106, "acc": 0.8754980564117432, "length": 3.999443769454956, "mode": "train", "epoch": 37}
{"loss": 0.33542853593826294, "acc": 0.8626952171325684, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.2867470681667328, "acc": 0.879021406173706, "length": 3.9999427795410156, "mode": "train", "epoch": 38}
{"loss": 0.32245320081710815, "acc": 0.8615235686302185, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.2834034264087677, "acc": 0.8824253678321838, "length": 3.999455690383911, "mode": "train", "epoch": 39}
{"loss": 0.32510197162628174, "acc": 0.8602538704872131, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.2844340205192566, "acc": 0.8860462307929993, "length": 3.9998345375061035, "mode": "train", "epoch": 40}
{"loss": 0.3238261044025421, "acc": 0.8668946623802185, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.2852553725242615, "acc": 0.8840343356132507, "length": 3.999887466430664, "mode": "train", "epoch": 41}
{"loss": 0.3124696910381317, "acc": 0.8678708672523499, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.26936063170433044, "acc": 0.8902396559715271, "length": 3.9999351501464844, "mode": "train", "epoch": 42}
{"loss": 0.30676352977752686, "acc": 0.86962890625, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.26845699548721313, "acc": 0.8917391896247864, "length": 3.9995906352996826, "mode": "train", "epoch": 43}
{"loss": 0.2981070876121521, "acc": 0.8757814168930054, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.25796642899513245, "acc": 0.8928849697113037, "length": 3.999912977218628, "mode": "train", "epoch": 44}
{"loss": 0.29870888590812683, "acc": 0.8770508170127869, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.25735604763031006, "acc": 0.8952568173408508, "length": 3.999955892562866, "mode": "train", "epoch": 45}
{"loss": 0.2997279465198517, "acc": 0.8767577409744263, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.2623636722564697, "acc": 0.8923068642616272, "length": 3.9999337196350098, "mode": "train", "epoch": 46}
{"loss": 0.28644809126853943, "acc": 0.8818359971046448, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.25230157375335693, "acc": 0.8955937623977661, "length": 3.999574661254883, "mode": "train", "epoch": 47}
{"loss": 0.2987276613712311, "acc": 0.875, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.25856149196624756, "acc": 0.8962742686271667, "length": 3.9999337196350098, "mode": "train", "epoch": 48}
{"loss": 0.2950572371482849, "acc": 0.8808593153953552, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.25212591886520386, "acc": 0.8992394804954529, "length": 3.9996156692504883, "mode": "train", "epoch": 49}
{"loss": 0.28490573167800903, "acc": 0.8869141340255737, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.24550379812717438, "acc": 0.9026715755462646, "length": 3.9999663829803467, "mode": "train", "epoch": 50}
{"loss": 0.2789497971534729, "acc": 0.8870116472244263, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.24271659553050995, "acc": 0.9064611792564392, "length": 3.9996178150177, "mode": "train", "epoch": 51}
{"loss": 0.27520108222961426, "acc": 0.8931640982627869, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.23969754576683044, "acc": 0.9071300625801086, "length": 3.99983549118042, "mode": "train", "epoch": 52}
{"loss": 0.2750309705734253, "acc": 0.8919920921325684, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.2346923053264618, "acc": 0.9102246761322021, "length": 3.9999828338623047, "mode": "train", "epoch": 53}
{"loss": 0.28917238116264343, "acc": 0.8916015625, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.2391039878129959, "acc": 0.9051233530044556, "length": 3.999945640563965, "mode": "train", "epoch": 54}
{"loss": 0.2786090075969696, "acc": 0.8891602158546448, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.23426102101802826, "acc": 0.9072274565696716, "length": 3.9996182918548584, "mode": "train", "epoch": 55}
{"loss": 0.28407251834869385, "acc": 0.8892578482627869, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.2372395247220993, "acc": 0.9073053002357483, "length": 3.99949312210083, "mode": "train", "epoch": 56}
{"loss": 0.2800929546356201, "acc": 0.8889650702476501, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.2304726094007492, "acc": 0.9075785875320435, "length": 3.999972343444824, "mode": "train", "epoch": 57}
{"loss": 0.2701055705547333, "acc": 0.8915038704872131, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.2218814343214035, "acc": 0.9138628840446472, "length": 3.9999709129333496, "mode": "train", "epoch": 58}
{"loss": 0.2688162922859192, "acc": 0.8914060592651367, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.2232867032289505, "acc": 0.9152405261993408, "length": 3.9999730587005615, "mode": "train", "epoch": 59}
{"loss": 0.2668445110321045, "acc": 0.8984375, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.21908427774906158, "acc": 0.9175560474395752, "length": 3.9999639987945557, "mode": "train", "epoch": 60}
{"loss": 0.2680353820323944, "acc": 0.8950194716453552, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8706035614013672
