# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.694046139717102, "acc": 0.4990061819553375, "length": 3.5933332443237305, "mode": "train", "epoch": 1}
{"loss": 0.6891482472419739, "acc": 0.5624152421951294, "length": 1.126953125, "mode": "test", "epoch": 1}
{"loss": 0.6886268258094788, "acc": 0.5409265160560608, "length": 3.2353856563568115, "mode": "train", "epoch": 2}
{"loss": 0.6762279868125916, "acc": 0.6231207847595215, "length": 2.060546875, "mode": "test", "epoch": 2}
{"loss": 0.6542381048202515, "acc": 0.6497402787208557, "length": 2.614823818206787, "mode": "train", "epoch": 3}
{"loss": 0.6084712147712708, "acc": 0.6852432489395142, "length": 3.11328125, "mode": "test", "epoch": 3}
{"loss": 0.6010909676551819, "acc": 0.6676710844039917, "length": 3.630425453186035, "mode": "train", "epoch": 4}
{"loss": 0.5939153432846069, "acc": 0.6828126311302185, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.5860609412193298, "acc": 0.6831029653549194, "length": 3.9786860942840576, "mode": "train", "epoch": 5}
{"loss": 0.578359842300415, "acc": 0.6815429329872131, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.573299765586853, "acc": 0.6980940699577332, "length": 3.9877023696899414, "mode": "train", "epoch": 6}
{"loss": 0.5770418643951416, "acc": 0.6976563930511475, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.5638657212257385, "acc": 0.7092968225479126, "length": 3.9927849769592285, "mode": "train", "epoch": 7}
{"loss": 0.5680427551269531, "acc": 0.7109375, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.564915120601654, "acc": 0.7164410948753357, "length": 3.9944944381713867, "mode": "train", "epoch": 8}
{"loss": 0.5782057046890259, "acc": 0.6895507574081421, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.5477330088615417, "acc": 0.7341329455375671, "length": 3.995265483856201, "mode": "train", "epoch": 9}
{"loss": 0.5560672283172607, "acc": 0.7374997735023499, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.5414361953735352, "acc": 0.745830774307251, "length": 3.9964616298675537, "mode": "train", "epoch": 10}
{"loss": 0.5610390305519104, "acc": 0.7208008170127869, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.5381624698638916, "acc": 0.74851393699646, "length": 3.997128963470459, "mode": "train", "epoch": 11}
{"loss": 0.5449598431587219, "acc": 0.7511717081069946, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.5279653668403625, "acc": 0.7468454241752625, "length": 3.9979636669158936, "mode": "train", "epoch": 12}
{"loss": 0.5291239619255066, "acc": 0.7565429210662842, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.5150484442710876, "acc": 0.7573373317718506, "length": 3.998734951019287, "mode": "train", "epoch": 13}
{"loss": 0.5224083065986633, "acc": 0.7537109851837158, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.5100330114364624, "acc": 0.7602217793464661, "length": 3.99898624420166, "mode": "train", "epoch": 14}
{"loss": 0.5117628574371338, "acc": 0.7493165731430054, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.4928966462612152, "acc": 0.7637664675712585, "length": 3.999136447906494, "mode": "train", "epoch": 15}
{"loss": 0.5064111948013306, "acc": 0.7572265863418579, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.47059258818626404, "acc": 0.7751747369766235, "length": 3.9996795654296875, "mode": "train", "epoch": 16}
{"loss": 0.4850262403488159, "acc": 0.7738280892372131, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.4625012278556824, "acc": 0.7821198105812073, "length": 3.9997365474700928, "mode": "train", "epoch": 17}
{"loss": 0.47694385051727295, "acc": 0.7767577171325684, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.4523514211177826, "acc": 0.7850282788276672, "length": 3.9998538494110107, "mode": "train", "epoch": 18}
{"loss": 0.4687645435333252, "acc": 0.7854493856430054, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.4469582140445709, "acc": 0.7908371686935425, "length": 3.9997713565826416, "mode": "train", "epoch": 19}
{"loss": 0.46270036697387695, "acc": 0.79296875, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.43466901779174805, "acc": 0.7953212261199951, "length": 3.9997804164886475, "mode": "train", "epoch": 20}
{"loss": 0.45435136556625366, "acc": 0.7921874523162842, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.43344172835350037, "acc": 0.8018207550048828, "length": 3.99971604347229, "mode": "train", "epoch": 21}
{"loss": 0.45068851113319397, "acc": 0.8004884123802185, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.4235841631889343, "acc": 0.80528324842453, "length": 3.9999165534973145, "mode": "train", "epoch": 22}
{"loss": 0.4338681697845459, "acc": 0.8032227158546448, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.42206937074661255, "acc": 0.8094339370727539, "length": 3.9999330043792725, "mode": "train", "epoch": 23}
{"loss": 0.4304848313331604, "acc": 0.8004883527755737, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.4080725312232971, "acc": 0.8109242916107178, "length": 3.99977970123291, "mode": "train", "epoch": 24}
{"loss": 0.41791832447052, "acc": 0.8083983063697815, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.40425872802734375, "acc": 0.8168191313743591, "length": 3.999781608581543, "mode": "train", "epoch": 25}
{"loss": 0.41610753536224365, "acc": 0.81396484375, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.39875733852386475, "acc": 0.8218268156051636, "length": 3.999718189239502, "mode": "train", "epoch": 26}
{"loss": 0.41773438453674316, "acc": 0.8134765028953552, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.39717498421669006, "acc": 0.8231257200241089, "length": 3.999613046646118, "mode": "train", "epoch": 27}
{"loss": 0.4157540798187256, "acc": 0.8140625953674316, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.3871100842952728, "acc": 0.8240935206413269, "length": 3.999541759490967, "mode": "train", "epoch": 28}
{"loss": 0.40037238597869873, "acc": 0.8225584626197815, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.3866701126098633, "acc": 0.8283888697624207, "length": 3.9999444484710693, "mode": "train", "epoch": 29}
{"loss": 0.3990953862667084, "acc": 0.8240233659744263, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.37742727994918823, "acc": 0.8278891444206238, "length": 3.9998724460601807, "mode": "train", "epoch": 30}
{"loss": 0.3947521448135376, "acc": 0.8245116472244263, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.37767383456230164, "acc": 0.8277238607406616, "length": 3.999849796295166, "mode": "train", "epoch": 31}
{"loss": 0.4088078737258911, "acc": 0.8288087248802185, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.37442830204963684, "acc": 0.8290402293205261, "length": 3.999140739440918, "mode": "train", "epoch": 32}
{"loss": 0.39206698536872864, "acc": 0.8269529938697815, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.3747400939464569, "acc": 0.8347355723381042, "length": 3.9990696907043457, "mode": "train", "epoch": 33}
{"loss": 0.3981627821922302, "acc": 0.8336914777755737, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.3806094229221344, "acc": 0.8336443305015564, "length": 3.999764919281006, "mode": "train", "epoch": 34}
{"loss": 0.37733250856399536, "acc": 0.8307618498802185, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.3678342401981354, "acc": 0.837090015411377, "length": 3.999375581741333, "mode": "train", "epoch": 35}
{"loss": 0.37887346744537354, "acc": 0.8345703482627869, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.35544490814208984, "acc": 0.8418871164321899, "length": 3.999495267868042, "mode": "train", "epoch": 36}
{"loss": 0.3831384778022766, "acc": 0.8333984017372131, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.352087140083313, "acc": 0.8396893739700317, "length": 3.998939037322998, "mode": "train", "epoch": 37}
{"loss": 0.37587839365005493, "acc": 0.8346680402755737, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.3537968099117279, "acc": 0.8416215777397156, "length": 3.998788833618164, "mode": "train", "epoch": 38}
{"loss": 0.3749014139175415, "acc": 0.8341797590255737, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.3616448640823364, "acc": 0.8416353464126587, "length": 3.998551607131958, "mode": "train", "epoch": 39}
{"loss": 0.37214717268943787, "acc": 0.8374022841453552, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.3602469265460968, "acc": 0.8423540592193604, "length": 3.999480724334717, "mode": "train", "epoch": 40}
{"loss": 0.37634140253067017, "acc": 0.8360352516174316, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.3519546091556549, "acc": 0.8421335220336914, "length": 3.9996705055236816, "mode": "train", "epoch": 41}
{"loss": 0.3685276508331299, "acc": 0.8375977277755737, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.3508378565311432, "acc": 0.8449455499649048, "length": 3.9991791248321533, "mode": "train", "epoch": 42}
{"loss": 0.3680444359779358, "acc": 0.8388672471046448, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.34468188881874084, "acc": 0.8458191752433777, "length": 3.999901056289673, "mode": "train", "epoch": 43}
{"loss": 0.3642057776451111, "acc": 0.8398438096046448, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.34234216809272766, "acc": 0.845670223236084, "length": 3.99932599067688, "mode": "train", "epoch": 44}
{"loss": 0.3618682622909546, "acc": 0.8420897126197815, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.3416839838027954, "acc": 0.8453948497772217, "length": 3.999208688735962, "mode": "train", "epoch": 45}
{"loss": 0.3628416657447815, "acc": 0.8427734971046448, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.3385010361671448, "acc": 0.8471202254295349, "length": 3.999866247177124, "mode": "train", "epoch": 46}
{"loss": 0.3565579652786255, "acc": 0.8425780534744263, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.34061765670776367, "acc": 0.850074052810669, "length": 3.999709129333496, "mode": "train", "epoch": 47}
{"loss": 0.3495425581932068, "acc": 0.8419923186302185, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.33493560552597046, "acc": 0.8515466451644897, "length": 3.9999232292175293, "mode": "train", "epoch": 48}
{"loss": 0.36156460642814636, "acc": 0.8448243141174316, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.338954895734787, "acc": 0.8492743968963623, "length": 3.9998679161071777, "mode": "train", "epoch": 49}
{"loss": 0.35265758633613586, "acc": 0.8463867902755737, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.32678985595703125, "acc": 0.8547309041023254, "length": 3.9999852180480957, "mode": "train", "epoch": 50}
{"loss": 0.35250818729400635, "acc": 0.8456054925918579, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.33551841974258423, "acc": 0.8569957613945007, "length": 3.998565196990967, "mode": "train", "epoch": 51}
{"loss": 0.3459346294403076, "acc": 0.8529296517372131, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.3250051736831665, "acc": 0.8599163293838501, "length": 3.999669313430786, "mode": "train", "epoch": 52}
{"loss": 0.34117287397384644, "acc": 0.8562501668930054, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.3115474581718445, "acc": 0.8611499071121216, "length": 3.999953508377075, "mode": "train", "epoch": 53}
{"loss": 0.346349835395813, "acc": 0.8542967438697815, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.3205834627151489, "acc": 0.8633520007133484, "length": 3.9993700981140137, "mode": "train", "epoch": 54}
{"loss": 0.33010005950927734, "acc": 0.8589844107627869, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.3143840730190277, "acc": 0.8625304698944092, "length": 3.9999029636383057, "mode": "train", "epoch": 55}
{"loss": 0.34147709608078003, "acc": 0.8587890267372131, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.313361793756485, "acc": 0.8659651875495911, "length": 3.999988079071045, "mode": "train", "epoch": 56}
{"loss": 0.3292795717716217, "acc": 0.8600587248802185, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.30273205041885376, "acc": 0.8662974238395691, "length": 3.9999918937683105, "mode": "train", "epoch": 57}
{"loss": 0.3448191285133362, "acc": 0.8595704436302185, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.3028891682624817, "acc": 0.8648250699043274, "length": 3.999758243560791, "mode": "train", "epoch": 58}
{"loss": 0.33110809326171875, "acc": 0.8604491949081421, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.30041125416755676, "acc": 0.868676483631134, "length": 3.9999749660491943, "mode": "train", "epoch": 59}
{"loss": 0.32689154148101807, "acc": 0.8641600012779236, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.297963410615921, "acc": 0.8698047399520874, "length": 3.9998350143432617, "mode": "train", "epoch": 60}
{"loss": 0.3303152620792389, "acc": 0.8577147722244263, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8621186017990112
