# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.670965313911438, "acc": 0.6177322268486023, "length": 3.5032901763916016, "mode": "train", "epoch": 1}
{"loss": 0.6667195558547974, "acc": 0.6201171278953552, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6591969728469849, "acc": 0.6288008093833923, "length": 3.2483861446380615, "mode": "train", "epoch": 2}
{"loss": 0.6671937704086304, "acc": 0.6187500357627869, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.655523419380188, "acc": 0.6310680508613586, "length": 2.8461568355560303, "mode": "train", "epoch": 3}
{"loss": 0.6520732045173645, "acc": 0.6289185285568237, "length": 3.1953125, "mode": "test", "epoch": 3}
{"loss": 0.6427765488624573, "acc": 0.6474184393882751, "length": 3.3197519779205322, "mode": "train", "epoch": 4}
{"loss": 0.6410121321678162, "acc": 0.6494140625, "length": 3.9921875, "mode": "test", "epoch": 4}
{"loss": 0.6164932250976562, "acc": 0.6677134037017822, "length": 3.799464225769043, "mode": "train", "epoch": 5}
{"loss": 0.6360142230987549, "acc": 0.6566405892372131, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.5960267782211304, "acc": 0.678117036819458, "length": 3.901350259780884, "mode": "train", "epoch": 6}
{"loss": 0.6408653259277344, "acc": 0.6716795563697815, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.5789175033569336, "acc": 0.6947275400161743, "length": 3.9118404388427734, "mode": "train", "epoch": 7}
{"loss": 0.6201057434082031, "acc": 0.6861328482627869, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.5581015348434448, "acc": 0.7152188420295715, "length": 3.9216463565826416, "mode": "train", "epoch": 8}
{"loss": 0.5881578326225281, "acc": 0.6954711675643921, "length": 3.9921875, "mode": "test", "epoch": 8}
{"loss": 0.5353536009788513, "acc": 0.7315000295639038, "length": 3.943324327468872, "mode": "train", "epoch": 9}
{"loss": 0.5733010172843933, "acc": 0.7216797471046448, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.5162751078605652, "acc": 0.7407636642456055, "length": 3.9606292247772217, "mode": "train", "epoch": 10}
{"loss": 0.5682705640792847, "acc": 0.7054687142372131, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.49768176674842834, "acc": 0.7491825222969055, "length": 3.9654481410980225, "mode": "train", "epoch": 11}
{"loss": 0.5636481046676636, "acc": 0.7238280773162842, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.4805162847042084, "acc": 0.7661799788475037, "length": 3.9793589115142822, "mode": "train", "epoch": 12}
{"loss": 0.5631594061851501, "acc": 0.7132812142372131, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.46954014897346497, "acc": 0.7653710246086121, "length": 3.986565589904785, "mode": "train", "epoch": 13}
{"loss": 0.5481237173080444, "acc": 0.7320312857627869, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.45876601338386536, "acc": 0.7748522162437439, "length": 3.9896552562713623, "mode": "train", "epoch": 14}
{"loss": 0.5319318771362305, "acc": 0.7316405773162842, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.45322901010513306, "acc": 0.7842815518379211, "length": 3.9896464347839355, "mode": "train", "epoch": 15}
{"loss": 0.5419067144393921, "acc": 0.7335938215255737, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.44402575492858887, "acc": 0.7853856086730957, "length": 3.9891722202301025, "mode": "train", "epoch": 16}
{"loss": 0.5312642455101013, "acc": 0.7392578125, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.43398159742355347, "acc": 0.7884753942489624, "length": 3.993374824523926, "mode": "train", "epoch": 17}
{"loss": 0.5233056545257568, "acc": 0.7380858659744263, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.4280458986759186, "acc": 0.7940245270729065, "length": 3.9942939281463623, "mode": "train", "epoch": 18}
{"loss": 0.5334072709083557, "acc": 0.736328125, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.4248921573162079, "acc": 0.7951557040214539, "length": 3.996083974838257, "mode": "train", "epoch": 19}
{"loss": 0.5175950527191162, "acc": 0.7503905892372131, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.4172886908054352, "acc": 0.8005561828613281, "length": 3.997274398803711, "mode": "train", "epoch": 20}
{"loss": 0.5185841917991638, "acc": 0.7529296875, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.40745478868484497, "acc": 0.8053610920906067, "length": 3.997786045074463, "mode": "train", "epoch": 21}
{"loss": 0.5046132206916809, "acc": 0.7552734017372131, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.40943652391433716, "acc": 0.8050152063369751, "length": 3.9978621006011963, "mode": "train", "epoch": 22}
{"loss": 0.5132808685302734, "acc": 0.7566406726837158, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.40279871225357056, "acc": 0.8067741394042969, "length": 3.9980297088623047, "mode": "train", "epoch": 23}
{"loss": 0.503876268863678, "acc": 0.7708984613418579, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.4005199074745178, "acc": 0.8085758090019226, "length": 3.9969241619110107, "mode": "train", "epoch": 24}
{"loss": 0.5232376456260681, "acc": 0.76171875, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.3996509611606598, "acc": 0.8104651570320129, "length": 3.998539686203003, "mode": "train", "epoch": 25}
{"loss": 0.5033390522003174, "acc": 0.7654296159744263, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.38914427161216736, "acc": 0.8212250471115112, "length": 3.9978935718536377, "mode": "train", "epoch": 26}
{"loss": 0.4845312237739563, "acc": 0.779296875, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.3824285864830017, "acc": 0.8243303298950195, "length": 3.9984118938446045, "mode": "train", "epoch": 27}
{"loss": 0.48171091079711914, "acc": 0.7787109017372131, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.37807050347328186, "acc": 0.829900860786438, "length": 3.999138832092285, "mode": "train", "epoch": 28}
{"loss": 0.49055224657058716, "acc": 0.78515625, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.373185932636261, "acc": 0.8287925124168396, "length": 3.999188184738159, "mode": "train", "epoch": 29}
{"loss": 0.46540653705596924, "acc": 0.8003907203674316, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.3581557273864746, "acc": 0.8402084112167358, "length": 3.9989876747131348, "mode": "train", "epoch": 30}
{"loss": 0.4505458474159241, "acc": 0.8105468153953552, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.3490254580974579, "acc": 0.8461644649505615, "length": 3.998274087905884, "mode": "train", "epoch": 31}
{"loss": 0.4422733187675476, "acc": 0.814453125, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.3426457941532135, "acc": 0.8502748012542725, "length": 3.9990856647491455, "mode": "train", "epoch": 32}
{"loss": 0.431142657995224, "acc": 0.8199219107627869, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.33234310150146484, "acc": 0.8588370680809021, "length": 3.9997963905334473, "mode": "train", "epoch": 33}
{"loss": 0.4512873888015747, "acc": 0.8099609017372131, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.32706546783447266, "acc": 0.8601836562156677, "length": 3.999833822250366, "mode": "train", "epoch": 34}
{"loss": 0.4198622703552246, "acc": 0.8220701813697815, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.3164350092411041, "acc": 0.8711279034614563, "length": 3.9996814727783203, "mode": "train", "epoch": 35}
{"loss": 0.4082861542701721, "acc": 0.8320313096046448, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.3064427077770233, "acc": 0.8736512064933777, "length": 3.999891757965088, "mode": "train", "epoch": 36}
{"loss": 0.39693665504455566, "acc": 0.8376952409744263, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.29740437865257263, "acc": 0.8812040686607361, "length": 3.999919891357422, "mode": "train", "epoch": 37}
{"loss": 0.415706992149353, "acc": 0.8347655534744263, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.2979251444339752, "acc": 0.8824918270111084, "length": 3.9998953342437744, "mode": "train", "epoch": 38}
{"loss": 0.3991621732711792, "acc": 0.8416014909744263, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.2926829755306244, "acc": 0.8843013644218445, "length": 3.9992048740386963, "mode": "train", "epoch": 39}
{"loss": 0.38776344060897827, "acc": 0.8439453840255737, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.28134360909461975, "acc": 0.8939095139503479, "length": 3.9999499320983887, "mode": "train", "epoch": 40}
{"loss": 0.3612323999404907, "acc": 0.8560547232627869, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.27903667092323303, "acc": 0.892036497592926, "length": 3.9999659061431885, "mode": "train", "epoch": 41}
{"loss": 0.3628622889518738, "acc": 0.8556641340255737, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.2793880105018616, "acc": 0.8962990045547485, "length": 3.9996609687805176, "mode": "train", "epoch": 42}
{"loss": 0.36787039041519165, "acc": 0.8519530892372131, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.271638959646225, "acc": 0.8961879014968872, "length": 3.9998605251312256, "mode": "train", "epoch": 43}
{"loss": 0.356810986995697, "acc": 0.8609375357627869, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.2667446434497833, "acc": 0.8994088172912598, "length": 3.9998421669006348, "mode": "train", "epoch": 44}
{"loss": 0.34454283118247986, "acc": 0.8650389313697815, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.26131975650787354, "acc": 0.90092533826828, "length": 3.999804973602295, "mode": "train", "epoch": 45}
{"loss": 0.3657805919647217, "acc": 0.857421875, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.26394200325012207, "acc": 0.9022244811058044, "length": 3.999990940093994, "mode": "train", "epoch": 46}
{"loss": 0.36346232891082764, "acc": 0.8650389909744263, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.2594977021217346, "acc": 0.9029793739318848, "length": 3.999842882156372, "mode": "train", "epoch": 47}
{"loss": 0.3704875111579895, "acc": 0.8630858063697815, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.2488323599100113, "acc": 0.9091330766677856, "length": 3.9999845027923584, "mode": "train", "epoch": 48}
{"loss": 0.35309404134750366, "acc": 0.8677734732627869, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.25189435482025146, "acc": 0.9074933528900146, "length": 3.9999582767486572, "mode": "train", "epoch": 49}
{"loss": 0.3389506936073303, "acc": 0.87109375, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.2414519041776657, "acc": 0.910010576248169, "length": 3.9999709129333496, "mode": "train", "epoch": 50}
{"loss": 0.347285658121109, "acc": 0.87109375, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.243205264210701, "acc": 0.9103493094444275, "length": 3.9997098445892334, "mode": "train", "epoch": 51}
{"loss": 0.3411388397216797, "acc": 0.8714843392372131, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.24767445027828217, "acc": 0.910831093788147, "length": 3.9999923706054688, "mode": "train", "epoch": 52}
{"loss": 0.3370332419872284, "acc": 0.8746094107627869, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.23659823834896088, "acc": 0.9117094874382019, "length": 3.9999988079071045, "mode": "train", "epoch": 53}
{"loss": 0.3442562222480774, "acc": 0.8746094107627869, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.2343597561120987, "acc": 0.9152513146400452, "length": 3.9993770122528076, "mode": "train", "epoch": 54}
{"loss": 0.33100008964538574, "acc": 0.8798828125, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.24030598998069763, "acc": 0.9121770858764648, "length": 3.9999701976776123, "mode": "train", "epoch": 55}
{"loss": 0.3707423806190491, "acc": 0.8732422590255737, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.24093113839626312, "acc": 0.9105381369590759, "length": 3.99997878074646, "mode": "train", "epoch": 56}
{"loss": 0.35825127363204956, "acc": 0.8705077767372131, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.24051615595817566, "acc": 0.9122947454452515, "length": 3.9999895095825195, "mode": "train", "epoch": 57}
{"loss": 0.3241957426071167, "acc": 0.8824218511581421, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.23147262632846832, "acc": 0.915921151638031, "length": 3.999891996383667, "mode": "train", "epoch": 58}
{"loss": 0.3464793562889099, "acc": 0.876953125, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.23053036630153656, "acc": 0.916451632976532, "length": 3.9999897480010986, "mode": "train", "epoch": 59}
{"loss": 0.32783055305480957, "acc": 0.8828124403953552, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.22752998769283295, "acc": 0.9200224876403809, "length": 3.9999754428863525, "mode": "train", "epoch": 60}
{"loss": 0.3342411518096924, "acc": 0.8832030892372131, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7828332781791687
