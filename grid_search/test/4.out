# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6716997623443604, "acc": 0.6121389269828796, "length": 3.210921049118042, "mode": "train", "epoch": 1}
{"loss": 0.6631447672843933, "acc": 0.6253471970558167, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6588400602340698, "acc": 0.6249828934669495, "length": 1.970490574836731, "mode": "train", "epoch": 2}
{"loss": 0.6611817479133606, "acc": 0.6253471970558167, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6388763785362244, "acc": 0.6485263109207153, "length": 2.363375186920166, "mode": "train", "epoch": 3}
{"loss": 0.6301408410072327, "acc": 0.6644694209098816, "length": 2.1145832538604736, "mode": "test", "epoch": 3}
{"loss": 0.5986624360084534, "acc": 0.6914970874786377, "length": 2.5815610885620117, "mode": "train", "epoch": 4}
{"loss": 0.618179976940155, "acc": 0.6755914092063904, "length": 3.0, "mode": "test", "epoch": 4}
{"loss": 0.5661994814872742, "acc": 0.7100978493690491, "length": 3.2081515789031982, "mode": "train", "epoch": 5}
{"loss": 0.6093907952308655, "acc": 0.6842339634895325, "length": 3.46875, "mode": "test", "epoch": 5}
{"loss": 0.5521091818809509, "acc": 0.7151435613632202, "length": 3.3913047313690186, "mode": "train", "epoch": 6}
{"loss": 0.6122329235076904, "acc": 0.6733725070953369, "length": 3.1770832538604736, "mode": "test", "epoch": 6}
{"loss": 0.5366815328598022, "acc": 0.7291401624679565, "length": 3.414602279663086, "mode": "train", "epoch": 7}
{"loss": 0.5967159271240234, "acc": 0.6931097507476807, "length": 3.5520832538604736, "mode": "test", "epoch": 7}
{"loss": 0.514855682849884, "acc": 0.7427836060523987, "length": 3.598627805709839, "mode": "train", "epoch": 8}
{"loss": 0.5577606558799744, "acc": 0.7168130278587341, "length": 3.7916667461395264, "mode": "test", "epoch": 8}
{"loss": 0.49411827325820923, "acc": 0.7616254091262817, "length": 3.747992753982544, "mode": "train", "epoch": 9}
{"loss": 0.5409292578697205, "acc": 0.7357639670372009, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.461351603269577, "acc": 0.7878983020782471, "length": 3.8736042976379395, "mode": "train", "epoch": 10}
{"loss": 0.5243728160858154, "acc": 0.7557942271232605, "length": 3.9861111640930176, "mode": "test", "epoch": 10}
{"loss": 0.4420499801635742, "acc": 0.7994744181632996, "length": 3.866881847381592, "mode": "train", "epoch": 11}
{"loss": 0.498137891292572, "acc": 0.7749999761581421, "length": 3.9375, "mode": "test", "epoch": 11}
{"loss": 0.43340003490448, "acc": 0.8048218488693237, "length": 3.8894519805908203, "mode": "train", "epoch": 12}
{"loss": 0.5272587537765503, "acc": 0.757893979549408, "length": 3.9479167461395264, "mode": "test", "epoch": 12}
{"loss": 0.4268362522125244, "acc": 0.810798168182373, "length": 3.8818392753601074, "mode": "train", "epoch": 13}
{"loss": 0.5046738982200623, "acc": 0.768419086933136, "length": 3.9201388359069824, "mode": "test", "epoch": 13}
{"loss": 0.4126916229724884, "acc": 0.8159322142601013, "length": 3.8904683589935303, "mode": "train", "epoch": 14}
{"loss": 0.48080968856811523, "acc": 0.7931857705116272, "length": 3.8958332538604736, "mode": "test", "epoch": 14}
{"loss": 0.4066702425479889, "acc": 0.8173753619194031, "length": 3.8984620571136475, "mode": "train", "epoch": 15}
{"loss": 0.47252899408340454, "acc": 0.7948350310325623, "length": 3.9270832538604736, "mode": "test", "epoch": 15}
{"loss": 0.39722129702568054, "acc": 0.8253180384635925, "length": 3.9007277488708496, "mode": "train", "epoch": 16}
{"loss": 0.47661134600639343, "acc": 0.7976725697517395, "length": 3.9583332538604736, "mode": "test", "epoch": 16}
{"loss": 0.3887674808502197, "acc": 0.8288188576698303, "length": 3.9086663722991943, "mode": "train", "epoch": 17}
{"loss": 0.4759710133075714, "acc": 0.79345703125, "length": 3.9270832538604736, "mode": "test", "epoch": 17}
{"loss": 0.3850879967212677, "acc": 0.8316783308982849, "length": 3.9299163818359375, "mode": "train", "epoch": 18}
{"loss": 0.45790937542915344, "acc": 0.8046169877052307, "length": 3.8854167461395264, "mode": "test", "epoch": 18}
{"loss": 0.37655773758888245, "acc": 0.8335986137390137, "length": 3.9267289638519287, "mode": "train", "epoch": 19}
{"loss": 0.45210689306259155, "acc": 0.8028048276901245, "length": 3.934027671813965, "mode": "test", "epoch": 19}
{"loss": 0.3697410523891449, "acc": 0.8390831351280212, "length": 3.9180216789245605, "mode": "train", "epoch": 20}
{"loss": 0.45155566930770874, "acc": 0.8051485419273376, "length": 3.965277671813965, "mode": "test", "epoch": 20}
{"loss": 0.3664383590221405, "acc": 0.8412580490112305, "length": 3.918872833251953, "mode": "train", "epoch": 21}
{"loss": 0.44173070788383484, "acc": 0.8032824397087097, "length": 3.930555582046509, "mode": "test", "epoch": 21}
{"loss": 0.3547605574131012, "acc": 0.8474973440170288, "length": 3.9457223415374756, "mode": "train", "epoch": 22}
{"loss": 0.4460056722164154, "acc": 0.8063747882843018, "length": 3.913194417953491, "mode": "test", "epoch": 22}
{"loss": 0.3526022136211395, "acc": 0.8482348918914795, "length": 3.927403211593628, "mode": "train", "epoch": 23}
{"loss": 0.4520763158798218, "acc": 0.8042046427726746, "length": 3.9479167461395264, "mode": "test", "epoch": 23}
{"loss": 0.3477204740047455, "acc": 0.8507537245750427, "length": 3.9390246868133545, "mode": "train", "epoch": 24}
{"loss": 0.45493459701538086, "acc": 0.8087348341941833, "length": 3.9236111640930176, "mode": "test", "epoch": 24}
{"loss": 0.337899774312973, "acc": 0.8585564494132996, "length": 3.9231960773468018, "mode": "train", "epoch": 25}
{"loss": 0.41281288862228394, "acc": 0.8242729902267456, "length": 3.9583332538604736, "mode": "test", "epoch": 25}
{"loss": 0.33241236209869385, "acc": 0.8608161807060242, "length": 3.957507848739624, "mode": "train", "epoch": 26}
{"loss": 0.42889466881752014, "acc": 0.8226128220558167, "length": 3.913194417953491, "mode": "test", "epoch": 26}
{"loss": 0.3170336186885834, "acc": 0.8685537576675415, "length": 3.9409992694854736, "mode": "train", "epoch": 27}
{"loss": 0.4162479639053345, "acc": 0.8288303017616272, "length": 3.9375, "mode": "test", "epoch": 27}
{"loss": 0.3118849992752075, "acc": 0.872114896774292, "length": 3.9430630207061768, "mode": "train", "epoch": 28}
{"loss": 0.41385552287101746, "acc": 0.8338921666145325, "length": 3.96875, "mode": "test", "epoch": 28}
{"loss": 0.30368849635124207, "acc": 0.8740580081939697, "length": 3.9528069496154785, "mode": "train", "epoch": 29}
{"loss": 0.4081517457962036, "acc": 0.8336317539215088, "length": 3.9375, "mode": "test", "epoch": 29}
{"loss": 0.30013373494148254, "acc": 0.8789717555046082, "length": 3.944354295730591, "mode": "train", "epoch": 30}
{"loss": 0.41097861528396606, "acc": 0.8409179449081421, "length": 3.965277671813965, "mode": "test", "epoch": 30}
{"loss": 0.2942706048488617, "acc": 0.880725622177124, "length": 3.9333832263946533, "mode": "train", "epoch": 31}
{"loss": 0.3935922682285309, "acc": 0.843370258808136, "length": 3.940972328186035, "mode": "test", "epoch": 31}
{"loss": 0.28504258394241333, "acc": 0.883101761341095, "length": 3.9445607662200928, "mode": "train", "epoch": 32}
{"loss": 0.3961535692214966, "acc": 0.8413249254226685, "length": 3.9513888359069824, "mode": "test", "epoch": 32}
{"loss": 0.2819782495498657, "acc": 0.8884284496307373, "length": 3.9480903148651123, "mode": "train", "epoch": 33}
{"loss": 0.3904585838317871, "acc": 0.8485568165779114, "length": 3.975694417953491, "mode": "test", "epoch": 33}
{"loss": 0.2711554169654846, "acc": 0.889262855052948, "length": 3.9313108921051025, "mode": "train", "epoch": 34}
{"loss": 0.38308072090148926, "acc": 0.8475478291511536, "length": 3.9826388359069824, "mode": "test", "epoch": 34}
{"loss": 0.26735571026802063, "acc": 0.8917638063430786, "length": 3.9728798866271973, "mode": "train", "epoch": 35}
{"loss": 0.3932160437107086, "acc": 0.8526421189308167, "length": 3.975694417953491, "mode": "test", "epoch": 35}
{"loss": 0.2693738341331482, "acc": 0.8915209174156189, "length": 3.9343137741088867, "mode": "train", "epoch": 36}
{"loss": 0.39382922649383545, "acc": 0.8500922322273254, "length": 3.9583332538604736, "mode": "test", "epoch": 36}
{"loss": 0.26742812991142273, "acc": 0.894383430480957, "length": 3.950740337371826, "mode": "train", "epoch": 37}
{"loss": 0.3738738000392914, "acc": 0.8639267683029175, "length": 3.9791667461395264, "mode": "test", "epoch": 37}
{"loss": 0.25764891505241394, "acc": 0.897089421749115, "length": 3.9577512741088867, "mode": "train", "epoch": 38}
{"loss": 0.3620191812515259, "acc": 0.8605251312255859, "length": 3.9583332538604736, "mode": "test", "epoch": 38}
{"loss": 0.25352537631988525, "acc": 0.9011609554290771, "length": 3.9584567546844482, "mode": "train", "epoch": 39}
{"loss": 0.3778802454471588, "acc": 0.8562989234924316, "length": 3.930555582046509, "mode": "test", "epoch": 39}
{"loss": 0.2610248923301697, "acc": 0.8980677723884583, "length": 3.949134111404419, "mode": "train", "epoch": 40}
{"loss": 0.38866904377937317, "acc": 0.8572481274604797, "length": 3.9861111640930176, "mode": "test", "epoch": 40}
{"loss": 0.2604112923145294, "acc": 0.8978262543678284, "length": 3.977936029434204, "mode": "train", "epoch": 41}
{"loss": 0.39397525787353516, "acc": 0.8563421964645386, "length": 3.961805582046509, "mode": "test", "epoch": 41}
{"loss": 0.25475460290908813, "acc": 0.8994926810264587, "length": 3.93847393989563, "mode": "train", "epoch": 42}
{"loss": 0.3854650855064392, "acc": 0.8587239384651184, "length": 3.940972328186035, "mode": "test", "epoch": 42}
{"loss": 0.2500166594982147, "acc": 0.9011727571487427, "length": 3.9366276264190674, "mode": "train", "epoch": 43}
{"loss": 0.38643261790275574, "acc": 0.8563639521598816, "length": 3.975694417953491, "mode": "test", "epoch": 43}
{"loss": 0.24130995571613312, "acc": 0.904349684715271, "length": 3.9512925148010254, "mode": "train", "epoch": 44}
{"loss": 0.3900090754032135, "acc": 0.8606064915657043, "length": 3.9861111640930176, "mode": "test", "epoch": 44}
{"loss": 0.24866478145122528, "acc": 0.9017466902732849, "length": 3.9662976264953613, "mode": "train", "epoch": 45}
{"loss": 0.3883191645145416, "acc": 0.8553873896598816, "length": 3.96875, "mode": "test", "epoch": 45}
{"loss": 0.2575766146183014, "acc": 0.9012563228607178, "length": 3.953439950942993, "mode": "train", "epoch": 46}
{"loss": 0.38832977414131165, "acc": 0.8661783933639526, "length": 3.975694417953491, "mode": "test", "epoch": 46}
{"loss": 0.2351674735546112, "acc": 0.908133327960968, "length": 3.954122543334961, "mode": "train", "epoch": 47}
{"loss": 0.361234575510025, "acc": 0.8644965887069702, "length": 3.961805582046509, "mode": "test", "epoch": 47}
{"loss": 0.23286040127277374, "acc": 0.9087538123130798, "length": 3.9644062519073486, "mode": "train", "epoch": 48}
{"loss": 0.3532824218273163, "acc": 0.8714573383331299, "length": 3.9861111640930176, "mode": "test", "epoch": 48}
{"loss": 0.2325766384601593, "acc": 0.9102038145065308, "length": 3.966370105743408, "mode": "train", "epoch": 49}
{"loss": 0.3928171396255493, "acc": 0.8621745705604553, "length": 3.972222328186035, "mode": "test", "epoch": 49}
{"loss": 0.23220477998256683, "acc": 0.9103931188583374, "length": 3.9738922119140625, "mode": "train", "epoch": 50}
{"loss": 0.3622353672981262, "acc": 0.8690103888511658, "length": 3.972222328186035, "mode": "test", "epoch": 50}
{"loss": 0.22453276813030243, "acc": 0.9133344888687134, "length": 3.964625358581543, "mode": "train", "epoch": 51}
{"loss": 0.38713425397872925, "acc": 0.8691244125366211, "length": 3.9583332538604736, "mode": "test", "epoch": 51}
{"loss": 0.23251602053642273, "acc": 0.9093173146247864, "length": 3.987421989440918, "mode": "train", "epoch": 52}
{"loss": 0.3611494302749634, "acc": 0.8717663884162903, "length": 3.993055582046509, "mode": "test", "epoch": 52}
{"loss": 0.22449466586112976, "acc": 0.9134455919265747, "length": 3.984954595565796, "mode": "train", "epoch": 53}
{"loss": 0.3760579526424408, "acc": 0.8715495467185974, "length": 3.9826388359069824, "mode": "test", "epoch": 53}
{"loss": 0.225372776389122, "acc": 0.9140476584434509, "length": 3.974156141281128, "mode": "train", "epoch": 54}
{"loss": 0.3831920325756073, "acc": 0.8613227009773254, "length": 3.975694417953491, "mode": "test", "epoch": 54}
{"loss": 0.24142694473266602, "acc": 0.9051451086997986, "length": 3.9727706909179688, "mode": "train", "epoch": 55}
{"loss": 0.38293784856796265, "acc": 0.8617188930511475, "length": 3.9895832538604736, "mode": "test", "epoch": 55}
{"loss": 0.24169427156448364, "acc": 0.9057862758636475, "length": 3.9660861492156982, "mode": "train", "epoch": 56}
{"loss": 0.3989059031009674, "acc": 0.8649305701255798, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.2287834882736206, "acc": 0.9132188558578491, "length": 3.9819610118865967, "mode": "train", "epoch": 57}
{"loss": 0.38301098346710205, "acc": 0.8715603351593018, "length": 3.972222328186035, "mode": "test", "epoch": 57}
{"loss": 0.22554396092891693, "acc": 0.9130847454071045, "length": 3.9666686058044434, "mode": "train", "epoch": 58}
{"loss": 0.3751009404659271, "acc": 0.8671658039093018, "length": 3.975694417953491, "mode": "test", "epoch": 58}
{"loss": 0.22458522021770477, "acc": 0.9111554026603699, "length": 3.976940393447876, "mode": "train", "epoch": 59}
{"loss": 0.3829798698425293, "acc": 0.8561143279075623, "length": 3.9895832538604736, "mode": "test", "epoch": 59}
{"loss": 0.22187121212482452, "acc": 0.9124718308448792, "length": 3.976947784423828, "mode": "train", "epoch": 60}
{"loss": 0.4100370705127716, "acc": 0.8578884601593018, "length": 3.965277671813965, "mode": "test", "epoch": 60}
test accuracy: 0.7610237002372742
