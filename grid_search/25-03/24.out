# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.0005", "--hidden_size=128", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6933064460754395, "acc": 0.5079516768455505, "length": 3.6104846000671387, "mode": "train", "epoch": 1}
{"loss": 0.6900420784950256, "acc": 0.5447021126747131, "length": 1.4392361640930176, "mode": "test", "epoch": 1}
{"loss": 0.6839695572853088, "acc": 0.5637004971504211, "length": 3.144207000732422, "mode": "train", "epoch": 2}
{"loss": 0.6638501286506653, "acc": 0.6390759944915771, "length": 2.9375, "mode": "test", "epoch": 2}
{"loss": 0.6280604004859924, "acc": 0.6484796404838562, "length": 3.001242160797119, "mode": "train", "epoch": 3}
{"loss": 0.6192381978034973, "acc": 0.6481607556343079, "length": 3.038194417953491, "mode": "test", "epoch": 3}
{"loss": 0.5961136221885681, "acc": 0.66995769739151, "length": 3.554185152053833, "mode": "train", "epoch": 4}
{"loss": 0.5906682014465332, "acc": 0.6920735836029053, "length": 3.862847328186035, "mode": "test", "epoch": 4}
{"loss": 0.5768534541130066, "acc": 0.6890426874160767, "length": 3.722538709640503, "mode": "train", "epoch": 5}
{"loss": 0.58986496925354, "acc": 0.6931097507476807, "length": 3.803819417953491, "mode": "test", "epoch": 5}
{"loss": 0.5651488900184631, "acc": 0.6989198327064514, "length": 3.795025110244751, "mode": "train", "epoch": 6}
{"loss": 0.5770372152328491, "acc": 0.6880506277084351, "length": 3.809027671813965, "mode": "test", "epoch": 6}
{"loss": 0.5561979413032532, "acc": 0.7080423831939697, "length": 3.772653341293335, "mode": "train", "epoch": 7}
{"loss": 0.563194990158081, "acc": 0.6942572593688965, "length": 3.8420138359069824, "mode": "test", "epoch": 7}
{"loss": 0.5450437068939209, "acc": 0.7219270467758179, "length": 3.7892799377441406, "mode": "train", "epoch": 8}
{"loss": 0.5512039661407471, "acc": 0.7131427526473999, "length": 3.831597328186035, "mode": "test", "epoch": 8}
{"loss": 0.5299855470657349, "acc": 0.7318977117538452, "length": 3.820033550262451, "mode": "train", "epoch": 9}
{"loss": 0.5394985675811768, "acc": 0.7272258400917053, "length": 3.850694417953491, "mode": "test", "epoch": 9}
{"loss": 0.5122688412666321, "acc": 0.7470155358314514, "length": 3.848198413848877, "mode": "train", "epoch": 10}
{"loss": 0.5222954154014587, "acc": 0.7402981519699097, "length": 3.836805582046509, "mode": "test", "epoch": 10}
{"loss": 0.49691104888916016, "acc": 0.751109778881073, "length": 3.8450441360473633, "mode": "train", "epoch": 11}
{"loss": 0.5026950240135193, "acc": 0.7525742650032043, "length": 3.8177082538604736, "mode": "test", "epoch": 11}
{"loss": 0.4778258204460144, "acc": 0.7634716033935547, "length": 3.8425707817077637, "mode": "train", "epoch": 12}
{"loss": 0.48871925473213196, "acc": 0.7625107765197754, "length": 3.953125, "mode": "test", "epoch": 12}
{"loss": 0.4645628035068512, "acc": 0.7701417207717896, "length": 3.858513116836548, "mode": "train", "epoch": 13}
{"loss": 0.46786826848983765, "acc": 0.7747218608856201, "length": 3.871527671813965, "mode": "test", "epoch": 13}
{"loss": 0.4515834152698517, "acc": 0.7830789685249329, "length": 3.855114459991455, "mode": "train", "epoch": 14}
{"loss": 0.45092758536338806, "acc": 0.7910088300704956, "length": 3.868055582046509, "mode": "test", "epoch": 14}
{"loss": 0.4390381872653961, "acc": 0.794384777545929, "length": 3.8873889446258545, "mode": "train", "epoch": 15}
{"loss": 0.43263983726501465, "acc": 0.800206184387207, "length": 3.881944417953491, "mode": "test", "epoch": 15}
{"loss": 0.4226096570491791, "acc": 0.8005787134170532, "length": 3.887800693511963, "mode": "train", "epoch": 16}
{"loss": 0.4197789430618286, "acc": 0.8098429441452026, "length": 3.9513888359069824, "mode": "test", "epoch": 16}
{"loss": 0.40931040048599243, "acc": 0.8105289340019226, "length": 3.89877986907959, "mode": "train", "epoch": 17}
{"loss": 0.4164978265762329, "acc": 0.8138781189918518, "length": 3.9322917461395264, "mode": "test", "epoch": 17}
{"loss": 0.40347355604171753, "acc": 0.8131039142608643, "length": 3.9469354152679443, "mode": "train", "epoch": 18}
{"loss": 0.40571364760398865, "acc": 0.8202243447303772, "length": 3.9861111640930176, "mode": "test", "epoch": 18}
{"loss": 0.3984874486923218, "acc": 0.8146891593933105, "length": 3.9703245162963867, "mode": "train", "epoch": 19}
{"loss": 0.4039585292339325, "acc": 0.8187555074691772, "length": 3.9982638359069824, "mode": "test", "epoch": 19}
{"loss": 0.3989330530166626, "acc": 0.8152642250061035, "length": 3.988311290740967, "mode": "train", "epoch": 20}
{"loss": 0.3995267450809479, "acc": 0.8197047710418701, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.3962523937225342, "acc": 0.8163637518882751, "length": 3.994356632232666, "mode": "train", "epoch": 21}
{"loss": 0.40400779247283936, "acc": 0.8179686069488525, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.39484861493110657, "acc": 0.8182336688041687, "length": 3.9973201751708984, "mode": "train", "epoch": 22}
{"loss": 0.3991600275039673, "acc": 0.8239583969116211, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.3940580189228058, "acc": 0.8160141110420227, "length": 3.994422197341919, "mode": "train", "epoch": 23}
{"loss": 0.4018997848033905, "acc": 0.8217014074325562, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.4083613455295563, "acc": 0.8085976839065552, "length": 3.999030351638794, "mode": "train", "epoch": 24}
{"loss": 0.4073690176010132, "acc": 0.8131077289581299, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.39854660630226135, "acc": 0.8128060698509216, "length": 3.9994444847106934, "mode": "train", "epoch": 25}
{"loss": 0.40264084935188293, "acc": 0.8172743320465088, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.39613473415374756, "acc": 0.8150995969772339, "length": 3.9987196922302246, "mode": "train", "epoch": 26}
{"loss": 0.4003346264362335, "acc": 0.8135417699813843, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.39289259910583496, "acc": 0.8203341364860535, "length": 3.9993114471435547, "mode": "train", "epoch": 27}
{"loss": 0.39388716220855713, "acc": 0.824305534362793, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.38226553797721863, "acc": 0.8250670433044434, "length": 3.9997289180755615, "mode": "train", "epoch": 28}
{"loss": 0.39815905690193176, "acc": 0.8232638835906982, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.399473637342453, "acc": 0.8191752433776855, "length": 3.999969244003296, "mode": "train", "epoch": 29}
{"loss": 0.40592458844184875, "acc": 0.8147571086883545, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.391047865152359, "acc": 0.8236774802207947, "length": 3.9996604919433594, "mode": "train", "epoch": 30}
{"loss": 0.4034940302371979, "acc": 0.8256076574325562, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.38300013542175293, "acc": 0.8248315453529358, "length": 3.998863935470581, "mode": "train", "epoch": 31}
{"loss": 0.3944712281227112, "acc": 0.824826180934906, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.3806949257850647, "acc": 0.8281019926071167, "length": 3.9990780353546143, "mode": "train", "epoch": 32}
{"loss": 0.38895589113235474, "acc": 0.8308157324790955, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.37946248054504395, "acc": 0.8276568055152893, "length": 3.99802303314209, "mode": "train", "epoch": 33}
{"loss": 0.38954317569732666, "acc": 0.8226563334465027, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.3786162734031677, "acc": 0.8274339437484741, "length": 3.99912428855896, "mode": "train", "epoch": 34}
{"loss": 0.38861027359962463, "acc": 0.8267360925674438, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.3804381787776947, "acc": 0.8288211226463318, "length": 3.999211072921753, "mode": "train", "epoch": 35}
{"loss": 0.39470788836479187, "acc": 0.8214409351348877, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.3772940933704376, "acc": 0.8251798152923584, "length": 3.99998140335083, "mode": "train", "epoch": 36}
{"loss": 0.394207239151001, "acc": 0.8230035305023193, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.3764458894729614, "acc": 0.8307892680168152, "length": 3.9993762969970703, "mode": "train", "epoch": 37}
{"loss": 0.3873240351676941, "acc": 0.8255207538604736, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.37667688727378845, "acc": 0.8308245539665222, "length": 3.9997129440307617, "mode": "train", "epoch": 38}
{"loss": 0.3875603973865509, "acc": 0.8302083015441895, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.37184879183769226, "acc": 0.8330913782119751, "length": 3.9999029636383057, "mode": "train", "epoch": 39}
{"loss": 0.39054691791534424, "acc": 0.8236110210418701, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.3732015788555145, "acc": 0.8319584727287292, "length": 3.9997854232788086, "mode": "train", "epoch": 40}
{"loss": 0.3817635774612427, "acc": 0.831163227558136, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.37272968888282776, "acc": 0.8367651700973511, "length": 3.9996073246002197, "mode": "train", "epoch": 41}
{"loss": 0.3824637234210968, "acc": 0.8309028148651123, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.36665499210357666, "acc": 0.8402839303016663, "length": 3.9998350143432617, "mode": "train", "epoch": 42}
{"loss": 0.3766637444496155, "acc": 0.8389756679534912, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.36096543073654175, "acc": 0.8420997858047485, "length": 3.999114751815796, "mode": "train", "epoch": 43}
{"loss": 0.3735644519329071, "acc": 0.8374999165534973, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.3599223792552948, "acc": 0.8426123261451721, "length": 3.997299909591675, "mode": "train", "epoch": 44}
{"loss": 0.3726033568382263, "acc": 0.8407118320465088, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.3521902859210968, "acc": 0.846504807472229, "length": 3.9996092319488525, "mode": "train", "epoch": 45}
{"loss": 0.3703971207141876, "acc": 0.8427082896232605, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.3524147570133209, "acc": 0.8430545330047607, "length": 3.9999732971191406, "mode": "train", "epoch": 46}
{"loss": 0.3709186315536499, "acc": 0.8347222805023193, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.35088008642196655, "acc": 0.844852089881897, "length": 3.999206066131592, "mode": "train", "epoch": 47}
{"loss": 0.3630431890487671, "acc": 0.8463541269302368, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.34581857919692993, "acc": 0.8480077981948853, "length": 3.9999992847442627, "mode": "train", "epoch": 48}
{"loss": 0.3614155054092407, "acc": 0.8423610925674438, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.3431973159313202, "acc": 0.8483395576477051, "length": 3.999985456466675, "mode": "train", "epoch": 49}
{"loss": 0.35673218965530396, "acc": 0.8440972566604614, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.3495352566242218, "acc": 0.8487547039985657, "length": 3.9999985694885254, "mode": "train", "epoch": 50}
{"loss": 0.36088284850120544, "acc": 0.8448784351348877, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.3405405580997467, "acc": 0.851288378238678, "length": 3.9972095489501953, "mode": "train", "epoch": 51}
{"loss": 0.35047048330307007, "acc": 0.8480034470558167, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.33445093035697937, "acc": 0.8516550064086914, "length": 3.9996840953826904, "mode": "train", "epoch": 52}
{"loss": 0.34640973806381226, "acc": 0.8496526479721069, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.3296680152416229, "acc": 0.8540121912956238, "length": 3.9999966621398926, "mode": "train", "epoch": 53}
{"loss": 0.34753066301345825, "acc": 0.8510415554046631, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.3304608464241028, "acc": 0.8534579277038574, "length": 3.9999771118164062, "mode": "train", "epoch": 54}
{"loss": 0.35318708419799805, "acc": 0.8473089933395386, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.3256172239780426, "acc": 0.8569998145103455, "length": 3.9999756813049316, "mode": "train", "epoch": 55}
{"loss": 0.3385717272758484, "acc": 0.8559895753860474, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.32493311166763306, "acc": 0.855084240436554, "length": 3.999778985977173, "mode": "train", "epoch": 56}
{"loss": 0.3396546244621277, "acc": 0.8526908755302429, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.3266773223876953, "acc": 0.856368362903595, "length": 3.998499870300293, "mode": "train", "epoch": 57}
{"loss": 0.33978813886642456, "acc": 0.8543403148651123, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.3187847435474396, "acc": 0.8565883636474609, "length": 3.9982542991638184, "mode": "train", "epoch": 58}
{"loss": 0.33243122696876526, "acc": 0.8549478650093079, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.3181747794151306, "acc": 0.85959392786026, "length": 3.999438524246216, "mode": "train", "epoch": 59}
{"loss": 0.33146682381629944, "acc": 0.8555555939674377, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.3197084367275238, "acc": 0.8596264123916626, "length": 3.999920129776001, "mode": "train", "epoch": 60}
{"loss": 0.3353002667427063, "acc": 0.8548610210418701, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8344067335128784
