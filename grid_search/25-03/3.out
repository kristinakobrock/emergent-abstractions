# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.0005", "--hidden_size=128", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6926573514938354, "acc": 0.5105522871017456, "length": 3.5824432373046875, "mode": "train", "epoch": 1}
{"loss": 0.6807799339294434, "acc": 0.6198703646659851, "length": 3.625, "mode": "test", "epoch": 1}
{"loss": 0.6289013624191284, "acc": 0.6548027396202087, "length": 3.862658739089966, "mode": "train", "epoch": 2}
{"loss": 0.5874578952789307, "acc": 0.7040798664093018, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.537512481212616, "acc": 0.7295227646827698, "length": 3.9760849475860596, "mode": "train", "epoch": 3}
{"loss": 0.5430613160133362, "acc": 0.7184896469116211, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.4964943826198578, "acc": 0.7579793930053711, "length": 3.988016366958618, "mode": "train", "epoch": 4}
{"loss": 0.53175288438797, "acc": 0.7307291030883789, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.4761795401573181, "acc": 0.7738454937934875, "length": 3.993750810623169, "mode": "train", "epoch": 5}
{"loss": 0.5110857486724854, "acc": 0.7421006560325623, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.46052128076553345, "acc": 0.7849862575531006, "length": 3.994297742843628, "mode": "train", "epoch": 6}
{"loss": 0.4997459948062897, "acc": 0.7519963979721069, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.4434302747249603, "acc": 0.7953251600265503, "length": 3.997032880783081, "mode": "train", "epoch": 7}
{"loss": 0.46645939350128174, "acc": 0.7871527075767517, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.4335191249847412, "acc": 0.8017898797988892, "length": 3.9977822303771973, "mode": "train", "epoch": 8}
{"loss": 0.45081207156181335, "acc": 0.7957466244697571, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.4202606976032257, "acc": 0.8107189536094666, "length": 3.99888277053833, "mode": "train", "epoch": 9}
{"loss": 0.43285173177719116, "acc": 0.8081597089767456, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.41367626190185547, "acc": 0.8128811120986938, "length": 3.9992282390594482, "mode": "train", "epoch": 10}
{"loss": 0.43643486499786377, "acc": 0.8116319179534912, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.4010005593299866, "acc": 0.8227186799049377, "length": 3.9993762969970703, "mode": "train", "epoch": 11}
{"loss": 0.41691797971725464, "acc": 0.8178820013999939, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.39556604623794556, "acc": 0.8249373435974121, "length": 3.9993386268615723, "mode": "train", "epoch": 12}
{"loss": 0.42274460196495056, "acc": 0.808506965637207, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.3867587447166443, "acc": 0.8291406035423279, "length": 3.999675750732422, "mode": "train", "epoch": 13}
{"loss": 0.4027350842952728, "acc": 0.8236110210418701, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3792203962802887, "acc": 0.833452582359314, "length": 3.9995155334472656, "mode": "train", "epoch": 14}
{"loss": 0.39330756664276123, "acc": 0.8252604603767395, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.37174686789512634, "acc": 0.8370711803436279, "length": 3.9995415210723877, "mode": "train", "epoch": 15}
{"loss": 0.3766848146915436, "acc": 0.8375868201255798, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.3656643033027649, "acc": 0.8375129103660583, "length": 3.9992637634277344, "mode": "train", "epoch": 16}
{"loss": 0.37809446454048157, "acc": 0.8299479484558105, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.35461875796318054, "acc": 0.844025194644928, "length": 3.999774694442749, "mode": "train", "epoch": 17}
{"loss": 0.36001908779144287, "acc": 0.8432291150093079, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.347979336977005, "acc": 0.8462660312652588, "length": 3.999624252319336, "mode": "train", "epoch": 18}
{"loss": 0.366366982460022, "acc": 0.8410589694976807, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.3422376811504364, "acc": 0.8490139245986938, "length": 3.9997925758361816, "mode": "train", "epoch": 19}
{"loss": 0.35104963183403015, "acc": 0.8547743558883667, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.3348788321018219, "acc": 0.8536967635154724, "length": 3.999894142150879, "mode": "train", "epoch": 20}
{"loss": 0.34528648853302, "acc": 0.8532986044883728, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.3295855224132538, "acc": 0.8565211296081543, "length": 3.999741554260254, "mode": "train", "epoch": 21}
{"loss": 0.3415195643901825, "acc": 0.8567708134651184, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.32513052225112915, "acc": 0.8581794500350952, "length": 3.999786138534546, "mode": "train", "epoch": 22}
{"loss": 0.3406858444213867, "acc": 0.8534723520278931, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.31928038597106934, "acc": 0.8600873947143555, "length": 3.9999005794525146, "mode": "train", "epoch": 23}
{"loss": 0.32657390832901, "acc": 0.8609374165534973, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.31676679849624634, "acc": 0.8624111413955688, "length": 3.9998323917388916, "mode": "train", "epoch": 24}
{"loss": 0.32910585403442383, "acc": 0.8592881560325623, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.3116973042488098, "acc": 0.865827202796936, "length": 3.9993386268615723, "mode": "train", "epoch": 25}
{"loss": 0.3297341465950012, "acc": 0.8613714575767517, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.3071099817752838, "acc": 0.8686307072639465, "length": 3.9998276233673096, "mode": "train", "epoch": 26}
{"loss": 0.3151184320449829, "acc": 0.8634549379348755, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.30258697271347046, "acc": 0.8725572228431702, "length": 3.9997777938842773, "mode": "train", "epoch": 27}
{"loss": 0.31325483322143555, "acc": 0.8666666150093079, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.3000762164592743, "acc": 0.8722235560417175, "length": 3.9999475479125977, "mode": "train", "epoch": 28}
{"loss": 0.3208264112472534, "acc": 0.8683159351348877, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.3004165291786194, "acc": 0.8728969097137451, "length": 3.999955892562866, "mode": "train", "epoch": 29}
{"loss": 0.35626310110092163, "acc": 0.8513021469116211, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.2981293201446533, "acc": 0.8734468817710876, "length": 3.999790668487549, "mode": "train", "epoch": 30}
{"loss": 0.30992984771728516, "acc": 0.8706597685813904, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.28766003251075745, "acc": 0.879259467124939, "length": 3.99997615814209, "mode": "train", "epoch": 31}
{"loss": 0.29933881759643555, "acc": 0.8743056654930115, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.2906017303466797, "acc": 0.8775748610496521, "length": 3.9998984336853027, "mode": "train", "epoch": 32}
{"loss": 0.30899882316589355, "acc": 0.8740451335906982, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.2845078110694885, "acc": 0.878389835357666, "length": 3.9999430179595947, "mode": "train", "epoch": 33}
{"loss": 0.30126330256462097, "acc": 0.8755208849906921, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.2790561318397522, "acc": 0.8816957473754883, "length": 3.999901294708252, "mode": "train", "epoch": 34}
{"loss": 0.3022518455982208, "acc": 0.8769097924232483, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.27550873160362244, "acc": 0.8821156620979309, "length": 3.999924898147583, "mode": "train", "epoch": 35}
{"loss": 0.2975648045539856, "acc": 0.8770833015441895, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.2775805592536926, "acc": 0.8810528516769409, "length": 3.9999654293060303, "mode": "train", "epoch": 36}
{"loss": 0.2914615869522095, "acc": 0.8786458969116211, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.26643261313438416, "acc": 0.8858426213264465, "length": 3.999901294708252, "mode": "train", "epoch": 37}
{"loss": 0.2845246195793152, "acc": 0.8814235925674438, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.26518720388412476, "acc": 0.8864908814430237, "length": 3.999992847442627, "mode": "train", "epoch": 38}
{"loss": 0.28851285576820374, "acc": 0.8772569894790649, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.26487475633621216, "acc": 0.886883020401001, "length": 3.999985456466675, "mode": "train", "epoch": 39}
{"loss": 0.28124141693115234, "acc": 0.8829861879348755, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.2600453197956085, "acc": 0.8879756331443787, "length": 3.9999775886535645, "mode": "train", "epoch": 40}
{"loss": 0.2715347409248352, "acc": 0.8875868320465088, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.2590709924697876, "acc": 0.8893492817878723, "length": 3.999980926513672, "mode": "train", "epoch": 41}
{"loss": 0.28087687492370605, "acc": 0.8865450620651245, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.25717586278915405, "acc": 0.8902734518051147, "length": 3.9999778270721436, "mode": "train", "epoch": 42}
{"loss": 0.2760966122150421, "acc": 0.8851563334465027, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.25568369030952454, "acc": 0.889347493648529, "length": 3.999943971633911, "mode": "train", "epoch": 43}
{"loss": 0.2678067982196808, "acc": 0.8914930820465088, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.25489938259124756, "acc": 0.8918127417564392, "length": 3.999753713607788, "mode": "train", "epoch": 44}
{"loss": 0.28485244512557983, "acc": 0.8895832896232605, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.2603134512901306, "acc": 0.8922919631004333, "length": 3.999983549118042, "mode": "train", "epoch": 45}
{"loss": 0.2750668525695801, "acc": 0.8925347924232483, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.2671896815299988, "acc": 0.889853835105896, "length": 3.999993324279785, "mode": "train", "epoch": 46}
{"loss": 0.30971139669418335, "acc": 0.858506977558136, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.25677481293678284, "acc": 0.8924326300621033, "length": 3.999998092651367, "mode": "train", "epoch": 47}
{"loss": 0.25822967290878296, "acc": 0.8947916030883789, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.24604320526123047, "acc": 0.8972203731536865, "length": 3.99989652633667, "mode": "train", "epoch": 48}
{"loss": 0.26156947016716003, "acc": 0.8949652910232544, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.24151349067687988, "acc": 0.9006165862083435, "length": 3.999997854232788, "mode": "train", "epoch": 49}
{"loss": 0.2547435164451599, "acc": 0.8954861760139465, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.23778748512268066, "acc": 0.900615930557251, "length": 3.9999923706054688, "mode": "train", "epoch": 50}
{"loss": 0.2548403739929199, "acc": 0.9003472924232483, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.23722323775291443, "acc": 0.9001163244247437, "length": 3.9994921684265137, "mode": "train", "epoch": 51}
{"loss": 0.2509797215461731, "acc": 0.9004339575767517, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.23861190676689148, "acc": 0.900840699672699, "length": 3.9999988079071045, "mode": "train", "epoch": 52}
{"loss": 0.26789894700050354, "acc": 0.8960070013999939, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.24291597306728363, "acc": 0.8985127210617065, "length": 3.999967098236084, "mode": "train", "epoch": 53}
{"loss": 0.26014262437820435, "acc": 0.8965277075767517, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.24123810231685638, "acc": 0.8994672894477844, "length": 3.999995708465576, "mode": "train", "epoch": 54}
{"loss": 0.2565467357635498, "acc": 0.8971354961395264, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.2450064718723297, "acc": 0.8971691727638245, "length": 3.9999983310699463, "mode": "train", "epoch": 55}
{"loss": 0.2541401982307434, "acc": 0.898350715637207, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.2357732206583023, "acc": 0.902712881565094, "length": 3.999849557876587, "mode": "train", "epoch": 56}
{"loss": 0.2483239769935608, "acc": 0.8989583253860474, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.24027882516384125, "acc": 0.8994389176368713, "length": 3.9999892711639404, "mode": "train", "epoch": 57}
{"loss": 0.31741106510162354, "acc": 0.8723958134651184, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.2565198242664337, "acc": 0.8926286697387695, "length": 3.999995708465576, "mode": "train", "epoch": 58}
{"loss": 0.26469945907592773, "acc": 0.8939235210418701, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.23850728571414948, "acc": 0.90226811170578, "length": 3.99995756149292, "mode": "train", "epoch": 59}
{"loss": 0.26702427864074707, "acc": 0.8976563215255737, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.23105326294898987, "acc": 0.9035312533378601, "length": 3.9999988079071045, "mode": "train", "epoch": 60}
{"loss": 0.2635284662246704, "acc": 0.8976562023162842, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8783869743347168
