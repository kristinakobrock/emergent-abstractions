# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6799284815788269, "acc": 0.5567207932472229, "length": 3.3298180103302, "mode": "train", "epoch": 1}
{"loss": 0.6088079214096069, "acc": 0.6753472089767456, "length": 4.0, "mode": "test", "epoch": 1}
{"loss": 0.5927067399024963, "acc": 0.6739235520362854, "length": 3.9517416954040527, "mode": "train", "epoch": 2}
{"loss": 0.6066707968711853, "acc": 0.6671006679534912, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.5658338069915771, "acc": 0.7031952142715454, "length": 3.979156732559204, "mode": "train", "epoch": 3}
{"loss": 0.5658721923828125, "acc": 0.7047742605209351, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.5399892330169678, "acc": 0.7219337821006775, "length": 3.9925501346588135, "mode": "train", "epoch": 4}
{"loss": 0.5391558408737183, "acc": 0.7112846970558167, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.5127378702163696, "acc": 0.7452629208564758, "length": 3.995927095413208, "mode": "train", "epoch": 5}
{"loss": 0.5215408205986023, "acc": 0.7536459565162659, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.48870375752449036, "acc": 0.7576647996902466, "length": 3.998947858810425, "mode": "train", "epoch": 6}
{"loss": 0.4885225296020508, "acc": 0.7634549140930176, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.46527454257011414, "acc": 0.7735083699226379, "length": 3.999173879623413, "mode": "train", "epoch": 7}
{"loss": 0.4693307876586914, "acc": 0.7731771469116211, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.452331006526947, "acc": 0.7868310213088989, "length": 3.9988327026367188, "mode": "train", "epoch": 8}
{"loss": 0.44807469844818115, "acc": 0.7973090410232544, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.42401593923568726, "acc": 0.805605947971344, "length": 3.998828887939453, "mode": "train", "epoch": 9}
{"loss": 0.4200389087200165, "acc": 0.8136283755302429, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.41440364718437195, "acc": 0.8107118606567383, "length": 3.9988372325897217, "mode": "train", "epoch": 10}
{"loss": 0.4221908152103424, "acc": 0.809374988079071, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.4104073643684387, "acc": 0.8140246272087097, "length": 3.9995534420013428, "mode": "train", "epoch": 11}
{"loss": 0.41535770893096924, "acc": 0.8118056058883667, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.3988463282585144, "acc": 0.8182387948036194, "length": 3.9993138313293457, "mode": "train", "epoch": 12}
{"loss": 0.4037637710571289, "acc": 0.8122396469116211, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.39063259959220886, "acc": 0.8205263018608093, "length": 3.999450922012329, "mode": "train", "epoch": 13}
{"loss": 0.3828239142894745, "acc": 0.8262152075767517, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3707844913005829, "acc": 0.8330401182174683, "length": 3.9984259605407715, "mode": "train", "epoch": 14}
{"loss": 0.36390048265457153, "acc": 0.8318575024604797, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.36239102482795715, "acc": 0.8369728922843933, "length": 3.997070789337158, "mode": "train", "epoch": 15}
{"loss": 0.36388176679611206, "acc": 0.8407118320465088, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.35443148016929626, "acc": 0.8401378989219666, "length": 3.99941086769104, "mode": "train", "epoch": 16}
{"loss": 0.35429680347442627, "acc": 0.846875011920929, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.34405943751335144, "acc": 0.849012553691864, "length": 3.9992449283599854, "mode": "train", "epoch": 17}
{"loss": 0.3519941568374634, "acc": 0.8486111164093018, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.3406415283679962, "acc": 0.8499463796615601, "length": 3.9994168281555176, "mode": "train", "epoch": 18}
{"loss": 0.34604164958000183, "acc": 0.8522568941116333, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.3389975428581238, "acc": 0.8513067960739136, "length": 3.999868392944336, "mode": "train", "epoch": 19}
{"loss": 0.35879087448120117, "acc": 0.8419270515441895, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.3466792106628418, "acc": 0.8443530201911926, "length": 3.999729633331299, "mode": "train", "epoch": 20}
{"loss": 0.35691574215888977, "acc": 0.8473958969116211, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.34444159269332886, "acc": 0.8500217199325562, "length": 3.9997470378875732, "mode": "train", "epoch": 21}
{"loss": 0.34118595719337463, "acc": 0.8529514074325562, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.330284059047699, "acc": 0.8565830588340759, "length": 3.9999547004699707, "mode": "train", "epoch": 22}
{"loss": 0.33803287148475647, "acc": 0.8532986044883728, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.3311313986778259, "acc": 0.8547946214675903, "length": 3.9998879432678223, "mode": "train", "epoch": 23}
{"loss": 0.3647817075252533, "acc": 0.8303819894790649, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.32588714361190796, "acc": 0.8562943339347839, "length": 3.9996109008789062, "mode": "train", "epoch": 24}
{"loss": 0.3299039304256439, "acc": 0.8548610210418701, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.31899434328079224, "acc": 0.8606274724006653, "length": 3.999936580657959, "mode": "train", "epoch": 25}
{"loss": 0.33158376812934875, "acc": 0.8638889789581299, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.32031330466270447, "acc": 0.8601544499397278, "length": 3.9999678134918213, "mode": "train", "epoch": 26}
{"loss": 0.33176031708717346, "acc": 0.8547743558883667, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.3163953423500061, "acc": 0.8618205785751343, "length": 3.9997620582580566, "mode": "train", "epoch": 27}
{"loss": 0.3260912299156189, "acc": 0.8574651479721069, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.3146083354949951, "acc": 0.8642004132270813, "length": 3.999959945678711, "mode": "train", "epoch": 28}
{"loss": 0.32508736848831177, "acc": 0.8617188334465027, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.31632199883461, "acc": 0.8621050715446472, "length": 3.9999122619628906, "mode": "train", "epoch": 29}
{"loss": 0.33153849840164185, "acc": 0.8617188334465027, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.3198516368865967, "acc": 0.8641113638877869, "length": 3.9998199939727783, "mode": "train", "epoch": 30}
{"loss": 0.3305763006210327, "acc": 0.8613714575767517, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.3148516118526459, "acc": 0.8669062852859497, "length": 3.9998812675476074, "mode": "train", "epoch": 31}
{"loss": 0.3157930374145508, "acc": 0.8661457896232605, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.31030479073524475, "acc": 0.8673821091651917, "length": 3.9999823570251465, "mode": "train", "epoch": 32}
{"loss": 0.317129909992218, "acc": 0.8677083253860474, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.31406012177467346, "acc": 0.8654464483261108, "length": 3.9998459815979004, "mode": "train", "epoch": 33}
{"loss": 0.33077526092529297, "acc": 0.8597221970558167, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.313305526971817, "acc": 0.8670476078987122, "length": 3.999990463256836, "mode": "train", "epoch": 34}
{"loss": 0.32923856377601624, "acc": 0.8657117486000061, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.31110018491744995, "acc": 0.8679127097129822, "length": 3.9999940395355225, "mode": "train", "epoch": 35}
{"loss": 0.3256852924823761, "acc": 0.859375, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.36896729469299316, "acc": 0.8448643684387207, "length": 3.9999518394470215, "mode": "train", "epoch": 36}
{"loss": 0.3937135934829712, "acc": 0.8296874165534973, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.3453965187072754, "acc": 0.8520033955574036, "length": 3.999879837036133, "mode": "train", "epoch": 37}
{"loss": 0.347229540348053, "acc": 0.8488714694976807, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.319349080324173, "acc": 0.868497371673584, "length": 3.9999759197235107, "mode": "train", "epoch": 38}
{"loss": 0.31852811574935913, "acc": 0.8735241889953613, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.2962351441383362, "acc": 0.8784312009811401, "length": 3.9999852180480957, "mode": "train", "epoch": 39}
{"loss": 0.30362242460250854, "acc": 0.8817707896232605, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.3121030628681183, "acc": 0.8707533478736877, "length": 3.9998695850372314, "mode": "train", "epoch": 40}
{"loss": 0.33573663234710693, "acc": 0.8618923425674438, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.32604917883872986, "acc": 0.8670196533203125, "length": 3.999985456466675, "mode": "train", "epoch": 41}
{"loss": 0.3225196599960327, "acc": 0.8683159351348877, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.3089154064655304, "acc": 0.8742179274559021, "length": 3.999985933303833, "mode": "train", "epoch": 42}
{"loss": 0.3100372552871704, "acc": 0.8742187023162842, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.30378541350364685, "acc": 0.8779568076133728, "length": 3.999964475631714, "mode": "train", "epoch": 43}
{"loss": 0.3207884728908539, "acc": 0.8764757513999939, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.31796160340309143, "acc": 0.8718745112419128, "length": 3.9999840259552, "mode": "train", "epoch": 44}
{"loss": 0.3277229070663452, "acc": 0.8731770515441895, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.3022839426994324, "acc": 0.8760873079299927, "length": 3.9999825954437256, "mode": "train", "epoch": 45}
{"loss": 0.29884102940559387, "acc": 0.8777778148651123, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.29482534527778625, "acc": 0.8790727257728577, "length": 3.999979257583618, "mode": "train", "epoch": 46}
{"loss": 0.305544376373291, "acc": 0.8772570490837097, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.29293346405029297, "acc": 0.878013014793396, "length": 3.999992847442627, "mode": "train", "epoch": 47}
{"loss": 0.2992919385433197, "acc": 0.8843751549720764, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.2897964119911194, "acc": 0.8837043046951294, "length": 3.999981164932251, "mode": "train", "epoch": 48}
{"loss": 0.3130120038986206, "acc": 0.8789931535720825, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.29164233803749084, "acc": 0.881389319896698, "length": 3.9999892711639404, "mode": "train", "epoch": 49}
{"loss": 0.29639720916748047, "acc": 0.878038227558136, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.2877947688102722, "acc": 0.8830450773239136, "length": 3.9994583129882812, "mode": "train", "epoch": 50}
{"loss": 0.2942127585411072, "acc": 0.8866318464279175, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.2791622281074524, "acc": 0.8868857026100159, "length": 3.999993085861206, "mode": "train", "epoch": 51}
{"loss": 0.28716519474983215, "acc": 0.8868055939674377, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.2814099192619324, "acc": 0.8867180943489075, "length": 3.999988079071045, "mode": "train", "epoch": 52}
{"loss": 0.30702275037765503, "acc": 0.8857638835906982, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.28969457745552063, "acc": 0.8801056742668152, "length": 3.9999918937683105, "mode": "train", "epoch": 53}
{"loss": 0.2891761064529419, "acc": 0.8854167461395264, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.2909305989742279, "acc": 0.8824928402900696, "length": 3.9997990131378174, "mode": "train", "epoch": 54}
{"loss": 0.3197667598724365, "acc": 0.8717012405395508, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.35303038358688354, "acc": 0.8519499897956848, "length": 3.999931573867798, "mode": "train", "epoch": 55}
{"loss": 0.34467023611068726, "acc": 0.8568576574325562, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.33366677165031433, "acc": 0.8621335029602051, "length": 3.9999470710754395, "mode": "train", "epoch": 56}
{"loss": 0.33882057666778564, "acc": 0.8649304509162903, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.3208272159099579, "acc": 0.8660988807678223, "length": 3.9999942779541016, "mode": "train", "epoch": 57}
{"loss": 0.3246016204357147, "acc": 0.8655382394790649, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.3152654767036438, "acc": 0.8679395914077759, "length": 3.999985456466675, "mode": "train", "epoch": 58}
{"loss": 0.32637858390808105, "acc": 0.8711805939674377, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.31173962354660034, "acc": 0.8688048720359802, "length": 3.9999890327453613, "mode": "train", "epoch": 59}
{"loss": 0.3196209967136383, "acc": 0.867968738079071, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.306549996137619, "acc": 0.8706750869750977, "length": 3.999708890914917, "mode": "train", "epoch": 60}
{"loss": 0.31995484232902527, "acc": 0.8708333969116211, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7892622947692871
