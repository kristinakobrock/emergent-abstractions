# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6956089735031128, "acc": 0.5053885579109192, "length": 3.5142810344696045, "mode": "train", "epoch": 1}
{"loss": 0.6912416815757751, "acc": 0.5443617105484009, "length": 1.1336805820465088, "mode": "test", "epoch": 1}
{"loss": 0.6712232232093811, "acc": 0.6012079119682312, "length": 2.613755702972412, "mode": "train", "epoch": 2}
{"loss": 0.6330676674842834, "acc": 0.6500515341758728, "length": 2.631944417953491, "mode": "test", "epoch": 2}
{"loss": 0.6130052208900452, "acc": 0.661970317363739, "length": 2.8419692516326904, "mode": "train", "epoch": 3}
{"loss": 0.6167455315589905, "acc": 0.6608792543411255, "length": 2.7951388359069824, "mode": "test", "epoch": 3}
{"loss": 0.5834664702415466, "acc": 0.6921330690383911, "length": 3.333597421646118, "mode": "train", "epoch": 4}
{"loss": 0.5648854374885559, "acc": 0.7150403261184692, "length": 3.652777671813965, "mode": "test", "epoch": 4}
{"loss": 0.5572401881217957, "acc": 0.7116405963897705, "length": 3.654024839401245, "mode": "train", "epoch": 5}
{"loss": 0.5433576107025146, "acc": 0.7325507402420044, "length": 3.699652671813965, "mode": "test", "epoch": 5}
{"loss": 0.5216019749641418, "acc": 0.7464122772216797, "length": 3.749711275100708, "mode": "train", "epoch": 6}
{"loss": 0.5157926678657532, "acc": 0.7556532025337219, "length": 3.8767361640930176, "mode": "test", "epoch": 6}
{"loss": 0.49835872650146484, "acc": 0.7646058201789856, "length": 3.819263219833374, "mode": "train", "epoch": 7}
{"loss": 0.4870685935020447, "acc": 0.7705050706863403, "length": 3.8767361640930176, "mode": "test", "epoch": 7}
{"loss": 0.47792336344718933, "acc": 0.777151346206665, "length": 3.836982250213623, "mode": "train", "epoch": 8}
{"loss": 0.46100160479545593, "acc": 0.7858710885047913, "length": 3.862847328186035, "mode": "test", "epoch": 8}
{"loss": 0.4541654586791992, "acc": 0.7894232869148254, "length": 3.8697025775909424, "mode": "train", "epoch": 9}
{"loss": 0.43287622928619385, "acc": 0.8093641400337219, "length": 3.8732638359069824, "mode": "test", "epoch": 9}
{"loss": 0.43360772728919983, "acc": 0.7976696491241455, "length": 3.8553504943847656, "mode": "train", "epoch": 10}
{"loss": 0.4194291830062866, "acc": 0.8093587756156921, "length": 3.8802082538604736, "mode": "test", "epoch": 10}
{"loss": 0.4271458089351654, "acc": 0.8023565411567688, "length": 3.8459126949310303, "mode": "train", "epoch": 11}
{"loss": 0.4130359888076782, "acc": 0.8135172128677368, "length": 3.8263888359069824, "mode": "test", "epoch": 11}
{"loss": 0.4088621735572815, "acc": 0.8111782073974609, "length": 3.846644878387451, "mode": "train", "epoch": 12}
{"loss": 0.4119693636894226, "acc": 0.8166069388389587, "length": 3.7951388359069824, "mode": "test", "epoch": 12}
{"loss": 0.39886727929115295, "acc": 0.8170592188835144, "length": 3.811138868331909, "mode": "train", "epoch": 13}
{"loss": 0.3900837302207947, "acc": 0.8270576000213623, "length": 3.8767361640930176, "mode": "test", "epoch": 13}
{"loss": 0.3800681531429291, "acc": 0.8294561505317688, "length": 3.815483331680298, "mode": "train", "epoch": 14}
{"loss": 0.37711939215660095, "acc": 0.8344698548316956, "length": 3.824652671813965, "mode": "test", "epoch": 14}
{"loss": 0.36642220616340637, "acc": 0.8341755270957947, "length": 3.816279411315918, "mode": "train", "epoch": 15}
{"loss": 0.3586472272872925, "acc": 0.8396267294883728, "length": 3.805555582046509, "mode": "test", "epoch": 15}
{"loss": 0.35440489649772644, "acc": 0.8393975496292114, "length": 3.821943998336792, "mode": "train", "epoch": 16}
{"loss": 0.342819482088089, "acc": 0.8441324830055237, "length": 3.859375, "mode": "test", "epoch": 16}
{"loss": 0.3453575670719147, "acc": 0.8441163301467896, "length": 3.844296455383301, "mode": "train", "epoch": 17}
{"loss": 0.33733561635017395, "acc": 0.8481064438819885, "length": 3.8888888359069824, "mode": "test", "epoch": 17}
{"loss": 0.3344660699367523, "acc": 0.8482478857040405, "length": 3.847531318664551, "mode": "train", "epoch": 18}
{"loss": 0.34041503071784973, "acc": 0.8514593839645386, "length": 3.8888888359069824, "mode": "test", "epoch": 18}
{"loss": 0.3335191309452057, "acc": 0.8478777408599854, "length": 3.861948013305664, "mode": "train", "epoch": 19}
{"loss": 0.3287616968154907, "acc": 0.8550049662590027, "length": 3.890625, "mode": "test", "epoch": 19}
{"loss": 0.32747170329093933, "acc": 0.8514634370803833, "length": 3.875401496887207, "mode": "train", "epoch": 20}
{"loss": 0.31812724471092224, "acc": 0.85712069272995, "length": 3.909722328186035, "mode": "test", "epoch": 20}
{"loss": 0.3164342939853668, "acc": 0.8595744967460632, "length": 3.875117301940918, "mode": "train", "epoch": 21}
{"loss": 0.3209197223186493, "acc": 0.8611152172088623, "length": 3.890625, "mode": "test", "epoch": 21}
{"loss": 0.3151566982269287, "acc": 0.8588215112686157, "length": 3.884049892425537, "mode": "train", "epoch": 22}
{"loss": 0.31760379672050476, "acc": 0.8641114234924316, "length": 3.887152671813965, "mode": "test", "epoch": 22}
{"loss": 0.3094746470451355, "acc": 0.8658852577209473, "length": 3.86930513381958, "mode": "train", "epoch": 23}
{"loss": 0.31544604897499084, "acc": 0.8661025762557983, "length": 3.9045138359069824, "mode": "test", "epoch": 23}
{"loss": 0.29646721482276917, "acc": 0.8736691474914551, "length": 3.8916494846343994, "mode": "train", "epoch": 24}
{"loss": 0.3089926838874817, "acc": 0.8704047203063965, "length": 3.897569417953491, "mode": "test", "epoch": 24}
{"loss": 0.2895299792289734, "acc": 0.8759863972663879, "length": 3.8928134441375732, "mode": "train", "epoch": 25}
{"loss": 0.2994406223297119, "acc": 0.8776719570159912, "length": 3.897569417953491, "mode": "test", "epoch": 25}
{"loss": 0.2810046374797821, "acc": 0.8826971054077148, "length": 3.898106098175049, "mode": "train", "epoch": 26}
{"loss": 0.29247820377349854, "acc": 0.8778943419456482, "length": 3.9357638359069824, "mode": "test", "epoch": 26}
{"loss": 0.2733110189437866, "acc": 0.8870652318000793, "length": 3.904428243637085, "mode": "train", "epoch": 27}
{"loss": 0.2941974401473999, "acc": 0.8770534992218018, "length": 3.9045138359069824, "mode": "test", "epoch": 27}
{"loss": 0.2774631977081299, "acc": 0.884482741355896, "length": 3.9195499420166016, "mode": "train", "epoch": 28}
{"loss": 0.30475446581840515, "acc": 0.8767470121383667, "length": 3.934027671813965, "mode": "test", "epoch": 28}
{"loss": 0.2740412950515747, "acc": 0.8826851844787598, "length": 3.9381039142608643, "mode": "train", "epoch": 29}
{"loss": 0.2900397777557373, "acc": 0.8910645246505737, "length": 3.949652671813965, "mode": "test", "epoch": 29}
{"loss": 0.2635759711265564, "acc": 0.8932105302810669, "length": 3.965301513671875, "mode": "train", "epoch": 30}
{"loss": 0.2788664400577545, "acc": 0.8871528506278992, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.2567506432533264, "acc": 0.8959931135177612, "length": 3.98991322517395, "mode": "train", "epoch": 31}
{"loss": 0.2628985643386841, "acc": 0.8939913511276245, "length": 3.9791667461395264, "mode": "test", "epoch": 31}
{"loss": 0.25094395875930786, "acc": 0.8999276161193848, "length": 3.989428997039795, "mode": "train", "epoch": 32}
{"loss": 0.2619270086288452, "acc": 0.8953993320465088, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.24908776581287384, "acc": 0.8994881510734558, "length": 3.9999284744262695, "mode": "train", "epoch": 33}
{"loss": 0.24717561900615692, "acc": 0.9010416865348816, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.2431154102087021, "acc": 0.9028884768486023, "length": 3.9998068809509277, "mode": "train", "epoch": 34}
{"loss": 0.252166748046875, "acc": 0.9010416865348816, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.2345735877752304, "acc": 0.9061280488967896, "length": 3.999966859817505, "mode": "train", "epoch": 35}
{"loss": 0.2553322911262512, "acc": 0.9049479365348816, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.23217041790485382, "acc": 0.9106968641281128, "length": 3.999962329864502, "mode": "train", "epoch": 36}
{"loss": 0.24442259967327118, "acc": 0.9091147184371948, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.22562822699546814, "acc": 0.9116595983505249, "length": 3.9999101161956787, "mode": "train", "epoch": 37}
{"loss": 0.23495247960090637, "acc": 0.9072917103767395, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.22929994761943817, "acc": 0.9071221351623535, "length": 3.999990463256836, "mode": "train", "epoch": 38}
{"loss": 0.23704057931900024, "acc": 0.9079861044883728, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.23095032572746277, "acc": 0.9078313112258911, "length": 3.9999778270721436, "mode": "train", "epoch": 39}
{"loss": 0.24599477648735046, "acc": 0.9093749523162842, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.2349967509508133, "acc": 0.9078013896942139, "length": 3.9999501705169678, "mode": "train", "epoch": 40}
{"loss": 0.24925833940505981, "acc": 0.9039061665534973, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.2250531166791916, "acc": 0.9112076163291931, "length": 3.9999542236328125, "mode": "train", "epoch": 41}
{"loss": 0.2635996341705322, "acc": 0.8949652910232544, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.23599447309970856, "acc": 0.9084494113922119, "length": 3.9998719692230225, "mode": "train", "epoch": 42}
{"loss": 0.2364117056131363, "acc": 0.9102431535720825, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.24208220839500427, "acc": 0.9025147557258606, "length": 3.9997403621673584, "mode": "train", "epoch": 43}
{"loss": 0.24242281913757324, "acc": 0.9075520634651184, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.22442948818206787, "acc": 0.9111183881759644, "length": 3.9987168312072754, "mode": "train", "epoch": 44}
{"loss": 0.22581546008586884, "acc": 0.9107639789581299, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.21901309490203857, "acc": 0.9119446873664856, "length": 3.9999234676361084, "mode": "train", "epoch": 45}
{"loss": 0.2471018135547638, "acc": 0.9107639789581299, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.2205049991607666, "acc": 0.9137058258056641, "length": 3.9999916553497314, "mode": "train", "epoch": 46}
{"loss": 0.22736842930316925, "acc": 0.9109375476837158, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.21587927639484406, "acc": 0.9123417139053345, "length": 3.9999399185180664, "mode": "train", "epoch": 47}
{"loss": 0.23158375918865204, "acc": 0.9107639789581299, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.2123323529958725, "acc": 0.9140180349349976, "length": 3.999992847442627, "mode": "train", "epoch": 48}
{"loss": 0.21389353275299072, "acc": 0.9182291030883789, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.2122918665409088, "acc": 0.9148637056350708, "length": 3.999763250350952, "mode": "train", "epoch": 49}
{"loss": 0.230598583817482, "acc": 0.9125000834465027, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.2106906622648239, "acc": 0.9144437909126282, "length": 3.9999983310699463, "mode": "train", "epoch": 50}
{"loss": 0.21609456837177277, "acc": 0.91796875, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.21134498715400696, "acc": 0.9145004153251648, "length": 3.999997138977051, "mode": "train", "epoch": 51}
{"loss": 0.2188364416360855, "acc": 0.9142361879348755, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.21465182304382324, "acc": 0.9133645296096802, "length": 3.9999840259552, "mode": "train", "epoch": 52}
{"loss": 0.220381960272789, "acc": 0.9097222089767456, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.24369896948337555, "acc": 0.9033983945846558, "length": 3.9997875690460205, "mode": "train", "epoch": 53}
{"loss": 0.24884091317653656, "acc": 0.9030381441116333, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.22796085476875305, "acc": 0.9092637300491333, "length": 3.999586582183838, "mode": "train", "epoch": 54}
{"loss": 0.22247746586799622, "acc": 0.91015625, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.2159489095211029, "acc": 0.9130533933639526, "length": 3.999999761581421, "mode": "train", "epoch": 55}
{"loss": 0.2276776134967804, "acc": 0.9105901718139648, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.20866651833057404, "acc": 0.9156922101974487, "length": 3.999999761581421, "mode": "train", "epoch": 56}
{"loss": 0.24395142495632172, "acc": 0.9092016220092773, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.21188847720623016, "acc": 0.9142152667045593, "length": 3.9999756813049316, "mode": "train", "epoch": 57}
{"loss": 0.22198724746704102, "acc": 0.9140625, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.2031264454126358, "acc": 0.9181326627731323, "length": 4.0, "mode": "train", "epoch": 58}
{"loss": 0.22581595182418823, "acc": 0.9162326455116272, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.20134352147579193, "acc": 0.9203745722770691, "length": 4.0, "mode": "train", "epoch": 59}
{"loss": 0.22832319140434265, "acc": 0.9132812023162842, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.20429031550884247, "acc": 0.9168559312820435, "length": 4.0, "mode": "train", "epoch": 60}
{"loss": 0.2172919660806656, "acc": 0.9152777791023254, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8637692332267761
